<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[RabbitMQå››å¤§æ¨¡å¼(Workeræ¨¡å¼ä¸¶Pub/Subæ¨¡å¼ä¸¶Routingæ¨¡å¼ä¸¶Topicæ¨¡å¼)]]></title>
    <url>%2F2019%2F11%2F13%2FRabbitMQ%E5%9B%9B%E5%A4%A7%E6%A8%A1%E5%BC%8F-Worker%E6%A8%A1%E5%BC%8F%E4%B8%B6Pub-Sub%E6%A8%A1%E5%BC%8F%E4%B8%B6Routing%E6%A8%A1%E5%BC%8F%E4%B8%B6Topic%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è®°å½•RabbitMQå››å¤§æ¨¡å¼: Workeræ¨¡å¼ Pub/Subæ¨¡å¼ Routingæ¨¡å¼ Topicæ¨¡å¼ä¸€. Workeræ¨¡å¼å¦‚æœç”Ÿäº§è€…çš„ç”Ÿäº§é€Ÿç‡å¤§äºæ¶ˆè´¹è€…çš„æ¶ˆè´¹é€Ÿç‡,æœ‰å¯èƒ½å¯¼è‡´æ¶ˆè´¹çš„ç§¯å‹.queueä¸­çš„æ¶ˆæ¯ä¸ªæ•°ç†è®ºä¸Šæ˜¯æ²¡æœ‰é™åˆ¶,å–å†³äºå†…å­˜æœ‰å¤šå¤§,ç§¯å‹çš„æ¶ˆæ¯è¶Šå¤šä¼šå½±å“MQçš„æ€§èƒ½é˜Ÿåˆ—çš„fetchCountå€¼: é»˜è®¤å€¼æ˜¯250.æ¯ä¸ªæ¶ˆè´¹è€…ä¼šæƒ³é˜Ÿåˆ—é¢„å–250æ¡æ¶ˆæ¯,ä¸ç®¡æ¶ˆè´¹çš„å¿«æ…¢éƒ½å±äºè‡ªå·±å¤„ç†äº†ä¸€èˆ¬é¢„å–æ•°é‡è®¾ç½®ä¸º1,SpringBootæ•´åˆRabbitMQé…ç½®å¦‚ä¸‹:1spring.rabbitmq.listener.simple.prefetch=1äºŒ. Pub/Subæ¨¡å¼(å‘å¸ƒè®¢é˜…æ¨¡å¼) å‘å¸ƒè®¢é˜…æ¨¡å¼;å®ç°å‘å¸ƒè®¢é˜…æ¨¡å¼åˆ›å»ºäº¤æ¢æœºç±»å‹åªèƒ½æ˜¯fanout,é˜Ÿåˆ—è¦ç»‘å®šåˆ°äº¤æ¢æœºä¸Š.ä¸‰. Rountingæ¨¡å¼ä¸Topicæ¨¡å¼:Rountingæ¨¡å¼: type=&quot;direct&quot;åœ¨é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœºæ—¶,éœ€è¦è®¾ç½®ä¸€ä¸ªRountingKey,ç”Ÿäº§è€…ç”Ÿæˆæ¶ˆæ¯æŒ‡å®škeyåå‘é€ç»™äº¤æ¢æœº,äº¤æ¢æœºæ ¹æ®keyæŠŠæ¶ˆæ¯æ”¾å…¥åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­.(keyå¯ä»¥ä¸ºå¤šä¸ª)Topicæ¨¡å¼: type=&quot;topic&quot;ä¸Rountingæ¨¡å¼ç›¸åŒ,åŒºåˆ«åœ¨äºTopicæ¨¡å¼åœ¨è®¾ç½®è·¯ç”±keyå¯ä»¥ä½¿ç”¨é€šé…ç¬¦.è·¯ç”±keyç†è§£:åœ¨ç”Ÿäº§è€…å‘é€æ¶ˆæ¯æ—¶æ²¡æœ‰æŒ‡å®šäº¤æ¢æœºæ—¶,MQå°±ä¼šæŠŠè¯¥æ¶ˆæ¯å‘é€åˆ°AMQP defaultè¿™ä¸ªé»˜è®¤çš„äº¤æ¢æœºä¸­,å¹¶ä¸”å¯¹åº”çš„è·¯ç”±keyå°±æ˜¯è¯¥é˜Ÿåˆ—çš„åç§°(é»˜è®¤å®šä¹‰queueæ—¶å°±ä½¿ç”¨é˜Ÿåˆ—åç§°å½“åšè·¯ç”±keyç»‘å®šåˆ°é»˜è®¤çš„äº¤æ¢æœºä¸Š),æ‰€ä»¥æ¯ä¸ªé˜Ÿåˆ—å¿…å®šéƒ½ä¼šç»‘å®šäº¤æ¢æœº.]]></content>
      <categories>
        <category>æ¶ˆæ¯é˜Ÿåˆ—MQç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[RabbitMQæ€»ç»“]]></title>
    <url>%2F2019%2F11%2F13%2FRabbitMQ%E6%80%BB%E7%BB%93%2F</url>
    <content type="text"><![CDATA[åœºæ™¯:è®¢å•ä¸šåŠ¡æ¯æ‰§è¡Œä¸€ä¸ªéœ€è¦3sæ—¶é—´,ä¸ä½¿ç”¨MQç°åœºä¼šç§¯å‹è¶Šæ¥è¶Šå¤š,CPUåˆ‡æ¢éœ€è¦æ›´å¤šæ—¶é—´.ä½¿ç”¨MQåŸå› ç”±äºåšä¸šåŠ¡éœ€è¦å¾ˆé•¿æ—¶é—´,å¦‚æœæ²¡æœ‰ä»»ä½•çš„æªæ–½,æœåŠ¡å™¨æ— æ³•åŠæ—¶çš„æŠŠè¯·æ±‚å“åº”,æ„å‘³ç€æœ‰æ›´å¤šçš„è¯·æ±‚è¿›å…¥åˆ°æœåŠ¡å™¨,æœåŠ¡å™¨çš„CPUéœ€è¦åœ¨çº¿ç¨‹ä¸­é—´åˆ‡æ¢æ‰§è¡Œæƒ,è¿™æ ·çš„è¯ä¼šå¯¼è‡´å¤„ç†çš„æ—¶é—´å˜å¾—æ›´é•¿,ä¹…è€Œä¹…ä¹‹,æœåŠ¡å™¨å°±å“åº”ä¸è¿‡æ¥,æœ€ç»ˆå¯¼è‡´æœåŠ¡å™¨å´©æºƒ.MQä½œç”¨æ€»ç»“:(MQå¯ä»¥æŒä¹…åŒ–æ¶ˆæ¯,é‡å¯å¯ä»¥æ¢å¤)ç¼“è§£ç±»ä¼¼ç§’æ€é«˜å¹¶å‘çš„åœºæ™¯å‹åŠ›å¯ä»¥å¯¹æµé‡è¿›è¡Œå‰Šå³°å¯ä»¥å®ç°è§£è€¦å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯é æ€§ä¸€. åœºæ™¯:è®¢å•ä¸šåŠ¡æ¯æ‰§è¡Œä¸€ä¸ªéœ€è¦3sæ—¶é—´,ä¸ä½¿ç”¨MQç°åœºä¼šç§¯å‹è¶Šæ¥è¶Šå¤š,CPUåˆ‡æ¢éœ€è¦æ›´å¤šæ—¶é—´.äºŒ. ä½¿ç”¨MQåŸå› ç”±äºåšä¸šåŠ¡éœ€è¦å¾ˆé•¿æ—¶é—´,å¦‚æœæ²¡æœ‰ä»»ä½•çš„æªæ–½,æœåŠ¡å™¨æ— æ³•åŠæ—¶çš„æŠŠè¯·æ±‚å“åº”,æ„å‘³ç€æœ‰æ›´å¤šçš„è¯·æ±‚è¿›å…¥åˆ°æœåŠ¡å™¨,æœåŠ¡å™¨çš„CPUéœ€è¦åœ¨çº¿ç¨‹ä¸­é—´åˆ‡æ¢æ‰§è¡Œæƒ,è¿™æ ·çš„è¯ä¼šå¯¼è‡´å¤„ç†çš„æ—¶é—´å˜å¾—æ›´é•¿,ä¹…è€Œä¹…ä¹‹,æœåŠ¡å™¨å°±å“åº”ä¸è¿‡æ¥,æœ€ç»ˆå¯¼è‡´æœåŠ¡å™¨å´©æºƒ.ä¸‰. MQä½œç”¨æ€»ç»“:(MQå¯ä»¥æŒä¹…åŒ–æ¶ˆæ¯,é‡å¯å¯ä»¥æ¢å¤)ç¼“è§£ç±»ä¼¼ç§’æ€é«˜å¹¶å‘çš„åœºæ™¯å‹åŠ›å¯ä»¥å¯¹æµé‡è¿›è¡Œå‰Šå³°å¯ä»¥å®ç°è§£è€¦å¯ä»¥æé«˜ç³»ç»Ÿçš„å¯é æ€§å››. MQæµç¨‹:äº”. RabbitMQç®¡ç†ç•Œé¢Ready: å‡†å¤‡è¢«æ¶ˆè´¹çš„æ¶ˆæ¯https://www.lgzblog.com/images/pasted-57.pngtotal: æ€»æ¶ˆæ¯æ•°é‡Unacked: æ²¡æœ‰ç¡®è®¤çš„æ¶ˆæ¯(è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†,å´æ²¡æœ‰æ”¶åˆ°æ¶ˆæ¯çš„ACK,åˆ™ç”±Readyå˜ä¸ºUnackedçŠ¶æ€)å®šä¹‰queue:å¦‚æœbrokerä¸­æ²¡æœ‰è¿™ä¸ªé˜Ÿåˆ—å°±ä¼šå¸®æˆ‘ä»¬åœ¨brokerä¸­åˆ›å»ºé˜Ÿåˆ—,å¦‚æœå·²ç»æœ‰äº†å°±ä¸åˆ›å»ºå…­. æ¶ˆæ¯æŒä¹…åŒ–/ç­¾æ”¶æœºåˆ¶æŒä¹…åŒ–é…ç½®:(ç•¥)MQè‡ªåŠ¨ç­¾æ”¶å¼Šç«¯:é˜Ÿåˆ—æƒ³æ¶ˆè´¹è€…å‘é€ä¸€ä¸ªACK,æ¶ˆè´¹è€…ä¼šé©¬ä¸Šå‘é€ä¸€ä¸ªACKç»™MQ,ç„¶åé˜Ÿåˆ—ä¼šé©¬ä¸ŠæŠŠæ¶ˆæ¯åˆ é™¤æ‰,ä½†æ˜¯å¦‚æœæ¶ˆè´¹è€…åœ¨å¤„ç†è¿™æ¡æ¶ˆæ¯è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸,è¿™æ ·ä¼šå¯¼è‡´è¿™æ¡æ¶ˆæ¯çš„ä¸¢å¤±,æ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨æ‰‹åŠ¨ç­¾æ”¶.ACK:æ¶ˆè´¹è€…æ¸ é“æ¶ˆæ¯åMQæ²¡æœ‰æ”¶åˆ°ACK,åˆ™æ¶ˆæ¯åˆ™å˜ä¸ºUnackedçŠ¶æ€,å½“æ¶ˆè´¹è€…æ–­å¼€æ—¶,è¯¥æ¶ˆæ¯åˆä¼šå˜ä¸ºReadyçŠ¶æ€(ç›¸å½“äºé‡æ–°å…¥é˜Ÿç»§ç»­è¢«æ¶ˆè´¹).æ‰‹åŠ¨ç­¾æ”¶:å½“æ¶ˆè´¹è€…å¤„ç†å®Œæ¶ˆæ¯å,è°ƒç”¨basicAckæ–¹æ³•ç­¾æ”¶.ä¸ƒ. æ¶ˆè´¹æ¶ˆæ¯è®¾è®¡æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯å¤„ç†: (ä½¿ç”¨redis)æ‹¿åˆ°æ¶ˆæ¯çš„tag,åˆ©ç”¨redisåŸå­æ€§é€’å¢å¦‚æœæ‰§è¡ŒæˆåŠŸå°±ä¸åšä»»ä½•åŠ¨ä½œ,ç›´æ¥å‘é€ACKåˆ é™¤æ¶ˆæ¯å¦‚æœå¤±è´¥,åˆ™åˆ¤æ–­åœ¨redisä¸­çš„tagå¯¹åº”æ•°å€¼æ˜¯å¤šå°‘,åˆ¤æ–­æ˜¯å¦å¤§äºè®¾å®šå€¼3.1 å¦‚æœæ²¡æœ‰å¤§äºè®¾å®šå€¼,åˆ™ä½¿ç”¨basicNackæ–¹æ³•å§æ¶ˆæ¯é‡æ–°æ”¾å…¥é˜Ÿåˆ—ä¸­é‡æ–°æ¶ˆè´¹.3.2 å¦‚æœå·²ç»å¤§äºè®¾å®šå€¼,è¯´æ˜å·²ç»è¾¾åˆ°é‡è¯•ä¸Šé™,åˆ™ä¸å†é‡æ–°æ”¾å…¥é˜Ÿåˆ—ä¸­,è€Œæ˜¯æ”¾å…¥åˆ°å¦ä¸€ä¸ªç§ä¿¡é˜Ÿåˆ—ä¸­ç­‰å¾…äººå·¥å¤„ç†.å…«. MQå¹‚ç­‰æ€§å¤„ç†å¤„ç†æ¶ˆæ¯çš„æ–¹æ³•éœ€è¦è¯•ä¸‹å¹‚ç­‰æ€§å¹‚ç­‰æ€§: f(x) = f(f(x))æ‰§è¡Œä¸€æ¬¡çš„ç»“æœå’Œæ‰§è¡Œå¤šæ¬¡çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„PS: get:å¹‚ç­‰æ€§çš„, insert:éå¹‚ç­‰æ€§å½“â‘ â‘¡æ­¥éª¤éƒ½æ²¡æœ‰é—®é¢˜æ˜¯,Cåˆå‘MQå‘é€ACK,ä½†æ˜¯åœ¨â‘¢æ­¥éª¤ä¸­é‡åˆ°ç½‘ç»œå»¶è¿Ÿ,MQæ²¡æœ‰æ”¶åˆ°ACKåˆ™ä¸ä¼šåˆ é™¤æ¶ˆæ¯,Cåˆ™ä¼šé‡å¤æ¶ˆè´¹ä¸€æ¬¡æ¶ˆæ¯,è¿™æ ·å°±é‡å¤æ¶ˆè´¹äº†,æ‰€æœ‰éœ€è¦å®ç°å¹‚ç­‰æ€§.st=>start: ç”Ÿäº§è€… e=>end: æ¶ˆè´¹è€… op1=>operation: æ¶ˆæ¯ op2=>operation: äº¤æ¢æœº op3=>operation: é˜Ÿåˆ— st(right)->op1(right)->op2(right)->op3(right)->e{"scale":1,"line-width":2,"line-length":50,"text-margin":10,"font-size":12}var code=document.getElementById("flowchart-0-code").value,options=JSON.parse(decodeURIComponent(document.getElementById("flowchart-0-options").value)),diagram=flowchart.parse(code);diagram.drawSVG("flowchart-0",options)]]></content>
      <categories>
        <category>æ¶ˆæ¯é˜Ÿåˆ—MQç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpringBootæ•´åˆRabbitMQå¹¶ä½¿ç”¨]]></title>
    <url>%2F2019%2F11%2F09%2FSpringBoot%E6%95%B4%E5%90%88RabbitMQ%E5%B9%B6%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[SpringBootç‰ˆæœ¬: 2.1.3.RELEASE SpringBootæ•´åˆRabbitMQæ·»åŠ ä¾èµ–:12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt; &lt;version&gt;2.1.3.RELEASE&lt;/version&gt;&lt;/dependency&gt;ä¸€. SpringBootæ•´åˆRabbitMQæ·»åŠ ä¾èµ–:12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt; &lt;version&gt;2.1.3.RELEASE&lt;/version&gt;&lt;/dependency&gt;äºŒ. æä¾›è€…1234567891011121314151617181920212223242526272829303132333435363738394041/** * @author LuGuoZheng * @date 2019/11/6 9:48 * @Version 3.0 * @description */@RestController@RequestMapping("/mqTest")public class Provider &#123; @Autowired private AmqpTemplate amqpTemplate; @NoAuth @RequestMapping("/queue") public String sendMq(String msg) &#123; amqpTemplate.convertAndSend("", "boot_queue", msg); return "å‘é€æˆåŠŸ"; &#125; @NoAuth @RequestMapping("/pubsub") public String sendPubsub(String msg) &#123; amqpTemplate.convertAndSend("boot_pubsub_exchange", "", msg); return "å‘é€æˆåŠŸ"; &#125; @NoAuth @RequestMapping("/rounting") public String rounting(String key) &#123; amqpTemplate.convertAndSend("boot_rounting_exchange", key, "rountingæ¶ˆæ¯"); return "å‘é€æˆåŠŸ"; &#125; @NoAuth @RequestMapping("/topic") public String topic(String key) &#123; amqpTemplate.convertAndSend("boot_topic_exchange",key,"topicæ¶ˆæ¯"); return "å‘é€æˆåŠŸ"; &#125;&#125;ä¸‰. æ¶ˆè´¹è€…1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/** * @author LuGuoZheng * @date 2019/11/6 9:47 * @Version 3.0 * @description */@Component@Slf4jpublic class Consumer &#123; @RabbitListener(queuesToDeclare = @Queue("boot_queue")) public void consumerMq(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("æ™®é€šé˜Ÿåˆ—æ¶ˆæ¯:&#123;&#125;", msg); channel.basicAck(delivery, false); &#125; @RabbitListener(bindings = @QueueBinding( value = @Queue, exchange = @Exchange(name = "boot_pubsub_exchange", type = "fanout"))) public void receiveMsg1(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("è®¢é˜…å‘å¸ƒæ¨¡å¼1:&#123;&#125;", msg); channel.basicAck(delivery, false); &#125; @RabbitListener(bindings = @QueueBinding( value = @Queue, exchange = @Exchange(name = "boot_pubsub_exchange", type = "fanout"))) public void receiveMsg2(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("è®¢é˜…å‘å¸ƒæ¨¡å¼2:&#123;&#125;", msg); channel.basicAck(delivery, false); &#125; @RabbitListener(bindings = @QueueBinding( value = @Queue(value = "boot_rounting_queue01"), exchange = @Exchange(name = "boot_rounting_exchange", type = "direct"), key = &#123;"info", "error", "warning"&#125;)) public void rountiong1(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("rounting1:&#123;&#125;", msg); channel.basicAck(delivery, false); &#125; @RabbitListener(bindings = @QueueBinding( value = @Queue(value = "boot_rounting_queue02"), exchange = @Exchange(name = "boot_rounting_exchange", type = "direct"), key = &#123;"info", "warning"&#125;)) public void rounting2(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("rounting2:&#123;&#125;", msg); channel.basicAck(delivery, false); &#125; @RabbitListener(bindings = @QueueBinding( value = @Queue, exchange = @Exchange(name = "boot_topic_exchange",type = "topic"), key = &#123;"order.*","user.*","order.update"&#125;)) public void topic1(String msg, @Header(AmqpHeaders.DELIVERY_TAG) long delivery, Channel channel) throws Exception &#123; log.warn("topic1:&#123;&#125;", msg); channel.basicAck(delivery,false); &#125;&#125;]]></content>
      <categories>
        <category>æ¶ˆæ¯é˜Ÿåˆ—MQç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>RabbitMQ</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpringBootæ•´åˆESå¹¶ä½¿ç”¨]]></title>
    <url>%2F2019%2F11%2F03%2FSpringBoot%E6%95%B4%E5%90%88ES%E5%B9%B6%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[SpringBootç‰ˆæœ¬: 2.1.3.RELEASESpringBootæ•´åˆESæ·»åŠ ä¾èµ–:12345&lt;!--SpringBootæ•´åˆelasticsearchä¾èµ–--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;&lt;/dependency&gt;ä¸€. æ·»åŠ ESä¾èµ–:12345&lt;!--SpringBootæ•´åˆelasticsearchä¾èµ–--&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;&lt;/dependency&gt;äºŒ. å®ä½“ç±»1234567891011121314151617181920212223242526272829/** * @Created by LuGuoZheng * @Description TODO * @Date 2019/9/26 9:27 */@Data@Document(indexName = "log",type = "log")public class LogDto implements Serializable &#123; //è‡ªå¢ID @Id private String id; //æ—¥å¿—çº§åˆ« private String loglevel; //ç±»å @Field(analyzer = "ik_max_word",searchAnalyzer = "ik_max_word",type = FieldType.Text) private String classname; //æ—¥å¿—å†…å®¹ @Field(analyzer = "ik_max_word",searchAnalyzer = "ik_max_word",type = FieldType.Text) private String mess; //åˆ›å»ºæ—¶é—´ @Field(type = FieldType.Keyword) private String createrTime;&#125;ä¸‰. å®ç°ElasticsearchRepositoryæ¥å£123456789101112/** * @author LuGuoZheng * @date 2019/9/24 15:40 * @Version 3.0 * @description æ³›å‹1:domainçš„ç±»å‹ * æ³›å‹2:@Idçš„ç±»å‹ * è¯¥æ¥å£ä¼šäº¤ç»™spring,åº•å±‚ä¼šä½¿ç”¨JDKåŠ¨æ€ä»£ç†çš„æ–¹å¼åˆ›å»ºå¯¹è±¡,äº¤ç»™å®¹å™¨ç®¡ç† */@Servicepublic interface LogESRepostoryService extends ElasticsearchRepository&lt;LogDto, String&gt; &#123; // è‡ªå®šä¹‰JPAé«˜çº§æŸ¥è¯¢&#125;å››. Facadeå±‚(å®ç°é«˜äº®æŸ¥è¯¢)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687/** * @author LuGuoZheng * @date 2019/9/26 9:24 * @Version 3.0 * @description */@Servicepublic class LogESRepostoryFacadeImpl implements LogESRepostoryFacade &#123; @Autowired private LogESRepostoryService logESRepostoryService; @Autowired private ElasticsearchTemplate elasticsearchTemplate; @Override public LogDto save(LogDto logDto) &#123; return logESRepostoryService.save(logDto); &#125; @Override public JSONResult selectByParams(LogCondition logCondition) &#123; String loglevel = logCondition.getLoglevel(); String classname = logCondition.getClassname(); String mess = logCondition.getMess(); String beginTime = logCondition.getBeginTime(); String endTime = logCondition.getEndTime(); // è‡ªå®šä¹‰JPAé«˜çº§æŸ¥è¯¢ NativeSearchQueryBuilder builder = new NativeSearchQueryBuilder(); BoolQueryBuilder boolQuery = QueryBuilders.boolQuery(); if (StringUtil.isNotEmpty(loglevel)) &#123; // æ—¥å¿—çº§åˆ« boolQuery.must(QueryBuilders.matchQuery("loglevel", loglevel)); &#125; if (StringUtil.isNotEmpty(classname)) &#123; // æ¨¡å— boolQuery.must(QueryBuilders.matchQuery("classname", classname)); &#125; if (StringUtil.isNotEmpty(mess)) &#123; // å†…å®¹ boolQuery.must(QueryBuilders.matchQuery("mess", mess)); //æŒ‡å®šé«˜äº®å­—æ®µ HighlightBuilder.Field field = new HighlightBuilder.Field("mess"); //é«˜äº®æ˜¾ç¤ºè§„åˆ™ field.preTags("&lt;span style='color:red'&gt;"); field.postTags("&lt;/span&gt;"); builder.withHighlightFields(field); &#125; boolQuery.filter(QueryBuilders.rangeQuery("createrTime").gte(beginTime).lte(endTime)); // åˆ†é¡µ builder.withPageable(PageRequest.of(logCondition.getCurrentPage() - 1, logCondition.getPageSize())); // æŒ‰ç…§æ—¶é—´æ’åº builder.withSort(SortBuilders.fieldSort("createrTime").order(SortOrder.DESC)); builder.withQuery(boolQuery); ObjectMapper mapper = new ObjectMapper(); Page&lt;LogDto&gt; logDtos = elasticsearchTemplate.queryForPage(builder.build(), LogDto.class, new SearchResultMapper() &#123; @Override public &lt;T&gt; AggregatedPage&lt;T&gt; mapResults(SearchResponse searchResponse, Class&lt;T&gt; aClass, Pageable pageable) &#123; List&lt;T&gt; list = new ArrayList&lt;&gt;(); long totalHits = searchResponse.getHits().getTotalHits(); try &#123; for (SearchHit hit : searchResponse.getHits()) &#123; // æŠŠJSONå­—ç¬¦ä¸²è½¬æ¢æˆjavaå¯¹è±¡ T result = mapper.readValue(hit.getSourceAsString(), aClass); // è·å–é«˜äº®æ˜¾ç¤ºçš„å­—æ®µåç§° Collection&lt;HighlightField&gt; highlightFields = hit.getHighlightFields().values(); for (HighlightField highlightField : highlightFields) &#123; // æ›¿æ¢é«˜äº®æŸ¥è¯¢åˆ°çš„å±æ€§ BeanUtils.setProperty(result,highlightField.getName(),highlightField.getFragments()); &#125; list.add(result); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); return null; &#125; return new AggregatedPageImpl&lt;&gt;(list,pageable,totalHits,searchResponse.getAggregations()); &#125; &#125;); PageResult pageResult = new PageResult(Long.valueOf(logDtos.getTotalElements()).intValue(), logCondition.getCurrentPage(), logCondition.getPageSize(), logDtos.getContent()); return JSONResult.SUCC("",pageResult); &#125;&#125;äº”. æ¡ä»¶å®ä½“123456789101112131415161718192021222324/** * @Created by LuGuoZheng * @Description TODO * @Date 2019/9/26 9:28 */@Datapublic class LogCondition extends BaseCondition &#123; //æ—¥å¿—çº§åˆ« private String loglevel; //ç±»å private String classname; //å†…å®¹ private String mess; //èµ·å§‹æ—¶é—´ private String beginTime; //ç»“æŸæ—¶é—´ private String endTime;&#125;äº”. æµ‹è¯•ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849/** * @author LuGuoZheng * @date 2019/9/26 9:29 * @Version 3.0 * @description */@RunWith(SpringRunner.class)@SpringBootTestpublic class TestDemo &#123; @Autowired private LogESRepostoryFacade logESRepostoryFacade; @Autowired private ElasticsearchTemplate elasticsearchTemplate; @Test public void saveOrUpdate() throws ParseException &#123; LogDto logDto = new LogDto(); logDto.setId(UUID.randomUUID().toString()); logDto.setClassname("com.ylcloud.common.filter.CorsFilter"); logDto.setLoglevel("INFO "); logDto.setMess("=====admin-webåº”ç”¨å¯åŠ¨æˆåŠŸ====="); logDto.setCreaterTime("2019-09-25 18:30:00"); logESRepostoryFacade.save(logDto); &#125; @Test public void search() throws ParseException &#123; NativeSearchQueryBuilder builder = new NativeSearchQueryBuilder(); builder.withQuery(QueryBuilders.rangeQuery("createrTime").lte("2019-09-25 19:00:00")); List&lt;LogDto&gt; logDtos = elasticsearchTemplate.queryForList(builder.build(), LogDto.class); logDtos.forEach(System.out::println); &#125; @Test public void selectByParams() &#123; LogCondition logCondition = new LogCondition(); logCondition.setLoglevel("warn"); logCondition.setClassname("ClassPathMapperScanner"); logCondition.setMess("yllog"); logCondition.setBeginTime("2019-09-26 10:00:00"); logCondition.setEndTime("2019-09-26 12:00:00"); logCondition.setCurrentPage(1); logCondition.setPageSize(10); JSONResult jsonResult = logESRepostoryFacade.selectByParams(logCondition); Object data = jsonResult.getData(); System.out.println(data); &#125;&#125;]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[sqlè¯­å¥æŸ¥è¯¢ç»çº¬åº¦èŒƒå›´(è½¬)]]></title>
    <url>%2F2019%2F10%2F22%2Fsql%E8%AF%AD%E5%8F%A5%E6%9F%A5%E8%AF%A2%E7%BB%8F%E7%BA%AC%E5%BA%A6%E8%8C%83%E5%9B%B4%2F</url>
    <content type="text"><![CDATA[åŸæ–‡é“¾æ¥:https://segmentfault.com/q/1010000005100905SQLè¯­å¥å¦‚ä¸‹:123456789101112131415161718192021222324SELECT *FROM locationWHERE sqrt( ( ( (113.914619 - longitude) * PI() * 12656 * cos( ((22.50128 + latitude) / 2) * PI() / 180 ) / 180 ) * ( (113.914619 - longitude) * PI() * 12656 * cos( ((22.50128 + latitude) / 2) * PI() / 180 ) / 180 ) ) + ( ( (22.50128 - latitude) * PI() * 12656 / 180 ) * ( (22.50128 - latitude) * PI() * 12656 / 180 ) ) ) &lt; 2åŸæ–‡é“¾æ¥:https://segmentfault.com/q/1010000005100905æœ€è¿‘åœ¨åšæŸ¥è¯¢æŒ‡å®šç»çº¬åº¦èŒƒå›´çš„æ•°æ®ï¼›é—®é¢˜ä¸çŸ¥å¦‚ä½•ä¸‹æ‰‹ï¼Œäºæ˜¯ç½‘ä¸Šæ‰¾äº†ç‚¹èµ„æ–™ï¼Œå…¶ä¸­æœ‰äº›ä¸æ‡‚çš„åœ°æ–¹å¸Œæœ›å¤§å®¶èƒ½ç»™ç‚¹æƒ³æ³•ï¼é—®é¢˜æ˜¯è¿™æ ·çš„ï¼šsqlè¯­å¥æŸ¥è¯¢ç»çº¬åº¦èŒƒå›´æŒ‡å®šä¸€ä¸ªç»çº¬åº¦ï¼Œç»™å®šä¸€ä¸ªèŒƒå›´å€¼(å•ä½:åƒç±³)ï¼ŒæŸ¥å‡ºåœ¨ç»çº¬åº¦å‘¨å›´è¿™ä¸ªèŒƒå›´å†…çš„æ•°æ®ã€‚ç»åº¦:113.914619çº¬åº¦:22.50128èŒƒå›´:2kmlongitudeä¸ºæ•°æ®è¡¨ç»åº¦å­—æ®µlatitudeä¸ºæ•°æ®è¡¨çº¬åº¦å­—æ®µSQLåœ¨mysqlä¸‹æµ‹è¯•é€šè¿‡,å…¶ä»–æ•°æ®åº“å¯èƒ½éœ€è¦ä¿®æ”¹SQLè¯­å¥å¦‚ä¸‹:123456789101112131415161718192021222324SELECT *FROM locationWHERE sqrt( ( ( (113.914619 - longitude) * PI() * 12656 * cos( ((22.50128 + latitude) / 2) * PI() / 180 ) / 180 ) * ( (113.914619 - longitude) * PI() * 12656 * cos( ((22.50128 + latitude) / 2) * PI() / 180 ) / 180 ) ) + ( ( (22.50128 - latitude) * PI() * 12656 / 180 ) * ( (22.50128 - latitude) * PI() * 12656 / 180 ) ) ) &lt; 2]]></content>
      <categories>
        <category>MySQLæ•°æ®åº“ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockerå®¹å™¨å†…æ“ä½œæƒé™é—®é¢˜]]></title>
    <url>%2F2019%2F09%2F28%2Fdocker%E5%AE%B9%E5%99%A8%E5%86%85%E7%9B%AE%E5%BD%95%E9%97%B4%E7%A7%BB%E5%8A%A8%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[å‚è€ƒåšå®¢:https://blog.csdn.net/weixin_43577800/article/details/84844438 é—®é¢˜è§£å†³:é€€å‡ºå®¹å™¨è¿›å…¥å®¿ä¸»æœºä¸­,æˆæƒæŒ‚è½½çš„ä¸¤ä¸ªæ•°æ®å·1chown -R 1000 /home/softs/jenkinsæ˜ å°„äº†ä¸¤ä¸ªæ•°æ®å·,ä½†æ˜¯åœ¨dockerå®¹å™¨å†…éœ€è¦æŠŠæ•°æ®å·1çš„å†…å®¹ç§»åˆ°æ•°æ®å·2ç›®å½•é¡¹,å‡ºç°ä»¥ä¸‹æç¤º:æ²¡æœ‰æƒé™æ“ä½œâ€¦å‚è€ƒåšå®¢:https://blog.csdn.net/weixin_43577800/article/details/848444381cannot create regular file &apos;/var/yl_cloud/order.war&apos;: Permission deniedé—®é¢˜è§£å†³:é€€å‡ºå®¹å™¨è¿›å…¥å®¿ä¸»æœºä¸­,æˆæƒæŒ‚è½½çš„ä¸¤ä¸ªæ•°æ®å·1chown -R 1000 /home/softs/jenkins]]></content>
      <categories>
        <category>dockerå®¹å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£å†³åˆ›å»ºå®¹å™¨æ˜¯å‡ºç°çš„é”™è¯¯:IPv4 forwarding is disabled. Networking will not work.]]></title>
    <url>%2F2019%2F09%2F28%2F%E8%A7%A3%E5%86%B3%E5%88%9B%E5%BB%BA%E5%AE%B9%E5%99%A8%E6%98%AF%E5%87%BA%E7%8E%B0%E7%9A%84%E9%94%99%E8%AF%AF-IPv4-forwarding-is-disabled-Networking-will-not-work%2F</url>
    <content type="text"><![CDATA[è®°å½•~!æµ‹è¯•æœåŠ¡å™¨è·Ÿæ¢IPå,åœ¨å¯åŠ¨å®¹å™¨çš„æ—¶å€™å¯¼è‡´æ— æ³•è®¿é—®,ç„¶åå°è¯•é‡æ–°åˆ›å»ºå®¹å™¨,å‡ºç°äº†IPv4 forwarding is disabled. Networking will not work.é”™è¯¯..è§£å†³åŠæ³•ï¼šåœ¨å®¿ä¸»æœºä¸‹æ›´æ”¹00-system.confæ–‡ä»¶1vi /usr/lib/sysctl.d/00-system.confæ·»åŠ ä¸€ä¸‹ä»£ç 1net.ipv4.ip_forward=1é‡å¯networkæœåŠ¡1systemctl restart networkåŸæ–‡åšå®¢:https://blog.csdn.net/zhydream77/article/details/81902457]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>IPv4</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticSearchåŸºç¡€ç»ƒä¹ ]]></title>
    <url>%2F2019%2F09%2F22%2FElasticSearch%E5%9F%BA%E7%A1%80%E5%BA%94%E7%94%A8%2F</url>
    <content type="text"><![CDATA[è®°å½•ElasticSearchåŸºç¡€CRUDæ“ä½œå‚æ•°æ ¼å¼éƒ½æ˜¯6.xçš„æ ¼å¼,å®ä¾‹æ˜¯åœ¨7.xç‰ˆæœ¬ä¸‹å®Œæˆçš„,æ‰€ä»¥å®ä¾‹æ ¼å¼ä¸å‚æ•°æ ¼å¼æœ‰æ‰€å·®å¼‚åŸºäºlasticSearch 7.0ç‰ˆæœ¬çš„CRUDæ“ä½œ1. å»ºç«‹ç´¢å¼•åº“12# å»ºç«‹ç´¢å¼•åº“PUT /user1.1 å»ºç«‹ç´¢å¼•åº“å¹¶è®¾ç½®å‰¯æœ¬å’Œåˆ†ç‰‡Ps: 7.xç‰ˆæœ¬å‰¯æœ¬å’Œåˆ†ç‰‡é»˜è®¤ä¸º: 1å‚æ•°æ ¼å¼:PUT /{ç´¢å¼•åº“åç§°}12345678# å»ºç«‹ç´¢å¼•åº“å¹¶è®¾ç½®å‰¯æœ¬å’Œåˆ†ç‰‡PUT /user&#123; "settings": &#123; "number_of_replicas": 2, "number_of_shards": 3 &#125;&#125;1.2 # å»ºç«‹ç´¢å¼•åº“å¹¶è®¾ç½®mapping1234567891011121314151617181920212223PUT /user&#123; "settings": &#123; "number_of_replicas": 1, "number_of_shards": 4 &#125;, "mappings": &#123; "properties": &#123; "userId":&#123; "type": "keyword" &#125;, "name":&#123; "type": "keyword" &#125;, "age":&#123; "type": "keyword" &#125;, "deptId":&#123; "type": "keyword" &#125; &#125; &#125;&#125;2. åˆ é™¤ç´¢å¼•åº“å‚æ•°æ ¼å¼:DELETE /{ç´¢å¼•åº“åç§°}12# åˆ é™¤ç´¢å¼•åº“DELETE /user3. æ·»åŠ æ–‡æ¡£å‚æ•°æ ¼å¼:PUT /{ç´¢å¼•åº“}/{ç±»å‹}/{ç´¢å¼•id}1234567# æ·»åŠ æ–‡æ¡£PUT /user/_doc/1&#123; "userId":"4", "name":"I kittle", "memo":"xiao mi"&#125;4. æ£€ç´¢æ–‡æ¡£å‚æ•°æ ¼å¼:GET /{ç´¢å¼•åº“}/{ç±»å‹}/{ç´¢å¼•id}12# è·å–æ–‡æ¡£GET /user/_doc/15. æ£€ç´¢æ–‡æ¡£:æ’åºå‚æ•°æ ¼å¼GET /{ç´¢å¼•åº“}/{ç±»å‹}/_search{â€œsortâ€:[{â€œageâ€:â€ascâ€}]}1234567# æœç´¢æ–‡æ¡£:æ’åºGET /user/_doc/_search&#123; "sort":[ &#123;"age":"asc"&#125; ]&#125;6.æ£€ç´¢æŸ¥è¯¢å‚æ•°æ ¼å¼:GET /user/_doc/_search{â€œqueryâ€:{{æ£€ç´¢æ–¹å¼}:{field:value}}}æ£€ç´¢æ–¹å¼:termè¡¨ç¤ºç²¾ç¡®åŒ¹é…,valueå€¼ä¸ä¼šè¢«åˆ†è¯å™¨æ‹†åˆ†,æŒ‰ç…§å€’æ’ç´¢å¼•åŒ¹é…,ä¸€èˆ¬ç”¨äºfilterä¸­match_phraseè¡¨ç¤ºçŸ­è¯­æ£€ç´¢,valueå€¼ä¸ä¼šè¢«åˆ†è¯å™¨æ‹†åˆ†,ç›´æ¥å»å€’æ’ç´¢å¼•ä¸­åŒ¹é…matchè¡¨ç¤ºå…¨æ–‡æ£€ç´¢,valueå€¼ä¼šè¢«åˆ†è¯å™¨æ‹†åˆ†,ç„¶åå»å€’æ’ç´¢å¼•ä¸­åŒ¹é…rangeè¡¨ç¤ºèŒƒå›´æ£€ç´¢,æœ‰ gt/gte/lt/lte ç­‰6.1 æŸ¥è¯¢åç§°ä¸ºâ€™wang daâ€™çš„å‘˜å·¥123456789# æŸ¥è¯¢åç§°ä¸º'wang da'çš„å‘˜å·¥GET /user/_search&#123; "query":&#123; "term":&#123; "name":"wang" &#125; &#125;&#125;6.2 ä½¿ç”¨matchæŸ¥è¯¢â€™wangâ€™å‘˜å·¥123456789# ä½¿ç”¨matchæŸ¥è¯¢'wang'å‘˜å·¥GET /user/_search&#123; "query":&#123; "term":&#123; "name":"wang" &#125; &#125;&#125;6.3 æŸ¥è¯¢å‡º28åˆ°30å²çš„å‘˜å·¥123456789101112# æŸ¥è¯¢å‡º28åˆ°30å²çš„å‘˜å·¥GET /user/_search&#123; "query": &#123; "range": &#123; "age": &#123; "gte": 28, "lte": 30 &#125; &#125; &#125;&#125;7. å…³é”®å­—æŸ¥è¯¢multi_match:è¡¨ç¤ºåœ¨å¤šä¸ªå­—æ®µé—´åšæ£€ç´¢12345678910#å…³é”®å­—æŸ¥è¯¢GET /emp/_search&#123; "query": &#123; "multi_match": &#123; "query": "am", "fields": ["name","memo"] &#125; &#125;&#125;8. æŠ•å½±æŸ¥è¯¢ç±»ä¼¼MySQLçš„æŸ¥è¯¢è¯­å¥ä¸­selectåé¢çš„å­—æ®µä¸€æ ·12345678910111213# æŸ¥è¯¢æŒ‡å®šå­—æ®µ'_source'å’Œ'query'æ˜¯åŒä¸€çº§åˆ«çš„GET /user/_search&#123; "_source":["name","age"] , "query": &#123; "range": &#123; "age": &#123; "gte": 28, "lte": 30 &#125; &#125; &#125;&#125;9. é«˜äº®æ˜¾ç¤º1234567891011121314151617# 'am'é«˜äº®æ˜¾ç¤º,é«˜äº®æŸ¥è¯¢:æŠŠæ£€ç´¢å‡ºæ¥çš„æ–‡æ¡£åŒ¹é…çš„å†…å®¹é«˜äº®æ˜¾ç¤º,éœ€è¦é…åˆæ£€ç´¢ä½¿ç”¨,æŠŠæŸ¥è¯¢çš„å†…å®¹é«˜äº®GET /emp/_search&#123; "query": &#123; "multi_match": &#123; "query": "am", "fields": ["name","memo"] &#125; &#125;, "_source": ["userId","name","memo"], "highlight": &#123; "fields": &#123; "name":&#123;&#125;, "memo":&#123;&#125; &#125; &#125;&#125;10. é€»è¾‘æŸ¥è¯¢é€»è¾‘æŸ¥è¯¢è§„åˆ™: must/should/must_not,ç›¸å½“äº and/or/notå‚æ•°æ ¼å¼:10.1 æ£€ç´¢éƒ¨é—¨ä¸º1,å¹¶ä¸”å¤§äº32å²çš„å‘˜å·¥12345678910111213141516171819202122#éœ€æ±‚:è·å–éƒ¨é—¨ä¸º1,å¹¶ä¸”å¤§äº32å²çš„å‘˜å·¥GET /user/_search&#123; "query": &#123; "bool": &#123; "must": [ &#123; "term": &#123; "deptId":1 &#125; &#125;, &#123; "range": &#123; "age": &#123; "gt": 32 &#125; &#125; &#125; ] &#125; &#125;&#125;10.2 æ£€ç´¢å‡ºéƒ¨é—¨1æˆ–è€…å°äº30å²çš„å‘˜å·¥.123456789101112131415161718192021222324252627282930#éœ€æ±‚:æ£€ç´¢å‡ºéƒ¨é—¨1æˆ–è€…å°äº30å²çš„å‘˜å·¥.GET /user/_search&#123; "sort": [ &#123; "age": &#123; "order": "asc" &#125;, "deptId":"asc" &#125; ], "query": &#123; "bool": &#123; "should": [ &#123; "term": &#123; "deptId":1 &#125; &#125;, &#123; "range": &#123; "age": &#123; "gt": 30 &#125; &#125; &#125; ] &#125; &#125;&#125;10.3 è·å–éƒ¨é—¨ä¸ä¸º1çš„å‘˜å·¥12345678910111213141516171819202122#éœ€æ±‚:è·å–éƒ¨é—¨ä¸ä¸º1çš„å‘˜å·¥GET /user/_search&#123; "sort": [ &#123; "deptId": &#123; "order": "asc" &#125; &#125; ], "query": &#123; "bool": &#123; "must_not": [ &#123; "term": &#123; "deptId": "1" &#125; &#125; ] &#125; &#125;&#125;11. è¿‡æ»¤æŸ¥è¯¢filterè¡¨ç¤ºåœ¨æŸ¥è¯¢ä¸­ä¸æ¶‰åŠè¯„åˆ†,å¹¶ä¸”æœ‰ç¼“å­˜,ç”¨äºç²¾ç¡®åŒ¹é…,filterä¸­çš„æ£€ç´¢æ–¹å¼å¤šä¸ºterm123456789101112131415161718192021GET /user/_search&#123; "query": &#123; "bool": &#123; "filter": [ &#123; "term": &#123; "deptId": 1 &#125; &#125;, &#123; "range": &#123; "age":&#123; "gt":30 &#125; &#125; &#125; ] &#125; &#125;&#125;12. åˆ†ç»„æŸ¥è¯¢åˆ†ç»„è¿ç®—:avg/sum/min/max/value_count/stats(æ‰§è¡Œä»¥ä¸Šæ‰€æœ‰åŠŸèƒ½)12.1 ç»Ÿè®¡å„éƒ¨é—¨å¹³å‡å¹´é¾„12345678910111213141516171819#éœ€æ±‚:ç»Ÿè®¡å„éƒ¨é—¨å¹³å‡å¹´é¾„GET /user/_search&#123; "aggs": &#123; "groupByDeptId":&#123; "terms": &#123; "field": "deptId", "size": 10 &#125;, "aggs": &#123; "userAge": &#123; "avg": &#123; "field": "age" &#125; &#125; &#125; &#125; &#125;&#125;12.2 ç»Ÿè®¡å„éƒ¨é—¨çš„äººæ•°12345678910111213141516171819#éœ€æ±‚:ç»Ÿè®¡å„éƒ¨é—¨çš„äººæ•°GET /user/_search&#123; "aggs": &#123; "groupByDeptId": &#123; "terms": &#123; "field": "deptId", "size": 10 &#125;, "aggs": &#123; "totalCount": &#123; "value_count": &#123; "field": "deptId" &#125; &#125; &#125; &#125; &#125;&#125;12.3 ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨æœ€å¤§å¹´é¾„12345678910111213141516171819#éœ€æ±‚:ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨æœ€å¤§å¹´é¾„GET /user/_search&#123; "aggs": &#123; "groupByDeptId": &#123; "terms": &#123; "field": "deptId", "size": 10 &#125;, "aggs": &#123; "maxAge": &#123; "max": &#123; "field": "age" &#125; &#125; &#125; &#125; &#125;&#125;12.4 ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨æœ€å°å¹´é¾„12345678910111213141516171819#éœ€æ±‚:ç»Ÿè®¡æ¯ä¸ªéƒ¨é—¨æœ€å°å¹´é¾„GET /user/_search&#123; "aggs": &#123; "groupBydeptId": &#123; "terms": &#123; "field": "deptId", "size": 10 &#125;, "aggs": &#123; "minAge": &#123; "min": &#123; "field": "age" &#125; &#125; &#125; &#125; &#125;&#125;12.5 ç»Ÿè®¡æ‰€æœ‰å‘˜å·¥å¹´é¾„æ€»å’Œ1234567891011#éœ€æ±‚:ç»Ÿè®¡æ‰€æœ‰å‘˜å·¥å¹´é¾„æ€»å’ŒGET /user/_search&#123; "aggs": &#123; "sumAge": &#123; "sum": &#123; "field": "age" &#125; &#125; &#125;&#125;12.6 ä½¿ç”¨stateå‡½æ•°12345678910111213141516171819#éœ€æ±‚:ä½¿ç”¨stateå‡½æ•°GET /user/_search&#123; "aggs": &#123; "groupByDeptId": &#123; "terms": &#123; "field": "deptId", "size": 10 &#125;, "aggs": &#123; "stateUse": &#123; "stats": &#123; "field": "age" &#125; &#125; &#125; &#125; &#125;&#125;]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LinuxæŸ¥çœ‹MySQLåˆå§‹å¯†ç ,é…ç½®è¿œç¨‹è®¿é—®]]></title>
    <url>%2F2019%2F09%2F21%2FMySQL%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[æŸ¥çœ‹åˆå§‹å¯†ç 1grep &quot;password&quot; /var/log/mysqld.logç™»å½•MySQL1mysql -u root -på®ç°è¿œç¨‹è¿æ¥ï¼ˆæ”¹è¡¨æ³•ï¼‰12use mysql;update user set host = &apos;%&apos; where user = &apos;root&apos;;å®ç°è¿œç¨‹è¿æ¥(æˆæƒæ³•)123use mysql;grant all privileges on *.* to root@&apos;%&apos; identified by &quot;password&quot;;flush privileges;]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è§£å†³MySQLé”™è¯¯:Too many connections]]></title>
    <url>%2F2019%2F09%2F21%2F%E8%A7%A3%E5%86%B3MySQL%E9%94%99%E8%AF%AF-Too-many-connections%2F</url>
    <content type="text"><![CDATA[è®°å½•~!è§£å†³MySQLé”™è¯¯:Too many connectionsåœ¨æ­å»ºæµ‹è¯•æœåŠ¡å™¨çš„æ—¶å€™é‡æ–°å®‰è£…äº†MySQL,é…ç½®æ–‡ä»¶æ²¡æœ‰å¤‡ä»½è¿‡æ¥,å¯¼è‡´é¡¹ç›®å¯åŠ¨çš„æ—¶å€™å‡ºç°äº†Too many connectionsé”™è¯¯..å³æ˜¯è¿æ¥å¤ªå¤šäº†..è¿™å°±éœ€è¦æˆ‘ä»¬é…ç½®MySQLçš„è¿æ¥æ•°äº†..åœ¨MySQLå®˜æ–¹æ–‡æ¡£ä¸­æœ‰è¯´æ˜è¿æ¥æ•°é»˜è®¤å€¼ä¸º151MySQLå®˜æ–¹æ–‡æ¡£]]></content>
      <categories>
        <category>MySQLæ•°æ®åº“ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[yumå®‰è£…MySQL]]></title>
    <url>%2F2019%2F09%2F21%2Fyum%E5%AE%89%E8%A3%85MySQL%2F</url>
    <content type="text"><![CDATA[ä¸‹è½½å¹¶å®‰è£…MySQLå®˜æ–¹çš„ Yum Repository1wget -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpmä½¿ç”¨ä¸Šé¢çš„å‘½ä»¤å°±ç›´æ¥ä¸‹è½½äº†å®‰è£…ç”¨çš„Yum Repository,ç„¶åå°±å¯ä»¥ç›´æ¥yumå®‰è£…ã€‚1yum -y install mysql57-community-release-el7-10.noarch.rpmä½¿ç”¨yumå®‰è£…MySQL1yum -y install mysql-community-serverMySQLæ•°æ®åº“è®¾ç½®å…ˆå¯åŠ¨MySQL1systemctl start mysqldæŸ¥çœ‹å¯åŠ¨çŠ¶æ€1systemctl status mysqldæŸ¥çœ‹åˆå§‹å¯†ç 1grep &quot;password&quot; /var/log/mysqld.logç™»å½•MySQL1mysql -u root -på®ç°è¿œç¨‹è¿æ¥ï¼ˆæ”¹è¡¨æ³•ï¼‰12use mysql;update user set host = &apos;%&apos; where user = &apos;root&apos;;å®ç°è¿œç¨‹è¿æ¥(æˆæƒæ³•)123use mysql;grant all privileges on *.* to root@&apos;%&apos; identified by &quot;password&quot;;flush privileges;]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>MySQL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxé…ç½®javaç¯å¢ƒ]]></title>
    <url>%2F2019%2F09%2F20%2FLinux%E9%85%8D%E7%BD%AEjava%E7%8E%AF%E5%A2%83%2F</url>
    <content type="text"><![CDATA[javaç¯å¢ƒé…ç½®é€šè¿‡ftpæŠŠjdkä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶è§£å‹1tar -zxvf jdk-8u181-linux-x64.tar.gzé€šè¿‡pwdå‘½ä»¤è·å–è·¯å¾„ä¿®æ”¹/etc/profileæ–‡ä»¶åŠ å…¥ä»¥ä¸‹é…ç½®ps:å¤šä¸ªç¯å¢ƒå˜é‡è·¯å¾„ä¹‹é—´ç”¨:éš”å¼€123456#Jdk JAVA_HOME=/home/softs/java8/jdk1.8.0_181/PATH=$JAVA_HOME/bin#æ–‡ä»¶å°¾éƒ¨åŠ å…¥PATH=$PATHexport PATHåˆ·æ–°é…ç½®1source /etc/profileæµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸ1java -version]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>Linux</tag>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ·»åŠ ä»£ç å¤åˆ¶åŠŸèƒ½]]></title>
    <url>%2F2019%2F09%2F08%2FHexo%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81%E5%A4%8D%E5%88%B6%E5%8A%9F%E8%83%BD%2F</url>
    <content type="text"><![CDATA[è®°å½•Hexoæ·»åŠ ä»£ç å¤åˆ¶åŠŸèƒ½~!1. åœ¨jsç›®å½•æ·»åŠ clipboard.min.jsæ–‡ä»¶clipboard.min.js2.åœ¨jsç›®å½•æ·»åŠ cpbutt.jsæ–‡ä»¶1234567891011121314151617181920212223242526272829303132$(function () &#123; $('table').each(function (i, e) &#123; var $wrap = $('&lt;div&gt;').addClass('highlight-wrap'); $(e).after($wrap); $wrap.append($('&lt;button&gt;').addClass('copy-btn').append('å¤åˆ¶').on('click', function (e) &#123; var code = $(this).parent().find('.code').find('.line').map(function (i, e) &#123; return $(e).text(); &#125;).toArray().join('\n'); var ta = document.createElement('textarea'); var yPosition = window.pageYOffset || document.documentElement.scrollTop; ta.style.top = yPosition + 'px'; // Prevent page scroll ta.style.position = 'absolute'; ta.style.opacity = '0'; ta.readOnly = true; ta.value = code; document.body.appendChild(ta); ta.select(); ta.setSelectionRange(0, code.length); ta.readOnly = false; var result = document.execCommand('copy'); if (result) $(this).text('å¤åˆ¶æˆåŠŸ'); else $(this).text('å¤åˆ¶å¤±è´¥'); ta.blur(); // For iOS $(this).blur(); &#125;)).on('mouseleave', function (e) &#123; var $b = $(this).find('.copy-btn'); setTimeout(function () &#123; $b.text('å¤åˆ¶'); &#125;, 300); &#125;).append(e); &#125;);&#125;)Ps:è®°å¾—å¼•å…¥è¿ä¸ªjsæ–‡ä»¶]]></content>
      <categories>
        <category>Hexoä¹‹çæŠ˜è…¾ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoæ·»åŠ ä¼Šå¸ƒæ¨¡å‹]]></title>
    <url>%2F2019%2F09%2F08%2FHexo%E6%B7%BB%E5%8A%A0%E4%BC%8A%E5%B8%83%E6%A8%A1%E5%9E%8B%2F</url>
    <content type="text"><![CDATA[è®°å½•Hexoæ·»åŠ ä¼Šå¸ƒæ¨¡å‹~!1. åœ¨layout.ejsä¸­åŠ å…¥ä»¥ä¸‹htmlä»£ç ç‰‡æ®µ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;div class="eevee"&gt; &lt;div class="message"&gt;å—¨ï¼Œä½ å¥½å•Š~~&lt;/div&gt; &lt;div class="body"&gt; &lt;div class="head"&gt; &lt;div class="ears"&gt; &lt;div class="ear"&gt; &lt;div class="lobe"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="ear"&gt; &lt;div class="lobe"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="face"&gt; &lt;div class="eyes"&gt; &lt;div class="eye"&gt; &lt;div class="eyelid"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="eye"&gt; &lt;div class="eyelid"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="nose"&gt;&lt;/div&gt; &lt;div class="mouth"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="chest"&gt; &lt;div class="fur"&gt; &lt;div class="patch"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="fur"&gt; &lt;div class="patch"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="fur"&gt; &lt;div class="patch"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="legs"&gt; &lt;div class="leg"&gt; &lt;div class="inner-leg"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="leg"&gt; &lt;div class="inner-leg"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="leg"&gt; &lt;div class="inner-leg"&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class="leg"&gt; &lt;div class="inner-leg"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="tail"&gt; &lt;div class="tail"&gt; &lt;div class="tail"&gt; &lt;div class="tail"&gt; &lt;div class="tail"&gt; &lt;div class="tail -end"&gt;&lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt;&lt;/div&gt;2. jsç›¸å…³ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697(() =&gt; &#123;// ä¼Šå¸ƒå¤åˆ¶æ¶ˆæ¯ document.addEventListener('copy', function (e) &#123; showMessage('&lt;span style="color:red;"&gt;ä½ éƒ½å¤åˆ¶äº†äº›ä»€ä¹ˆå‘€ï¼Œè½¬è½½è¦è®°å¾—åŠ ä¸Šå‡ºå¤„å“¦~~&lt;/span&gt;', 5000); var seletedText = window.getSelection() if (seletedText.toString().length &lt; 88) &#123; return &#125; addCopyright(e) e.preventDefault() &#125;) function renderTip(template, context) &#123; var tokenReg = /(\\)?\&#123;([^\&#123;\&#125;\\]+)(\\)?\&#125;/g; return template.replace(tokenReg, function (word, slash1, token, slash2) &#123; if (slash1 || slash2) &#123; return word.replace('\\', ''); &#125; var variables = token.replace(/\s/g, '').split('.'); var currentObject = context; var i, length, variable; for (i = 0, length = variables.length; i &lt; length; ++i) &#123; variable = variables[i]; currentObject = currentObject[variable]; if (currentObject === undefined || currentObject === null) return ''; &#125; return currentObject; &#125;); &#125; String.prototype.renderTip = function (context) &#123; return renderTip(this, context); &#125;; function initTips() &#123; $.ajax(&#123; cache: true, url: `http://localhost:4000/message.json`, dataType: "json", success: function (result) &#123; console.log(result); $.each(result.mouseover, function (index, tips) &#123; $(tips.selector).mouseover(function () &#123; var text = tips.text; if (Array.isArray(tips.text)) text = tips.text[Math.floor(Math.random() * tips.text.length + 1) - 1]; text = text.renderTip(&#123; text: $(this).text() &#125;); showMessage(text, 3000); &#125;); &#125;); $.each(result.click, function (index, tips) &#123; $(tips.selector).click(function () &#123; var text = tips.text; if (Array.isArray(tips.text)) text = tips.text[Math.floor(Math.random() * tips.text.length + 1) - 1]; text = text.renderTip(&#123; text: $(this).text() &#125;); showMessage(text, 3000); &#125;); &#125;); &#125; &#125;); &#125;// åˆå§‹åŒ–æ¶ˆæ¯ initTips(); function showMessage(text, timeout) &#123; if (Array.isArray(text)) text = text[Math.floor(Math.random() * text.length + 1) - 1]; $('.message').stop(); $('.message').html(text).fadeTo(200, 1); timeout = timeout || 5000; hideMessage(timeout); &#125; function hideMessage(timeout) &#123; $('.message').stop().css('opacity', 1); if (timeout === null) timeout = 5000; $('.message').delay(timeout).fadeTo(200, 0); &#125;&#125;)();window.setInterval(showHitokoto, 30000);function showHitokoto() &#123; $.getJSON('https://v1.hitokoto.cn/', function (result) &#123; showMessage(result.hitokoto, 5000); &#125;);&#125;function showHitokoto() &#123; $.getJSON('', function (result) &#123; showMessage(result.hitokoto, 5000); &#125;);&#125;]]></content>
      <categories>
        <category>Hexoä¹‹çæŠ˜è…¾ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>åšå®¢</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[jenkinsé€šè¿‡sshå‘é€æ–‡ä»¶æˆ–æ‰§è¡Œå‘½ä»¤]]></title>
    <url>%2F2019%2F09%2F07%2Fjenkins%E9%80%9A%E8%BF%87ssh%E5%8F%91%E9%80%81%E6%96%87%E4%BB%B6%E6%88%96%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[è®°å½•jenkinsé€šè¿‡sshæ‰§è¡Œå‘½ä»¤é…ç½®~!1.éœ€æ±‚:ç”±äºä½¿ç”¨dockeréƒ¨ç½²çš„jenkins,åœ¨é¡¹ç›®æ„å»ºå®Œæˆä¹‹å,éœ€è¦è°ƒç”¨å®¿ä¸»æœºçš„shellè„šæœ¬æŠŠæœåŠ¡å¯åŠ¨èµ·æ¥2.åœ¨jenkinså®‰è£…Publish over SSHæ’ä»¶ç³»ç»Ÿç®¡ç† &gt; æ’ä»¶ç®¡ç† &gt; å¯é€‰æ’ä»¶: æœç´¢Publish over SSH,ç›´æ¥å®‰è£…å³å¯.3.é…ç½®Publish over SSHç³»ç»Ÿç®¡ç† &gt; ç³»ç»Ÿè®¾ç½® &gt; Publish over SSHè¿™é‡Œç›´æ¥é‡‡ç”¨äº†ç™»å½•è´¦å·å’Œå¯†ç ç›´æ¥ç™»å½•çš„,æ²¡æœ‰é‡‡ç”¨é…ç½®å¯†é’¥çš„æ–¹å¼.PS:é…ç½®å®Œå,å¯ä»¥ç‚¹å‡»å³ä¸‹è§’çš„æµ‹è¯•æŒ‰é’®æ£€æŸ¥æ˜¯å¦èƒ½è¿æ¥ä¸Š,å¦‚æœæˆåŠŸå³é…ç½®å®Œæˆäº†,å¤±è´¥å°±æ£€æŸ¥ä¸‹ç™»å½•åå’Œå¯†ç å§â€¦4.Publish over SSHä½¿ç”¨åˆ›å»ºä»»åŠ¡çš„æ—¶,åœ¨å¤Ÿå»ºæ­¥éª¤ä¸­é€‰æ‹©é€šè¿‡SSHå‘é€æ–‡ä»¶æˆ–æ‰§è¡Œå‘½ä»¤,]]></content>
      <categories>
        <category>æµ‹è¯•æœåŠ¡å™¨æ­å»ºè®°å½•</category>
      </categories>
      <tags>
        <tag>jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxé…ç½®LD_LIBRARY_PATHç¯å¢ƒå˜é‡]]></title>
    <url>%2F2019%2F09%2F07%2FLinux%E9%85%8D%E7%BD%AELD-LIBRARY-PATH%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%2F</url>
    <content type="text"><![CDATA[è®°å½•Linuxé…ç½®LD_LIBRARY_PATHç¯å¢ƒå˜é‡~!é¡¹ç›®å¼€å‘ä¸­æœ‰ç”¨åˆ°ä¸€äº›ç¬¬ä¸‰æ–¹çš„åŠ¨æ€åº“(so),å°±éœ€è¦æŠŠ.soæ–‡ä»¶æ”¾ç½®æŸä¸ªç›®å½•ä¸‹,ç„¶åé…ç½®ç¯å¢ƒå˜é‡å³å¯..ä¿®æ”¹/etc/profileæ–‡ä»¶.åŠ å…¥ä»¥ä¸‹é…ç½®å³å¯.1export LD_LIBRARY_PATH=/home/yanfa_ylcloud_java/solib:$LD_LIBRARY_PATHåˆ·æ–°é…ç½®1source /etc/profilePs:åˆ·ä¸‹é…ç½®åå‘ç°è¿˜æ˜¯æ²¡æœ‰æ•ˆæœ,éœ€è¦é‡æ–°å¯åŠ¨é¡¹ç›®..ä¿®æ”¹å:]]></content>
      <categories>
        <category>æµ‹è¯•æœåŠ¡å™¨æ­å»ºè®°å½•</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockeréƒ¨ç½²jenkins]]></title>
    <url>%2F2019%2F09%2F05%2Fdocker%E9%83%A8%E7%BD%B2jenkins%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨dockeréƒ¨ç½²jenkins,å®ç°æµæ°´çº¿éƒ¨ç½²é¡¹ç›®~!jenkinså®¹å™¨åœ°å€:https://hub.docker.com/r/jenkins/jenkinsä½¿ç”¨dockeréƒ¨ç½²jenkins,å®ç°æµæ°´çº¿éƒ¨ç½²é¡¹ç›®~!jenkinså®¹å™¨åœ°å€:https://hub.docker.com/r/jenkins/jenkins1. ç›´æ¥æ‹‰å»å®˜æ–¹é•œåƒ1docker pull jenkins/jenkins2. å¯åŠ¨jenkins1docker run -d -p 8081:8080 --name jenkins --privileged=true -v /home/softs/jenkins:/var/jenkins_home jenkins/jenkins:latest2.1 å‚æ•°è¯´æ˜:-d: åå°è¿è¡Œå®¹å™¨-p: æŠŠå®¹å™¨8080ç«¯å£æ˜ å°„åˆ°å®¿ä¸»æœº8081ç«¯å£,æµè§ˆå™¨è®¿é—®8081ç«¯å£å³å¯.â€“name: å®¹å™¨çš„åˆ«å-v: æ•°æ®å·,æŠŠå®¹å™¨ä¸­çš„/var/jenkins_homeç›®å½•æ˜ å°„åˆ°å®¿ä¸»æœºçš„/home/softs/jenkins`ç›®å½•ä¸Š,å¯ä»¥ä¸å®¿ä¸»æœºå…±äº«ç©ºé—´2.2 è¿›å…¥å®¹å™¨è·å–jenkinsåˆå§‹å¯†ç 123docker exec -it jenkins /bin/bashcat /var/jenkins_home/secrets/initialAdminPassword3. é…ç½®jenkinsç³»ç»Ÿç®¡ç† &gt; å…¨å±€å·¥å…·é…ç½®JDK/Maven/Git:è¿™é‡Œéƒ½æ˜¯ä½¿ç”¨è‡ªåŠ¨å®‰è£…,ä¹Ÿå¯ç”¨é€šè¿‡æ•°æ®å·æ˜ å°„,ä½¿ç”¨å®¿ä¸»æœºçš„é…ç½®Ps:è‡ªåŠ¨å®‰è£…JDKéœ€è¦é€šè¿‡Oracleç­‰è´¦å·ä¸‹è½½å®‰è£…,æ²¡æœ‰å°±éœ€è¦å»æ³¨å†Œä¸€ä¸ª..4. æ–°å»ºä»»åŠ¡æµ‹è¯•æ¥ä¸‹æ¥å»ºç«‹ä¸€ä¸ªä»»åŠ¡æµ‹è¯•æºç ç®¡ç†é…ç½®æ„å»ºä»¥åŠéœ€è¦æ‰§è¡Œçš„å‘½ä»¤é…ç½®5. æ‰§è¡Œæ„å»ºä»»åŠ¡æŸ¥çœ‹æ§åˆ¶å°:SUCCESS:è¡¨ç¤ºæ„å»ºæˆåŠŸ.]]></content>
      <categories>
        <category>æµ‹è¯•æœåŠ¡å™¨æ­å»ºè®°å½•</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>jenkins</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Rediså¸¸ç”¨é…ç½®]]></title>
    <url>%2F2019%2F09%2F04%2FRedis%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE%2F</url>
    <content type="text"><![CDATA[è®°å½•rediså¸¸ç”¨çš„é…ç½®~!æŠŠrediså®‰è£…ä¸Šå»åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹redisçš„å¸¸ç”¨é…ç½®ã€‚Redisçš„é…ç½®æ–‡ä»¶åœ¨rediså®‰è£…ç›®å½•ä¸­ï¼Œæ–‡ä»¶åå«redis.confæˆ‘ä»¬å·²ç»æŠŠrediså®‰è£…ä¸Šå»äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹redisçš„å¸¸ç”¨é…ç½®ã€‚Redisçš„é…ç½®æ–‡ä»¶åœ¨rediså®‰è£…ç›®å½•ä¸­ï¼Œæ–‡ä»¶åå«redis.conf1.ç«¯å£:portportï¼šæœåŠ¡çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸º63792.åå°è¿è¡Œ:daemonizedaemonizeï¼šåå°è¿è¡Œï¼Œå€¼ä¸ºyes | no é»˜è®¤ä¸ºno3.å¯†ç :requirepassrequirepassï¼šå¯†ç ï¼Œé»˜è®¤æ˜¯æ²¡æœ‰å¯†ç Ps:ç™»å½•æœ‰å¯†ç çš„redis123redis-cli -p 6379 -a &lt;å¯†ç &gt;auth &lt;å¯†ç &gt;ä¹Ÿå¯ç”¨ç™»å½•rediså‘½ä»¤è®¾ç½®å¯†ç ,ä½†è¿™æ˜¯ä¸€æ¬¡æ€§çš„,é‡å¯åå¤±æ•ˆ12345// è®¾ç½®å¯†ç config set requirepass test123// è·å–å¯†ç config get requirepass4.ä¿æŠ¤æ¨¡å¼:protected-modeprotected-modeï¼šä¿æŠ¤æ¨¡å¼ï¼Œå€¼ä¸ºes | noé»˜è®¤æ˜¯yesï¼Œä¸èƒ½è¿œç¨‹è®¿é—®è¯¥redisæœåŠ¡ï¼Œå¦‚æœéœ€è¦è¿œç¨‹è®¿é—®ï¼Œåˆ™è¯¥ä¸ºnoã€‚5.ç»‘å®šçš„IPåœ°å€bindï¼šç»‘å®šçš„IPåœ°å€ï¼Œé»˜è®¤æ˜¯ç»‘å®šæœ¬æœºåœ°å€127.0.0.1ï¼Œå¦‚æœéœ€è¦å…¶ä»–IPèƒ½è®¿é—®åˆ°è¯¥redisæœåŠ¡ï¼Œåˆ™åœ¨è¿™ä¸ªå±æ€§æ·»åŠ IPåœ°å€ï¼Œæˆ–è€…ç›´æ¥æŠŠè¯¥å±æ€§æ³¨é‡Šæ‰ï¼Œè¿™æ ·æ‰€æœ‰çš„IPåœ°å€éƒ½å¯ä»¥è®¿é—®]]></content>
      <categories>
        <category>æµ‹è¯•æœåŠ¡å™¨æ­å»ºè®°å½•</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Rediså®‰è£…]]></title>
    <url>%2F2019%2F09%2F04%2FRedis%E5%AE%89%E8%A3%85%2F</url>
    <content type="text"><![CDATA[Linuxå®‰è£…redisæ­¥éª¤è®°å½•~!1.å®‰è£…gcc1yum install -y gcc2.ä¸‹è½½æ‰€éœ€çš„ redis å®‰è£…åŒ…ï¼Œå¹¶ä¸Šä¼ è‡³æœåŠ¡å™¨1/home/softs/redis3.è§£å‹å®‰è£…åŒ…1tar -zxvf redis.x.tar.gz4.è¿›å…¥ redis æ ¹ç›®å½•,æ‰§è¡Œç¼–è¯‘ä¸å®‰è£…1make &amp;&amp; make install5.è¿›å…¥srcç›®å½•ï¼Œå¯åŠ¨ redis æœåŠ¡å™¨1redis-server6.æ³¨å†ŒredisæœåŠ¡å¹¶è®¾ç½®åå°è¿è¡Œ1ã€ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ä¸­çš„daemonizeä¸ºyes2ã€æ‰¾åˆ° redis æ ¹ç›®å½•ä¸‹é¢ utils ä¸­çš„ redis_init_script æ–‡ä»¶ï¼Œå¹¶å°†å…¶å¤åˆ¶åˆ° /etc/init.d/ åé‡å‘½åä¸º redis1cp /home/softs/reddis/utils/redis_init_script /etc/init.d/redis3ã€ä¿®æ”¹ /etc/init.d/redis é…ç½®ï¼Œå°†ç›¸å…³çš„ redis è·¯å¾„å·²ç»é…ç½®æ–‡ä»¶è·¯å¾„ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ redis æ‰€åœ¨ä½ç½®çš„è·¯å¾„å³å¯ã€‚4ã€æ­¤æ—¶å°±å¯ä»¥åå°çš„æ–¹å¼è¿è¡Œredisäº†ï¼Œåœ¨ä»»æ„åœ°æ–¹æ‰§è¡ŒLinuxæœåŠ¡å‘½ä»¤ï¼Œåå°è¿è¡ŒredisæœåŠ¡ï¼šå¼€å¯æœåŠ¡ï¼šservice redis startå…³é—­æœåŠ¡ï¼šservice redis stopPS: ï¼ˆæ³¨æ„ï¼šå¦‚æœredisè®¾ç½®äº†å¯†ç ï¼Œé‚£ä¹ˆéœ€è¦åœ¨/etc/init.d/redisè¿™ä¸ªè„šæœ¬æ–‡ä»¶stopé¡¹ï¼ŒæŠŠ$CLIEXEC -P $REDISPORT shutdownè¿™è¡Œé…ç½®æ·»åŠ ä¸€ä¸ªå¯†ç ï¼š-a YouPasswordï¼‰,å¦åˆ™rediså°†ä¸èƒ½æ­£å¸¸å…³é—­ã€‚7. Rediså®¢æˆ·ç«¯æµ‹è¯•è¿›å…¥srcç›®å½•ï¼Œè¿è¡Œredisçš„å®¢æˆ·ç«¯ç¨‹åº:redis-cliå‚æ•°ï¼š-h ä¸»æœºipï¼ˆä¸å†™çš„è¯é»˜è®¤æœ¬æœºï¼‰-p ç«¯å£ï¼ˆä¸å†™çš„è¯é»˜è®¤6379ï¼‰-a å¯†ç 8. å¼€å¯è¿œç¨‹è¿æ¥1ã€æŠŠredis.confé…ç½®æ–‡ä»¶çš„protected-modeå±æ€§ä¿®æ”¹ä¸ºnoï¼Œå…³é—­redisçš„åŒ…å«æ¨¡å¼ã€‚2ã€æŠŠredis.confé…ç½®æ–‡ä»¶çš„bindå±æ€§æ³¨é‡Šæ‰ï¼Œè®©æ‰€æœ‰è¿œç¨‹çš„IPéƒ½å¯ä»¥è®¿é—®åˆ°è¯¥redisçš„æœåŠ¡ã€‚3ã€ç”±äºå¼€å¯äº†è¿œç¨‹è¿æ¥ï¼Œæ‰€ä»¥æœ‰å¿…è¦è®¾ç½®redisçš„è®¿é—®å¯†ç ï¼Œä¸ç„¶çš„è¯å®‰å…¨æ€§å¤ªä½ï¼Œåœ¨redis.confé…ç½®æ–‡ä»¶ä¸­æ¨¡å¼æ˜¯æ²¡æœ‰å¯†ç è¿™è¡Œé…ç½®çš„ï¼Œéœ€è¦æ·»åŠ å¯†ç çš„è¯åˆ™æ–°å¢è¯¥å±æ€§ï¼šrequirepassï¼Œå±æ€§å€¼ä¸ºå¯†ç å­—ç¬¦ä¸²ã€‚4ã€å¼€å¯6379ç½‘ç»œç«¯å£ï¼Œå¹¶é‡æ–°åŠ è½½é˜²ç«å¢™è§„åˆ™ã€‚]]></content>
      <categories>
        <category>æµ‹è¯•æœåŠ¡å™¨æ­å»ºè®°å½•</category>
      </categories>
      <tags>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LocalDateæ“ä½œæ—¶é—´]]></title>
    <url>%2F2019%2F08%2F10%2FLocalDate%E6%93%8D%E4%BD%9C%E6%97%B6%E9%97%B4%2F</url>
    <content type="text"><![CDATA[è®°å½•å·¥å…·ç±»APIğŸ‘‡: å­—ç¬¦ä¸²è½¬LocalDate è·å–è¿ç»­æ—¶é—´é›†åˆ è·å–è¿ç»­æ—¶é—´é›†åˆ12// é»˜è®¤çš„æ—¶é—´æ ¼å¼public static final String DEFUALT_SHOT_TIME_FORMAT = "yyyy-MM-dd";12// é»˜è®¤çš„æ—¶é—´æ ¼å¼public static final String DEFUALT_SHOT_TIME_FORMAT = "yyyy-MM-dd";1. å­—ç¬¦ä¸²è½¬LocalDate123456789/** * * @param time æ—¶é—´yyyy-MM-dd * @return */ public static LocalDateTime stringToLocalDate(String time) &#123; DateTimeFormatter df = DateTimeFormatter.ofPattern("yyyy-MM-dd"); return LocalDateTime.parse(time, df); &#125;2. ä¸¤ä¸ªæ—¶é—´ç›¸å·®å¤šå°‘å¤©123456789101112131415/** * è·å–ä¸¤ä¸ªæ—¶é—´ç›¸å·®å¤šå°‘å¤© * * @param dates * @return */ public static long getDiffDays(String[] dates) &#123; if (dates.length &lt; 2) &#123; return 1; &#125; DateTimeFormatter fmt = DateTimeFormatter.ofPattern("yyyy-MM-dd"); LocalDate begin = LocalDate.parse(dates[0], fmt); LocalDate end = LocalDate.parse(dates[1], fmt); return end.toEpochDay() - begin.toEpochDay() + 1; &#125;3. è·å–è¿ç»­æ—¶é—´é›†åˆ1234567891011121314151617/** * æ•°æ®å¡«å…… * å¯æ“ä½œ: å¤©/å‘¨/æœˆ/å¹´ * @param time é—´éš”å¤©æ•° * @param begin å¼€å§‹æ—¶é—´ * @return */ public static List&lt;String&gt; getRangeIncres2(long time, String begin) &#123; List&lt;String&gt; list = Lists.newArrayList(); DateTimeFormatter fmt = DateTimeFormatter.ofPattern("yyyy-MM-dd"); LocalDate localDate = LocalDate.parse(begin, fmt); for (int i = 0; i &lt; time; i++) &#123; list.add(localDate.plusDays(i).toString()); &#125; return list; &#125;4. è®¡ç®—æ—¶é—´å·®:xxå¤©xxå°æ—¶xxåˆ†é’Ÿ123456789101112131415161718192021/** * è®¡ç®—æ—¶é—´å·®:xxå¤©xxå°æ—¶xxåˆ†é’Ÿ * @param endDate ç»“æŸæ—¶é—´ * @param beginDate å¼€å§‹æ—¶é—´ * @return */ public static List&lt;Long&gt; getDatePoor(Date endDate, Date beginDate) &#123; long nd = 1000 * 24 * 60 * 60;//æ¯å¤©æ¯«ç§’æ•° long nh = 1000 * 60 * 60;//æ¯å°æ—¶æ¯«ç§’æ•° long nm = 1000 * 60;//æ¯åˆ†é’Ÿæ¯«ç§’æ•° long diff = endDate.getTime() - beginDate.getTime(); // è·å¾—ä¸¤ä¸ªæ—¶é—´çš„æ¯«ç§’æ—¶é—´å·®å¼‚ long day = diff / nd; // è®¡ç®—å·®å¤šå°‘å¤© long hour = diff % nd / nh; // è®¡ç®—å·®å¤šå°‘å°æ—¶ long min = diff % nd % nh / nm; // è®¡ç®—å·®å¤šå°‘åˆ†é’Ÿ System.out.println(day + "å¤©" + hour + "å°æ—¶" + min + "åˆ†é’Ÿ"); List&lt;Long&gt; list = new ArrayList&lt;&gt;(); list.add(day); list.add(hour); list.add(min); return list; &#125;]]></content>
      <categories>
        <category>å·¥å…·ç±»æ”¶è—</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticSearch ä¸­boolQueryBuilderçš„ä½¿ç”¨]]></title>
    <url>%2F2019%2F08%2F08%2FElasticSearch-%E4%B8%ADboolQueryBuilder%E7%9A%84%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[BoolæŸ¥è¯¢ç°åœ¨åŒ…æ‹¬å››ç§å­å¥ï¼Œmustï¼Œfilter,should,must_not.è½¬è½½è‡ª:https://blog.csdn.net/metheir/article/details/850803341. ä¸ºä»€ä¹ˆfilterä¼šå¿«ï¼Ÿçœ‹ä¸Šé¢çš„æµç¨‹å›¾å°±èƒ½å¾ˆæ˜æ˜¾çš„çœ‹åˆ°ï¼Œfilterä¸queryè¿˜æ˜¯æœ‰å¾ˆå¤§çš„åŒºåˆ«çš„ã€‚æ¯”å¦‚ï¼Œqueryçš„æ—¶å€™ï¼Œä¼šå…ˆæ¯”è¾ƒæŸ¥è¯¢æ¡ä»¶ï¼Œç„¶åè®¡ç®—åˆ†å€¼ï¼Œæœ€åè¿”å›æ–‡æ¡£ç»“æœï¼›è€Œfilteråˆ™æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦æ»¡è¶³æŸ¥è¯¢æ¡ä»¶ï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œä¼šç¼“å­˜æŸ¥è¯¢è¿‡ç¨‹ï¼ˆè®°å½•è¯¥æ–‡æ¡£ä¸æ»¡è¶³ç»“æœï¼‰ï¼›æ»¡è¶³çš„è¯ï¼Œå°±ç›´æ¥ç¼“å­˜ç»“æœã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œfilterå¿«åœ¨ä¸¤ä¸ªæ–¹é¢ï¼š1 å¯¹ç»“æœè¿›è¡Œç¼“å­˜2 é¿å…è®¡ç®—åˆ†å€¼2. boolæŸ¥è¯¢çš„ä½¿ç”¨BoolæŸ¥è¯¢å¯¹åº”Luceneä¸­çš„BooleanQuery,å®ƒç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­å¥ç»„æˆ,æ¯ä¸ªå­å¥éƒ½æœ‰ç‰¹å®šçš„ç±»å‹mustè¿”å›çš„æ–‡æ¡£å¿…é¡»æ»¡è¶³mustå­å¥çš„æ¡ä»¶,å¹¶ä¸”å‚ä¸è®¡ç®—åˆ†å€¼filterè¿”å›çš„æ–‡æ¡£å¿…é¡»æ»¡è¶³filterå­å¥çš„æ¡ä»¶,ä½†æ˜¯ä¸ä¼šåƒmustä¸€æ ·,å‚ä¸è®¡ç®—åˆ†å€¼shouldè¿”å›çš„æ–‡æ¡£å¯èƒ½æ»¡è¶³shouldå­å¥çš„æ¡ä»¶.åœ¨ä¸€ä¸ªboolæŸ¥è¯¢ä¸­,å¦‚æœæ²¡æœ‰mustæˆ–è€…filter,æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªshouldå­å¥,é‚£ä¹ˆåªè¦æ»¡è¶³ä¸€ä¸ªå°±å¯ä»¥è¿”å›.minimum_should_matchå‚æ•°å®šä¹‰äº†è‡³å°‘æ»¡è¶³å‡ ä¸ªå­å¥.must_notè¿”å›çš„æ–‡æ¡£å¿…é¡»ä¸æ»¡è¶³å®šä¹‰çš„æ¡ä»¶å¦‚æœä¸€ä¸ªæŸ¥è¯¢æ—¢æœ‰filteråˆæœ‰should,é‚£ä¹ˆè‡³å°‘åŒ…å«ä¸€ä¸ªshouldå­å¥.boolæŸ¥è¯¢ä¹Ÿæ”¯æŒç¦ç”¨ååŒè®¡åˆ†é€‰é¡¹disable_coord.ä¸€èˆ¬è®¡ç®—åˆ†å€¼çš„å› ç´ å–å†³äºæ‰€æœ‰çš„æŸ¥è¯¢æ¡ä»¶.boolæŸ¥è¯¢ä¹Ÿæ˜¯é‡‡ç”¨more_matches_is_betterçš„æœºåˆ¶,å› æ­¤æ»¡è¶³mustå’Œshouldå­å¥çš„æ–‡æ¡£å°†ä¼šåˆå¹¶èµ·æ¥è®¡ç®—åˆ†å€¼.3.JavaAPIä½¿ç”¨1234567891011121314151617@Testpublic void searchApi2() throws IOException &#123; SearchRequest searchRequest = new SearchRequest("item"); SearchSourceBuilder sourceBuilder = new SearchSourceBuilder(); BoolQueryBuilder boolQueryBuilder = QueryBuilders.boolQuery(); // å¿…é¡»åŒ¹é…æ¡ä»¶ boolQueryBuilder.must(QueryBuilders.matchQuery("scompCode", "G0000001")); // æ¨¡ç³ŠæŸ¥è¯¢ boolQueryBuilder.filter(QueryBuilders.wildcardQuery("itemDesc", "*æ‰‹æœº*")); // èŒƒå›´æŸ¥è¯¢ from:ç›¸å½“äºé—­åŒºé—´; gt:ç›¸å½“äºå¼€åŒºé—´(&gt;) gte:ç›¸å½“äºé—­åŒºé—´ (&gt;=) lt:å¼€åŒºé—´(&lt;) lte:é—­åŒºé—´ (&lt;=) boolQueryBuilder.filter(QueryBuilders.rangeQuery("itemPrice").from(4500).to(8899)); sourceBuilder.query(boolQueryBuilder); searchRequest.source(sourceBuilder); SearchResponse searchResponse = client.search(searchRequest, RequestOptions.DEFAULT); logger.info("æŸ¥è¯¢æ•°æ®:&#123;&#125;", Arrays.toString(searchResponse.getHits().getHits()));&#125;]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
        <tag>è½¬è½½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticSearch API]]></title>
    <url>%2F2019%2F08%2F07%2FElasticSearch-API%2F</url>
    <content type="text"><![CDATA[ElasticSearch java APIåº”ç”¨https://www.elastic.co/guide/en/elasticsearch/client/java-rest/7.0/java-rest-high-document-index.html1. åˆ›å»ºç´¢å¼•12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061public class ElasticsearchRestClient &#123; private static final Logger logger = LogManager.getLogger(ElasticsearchRestClient.class); @Before public void beforGet() &#123; client = new RestHighLevelClient( RestClient.builder(new HttpHost("106.14.116.156", 9200, "http"))); logger.info("ESå®¢æˆ·ç«¯åˆå§‹åŒ–"); &#125; @After public void afterGet() throws IOException &#123; client.close(); logger.info("å…³é—­ESè¿æ¥"); &#125; /** * åˆ›å»ºç´¢å¼• * * @throws IOException */ @Test public void createIndex() throws IOException &#123; GetIndexRequest getIndexRequest = new GetIndexRequest("item"); // ç´¢å¼•æ˜¯å¦å­˜åœ¨ boolean exists = client.indices().exists(getIndexRequest, RequestOptions.DEFAULT); if (!exists) &#123; CreateIndexRequest request = new CreateIndexRequest("item"); XContentBuilder builder = XContentFactory.jsonBuilder(); builder.startObject(); &#123; // å›ºå®šæ ¼å¼ builder.startObject("properties"); &#123; // itemCodeå­—æ®µ builder.startObject("itemCode"); &#123; // å­—æ®µå±æ€§ builder.field("type", "keyword"); &#125; builder.endObject(); // itemDescå­—æ®µ builder.startObject("itemDesc"); &#123; // å­—æ®µå±æ€§ builder.field("type", "keyword"); &#125; builder.endObject(); &#125; builder.endObject(); &#125; builder.endObject(); request.mapping("doc", builder); CreateIndexResponse createIndexResponse = client.indices().create(request, RequestOptions.DEFAULT); logger.info("åˆ›å»ºç´¢å¼•ç»“æœ:&#123;&#125;", createIndexResponse.isAcknowledged()); &#125; else &#123; logger.info("[employee]ç´¢å¼•å·²ç»å­˜åœ¨"); &#125; &#125;&#125;2.æ–°å¢æ•°æ®12345678910111213141516171819202122/** * æ–°å¢æ•°æ® * * @param client * @param index ç´¢å¼• * @param id æ–‡æ¡£id * @param jsonMap éœ€è¦å»ºç«‹ç´¢å¼•çš„æ•°æ® key:å­—æ®µ,value:å€¼ */ public static void index(RestHighLevelClient client, String index,String id, Map&lt;String, Object&gt; jsonMap) &#123; IndexRequest indexRequest = new IndexRequest(index); // idä¸ºç©ºåˆ™è‡ªåŠ¨ç”Ÿæˆid if (StringUtil.isNotEmpty(id)) &#123; indexRequest.id(id); &#125; indexRequest.source(jsonMap); try &#123; IndexResponse response = client.index(indexRequest, RequestOptions.DEFAULT); logger.info("ç´¢å¼•ç»“æœ:&#123;&#125;", response.status().getStatus()); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;3.åˆ é™¤æ•°æ®12345678910111213141516171819/** * åˆ é™¤æ•°æ® * * @param client * @param index ç´¢å¼•åç§° * @param id æ–‡æ¡£id */ @Test public static void delete(RestHighLevelClient client, String index,String id) &#123; DeleteRequest request = new DeleteRequest(index, id); DeleteResponse deleteResponse = null; try &#123; deleteResponse = client.delete(request, RequestOptions.DEFAULT); &#125; catch (Exception e) &#123; e.printStackTrace(); logger.warn("ESåˆ é™¤å¼‚å¸¸ä¿¡æ¯:&#123;&#125;",e.getMessage()); &#125; logger.warn("åˆ é™¤ç»“æœ:&#123;&#125;",deleteResponse.status().getStatus()); &#125;4.æ›´æ–°æ•°æ®12345678910111213141516171819/** * * @param client * @param index ç´¢å¼•åç§° * @param id æ–‡æ¡£id */ @Test public static void update(RestHighLevelClient client, String index,String id,Map&lt;String,Object&gt; map) &#123; UpdateRequest request = new UpdateRequest(index,id); request.doc(map); UpdateResponse updateResponse = null; try &#123; updateResponse = client.update( request, RequestOptions.DEFAULT); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; logger.warn("ESæ›´æ–°ç»“æœ:&#123;&#125;",updateResponse.getResult()); &#125;]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¿œç¨‹è°ƒè¯•springbooté¡¹ç›®]]></title>
    <url>%2F2019%2F07%2F27%2F%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95springboot%E9%A1%B9%E7%9B%AE%2F</url>
    <content type="text"><![CDATA[IDEAè¿œç¨‹è°ƒè¯•é¡¹ç›®~!1. é…ç½®è¿œç¨‹â‘ â‘¡â‘¢2. å¯åŠ¨é¡¹ç›®1nohup java -jar -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:8888 &lt;jaråŒ…åç§°&gt;3. è¿œç¨‹debugå¼€å§‹4. è¿æ¥æˆåŠŸåœ¨æœ¬åœ°æ‰“æ–­ç‚¹,è®¿é—®æœåŠ¡å™¨æ¥å£æ—¶,åœ¨æœ¬åœ°å³å¯å®æ—¶è°ƒè¯•äº†]]></content>
      <categories>
        <category>å·¥å…·é…ç½®ç›¸å…³</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é˜¿é‡ŒCodeGITè´¦å·å¯†ç è·å–æ–¹æ³•]]></title>
    <url>%2F2019%2F07%2F22%2F%E9%98%BF%E9%87%8CCodeGIT%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81%E8%8E%B7%E5%8F%96%E6%96%B9%E6%B3%95%2F</url>
    <content type="text"><![CDATA[è¾“å…¥https://code.aliyun.com -&gt; è®¾ç½® -&gt; ä¸ªäººè®¾ç½® Username ï¼ˆGITè´¦å·ï¼‰è¾“å…¥https://code.aliyun.com/profile/password/edit -&gt; å¿˜è®°å¯†ç  â€“&gt;åˆ°é‚®ç®±é‡ç½®å¯†ç  ï¼ˆGITå¯†ç ï¼‰è¾“å…¥https://code.aliyun.com -&gt; è®¾ç½® -&gt; ä¸ªäººè®¾ç½® Username ï¼ˆGITè´¦å·ï¼‰è¾“å…¥https://code.aliyun.com/profile/password/edit -&gt; å¿˜è®°å¯†ç  â€“&gt;åˆ°é‚®ç®±é‡ç½®å¯†ç  ï¼ˆGITå¯†ç ï¼‰]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Alibaba Cloud Toolkitæ’ä»¶ä½¿ç”¨]]></title>
    <url>%2F2019%2F07%2F22%2FAlibaba-Cloud-Toolkit%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Alibaba Cloud Toolkit å·¥å…·ä¸€é”®éƒ¨ç½²æœ¬åœ°jaråŒ…1.å®‰è£… Alibaba Cloud Toolkitç›´æ¥åœ¨IDEAæ’ä»¶ä¸­æœç´¢å®‰è£…å³å¯2.æ·»åŠ è¿œç¨‹æœåŠ¡å™¨3. é…ç½®æ‰“åŒ…éƒ¨ç½²é¡¹ç›®]]></content>
      <categories>
        <category>æ’ä»¶ä½¿ç”¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>æ’ä»¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ—¶é—´è½¬cronè¡¨è¾¾å¼]]></title>
    <url>%2F2019%2F07%2F15%2F%E6%97%B6%E9%97%B4%E8%BD%ACcron%E8%A1%A8%E8%BE%BE%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸ªæ—¶é—´è½¬cronè¡¨è¾¾å¼çš„å·¥å…·ç±»DateToCronUtil12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697/** * @author LuGuoZheng * @date 2019/7/12 13:45 * @Version 3.0 * @description */public class DateToCronUtil &#123; private static final Logger logger = LoggerFactory.getLogger(DateToCronUtil.class); public static final String DEFUALT_LONG_TIME_FORMAT = "yyyy-MM-dd HH:mm:ss"; private final static String H = "H"; private final static String D = "D"; private final static String W = "W"; private final static String M = "M"; private final static String Q = "Q"; private final static String Y = "Y"; /** * æ¯å°æ—¶ */ private final static String DEFAULT_H_CRON = "0 H * * * ? *"; /** * æ¯å¤© */ private final static String DEFAULT_D_CRON = "0 H D * * ? *"; /** * æ¯å‘¨ */ private final static String DEFAULT_W_CRON = "0 H D ? * W"; /** * æ¯æœˆ */ private final static String DEFAULT_M_CRON = "0 H D M * ? *"; /** * æ¯å­£åº¦ */ private final static String DEFAULT_Q_CRON = "0 H D M 1/3 ? *"; /** * æ¯å¹´ */ private final static String DEFAULT_Y_CRON = "0 H D M Y ? *"; public static LocalDateTime stringToLocalDate(String time) &#123; DateTimeFormatter df = DateTimeFormatter.ofPattern(DEFUALT_LONG_TIME_FORMAT); return LocalDateTime.parse(time, df); &#125; /** * @param time æ—¶é—´ yyyy-MM-dd HH:mm * @param timeType ç±»å‹:H-&gt;å°æ—¶,D-&gt;å¤©,W-&gt;å‘¨,M-&gt;æœˆ,Q-&gt;å­£åº¦,Y-&gt;æ¯å¹´ * @return */ public static String getCron(String time, String timeType) &#123; LocalDateTime localDateTime = stringToLocalDate(time); logger.info("localDateTime:&#123;&#125;", localDateTime); if (DateToCronUtil.H.equals(timeType)) &#123; return DEFAULT_H_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + ""); &#125; else if (DateToCronUtil.D.equals(timeType)) &#123; return DEFAULT_D_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.HOUR_OF_DAY) + ""); &#125; else if (DateToCronUtil.W.equals(timeType)) &#123; return DEFAULT_W_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.HOUR_OF_DAY) + "") .replace(DateToCronUtil.W, (localDateTime.get(ChronoField.DAY_OF_WEEK) == 7 ? 1 : localDateTime.get(ChronoField.DAY_OF_WEEK) + 1) + ""); &#125; else if (DateToCronUtil.M.equals(timeType)) &#123; return DEFAULT_M_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.HOUR_OF_DAY) + "") .replace(DateToCronUtil.M, localDateTime.get(ChronoField.MONTH_OF_YEAR) + ""); &#125; else if (DateToCronUtil.Q.equals(timeType)) &#123; return DEFAULT_Q_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.HOUR_OF_DAY) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.DAY_OF_MONTH) + ""); &#125; else if (DateToCronUtil.Y.equals(timeType)) &#123; return DEFAULT_Y_CRON.replace(DateToCronUtil.H, localDateTime.get(ChronoField.MINUTE_OF_HOUR) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.HOUR_OF_DAY) + "") .replace(DateToCronUtil.D, localDateTime.get(ChronoField.DAY_OF_MONTH) + "") .replace(DateToCronUtil.Y, localDateTime.get(ChronoField.MONTH_OF_YEAR) + ""); &#125; return DEFAULT_D_CRON; &#125; @Test public void get() &#123;// DateTimeFormatter df = DateTimeFormatter.ofPattern(DEFUALT_LONG_TIME_FORMAT);// LocalDateTime now = LocalDateTime.parse("2019-07-11 14:22",df);// System.out.println(now);// System.out.println(now.get(ChronoField.MINUTE_OF_HOUR)); String d = getCron("2019-07-16 14:25:12", "W"); System.out.println(d); &#125;&#125;]]></content>
      <categories>
        <category>å·¥å…·ç±»æ”¶è—</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticSearch 9200ç«¯å£ä¸9300ç«¯å£çš„åŒºåˆ«]]></title>
    <url>%2F2019%2F07%2F06%2FElasticSearch-JAVA%E5%AE%A2%E6%88%B7%E7%AB%AF-%E7%AB%AF%E5%8F%A3%2F</url>
    <content type="text"><![CDATA[ESå¯åŠ¨ç›‘å¬ä¸¤ä¸ªç«¯å£:9300å’Œ92009300ç«¯å£9300æ˜¯Tcpåè®®ç«¯å£:é€šè¿‡Tcpåè®®é€šè®¯,ESé›†ç¾¤ä¹‹é—´æ˜¯é€šè¿‡9300è¿›è¡Œé€šè®¯,javaå®¢æˆ·ç«¯(TransportClient)çš„æ–¹å¼ä¹Ÿæ˜¯ä»¥Tcpåè®®åœ¨9300ç«¯å£ä¸Šä¸é›†ç¾¤è¿›è¡Œé€šè®¯.9200ç«¯å£9200æ˜¯Httpåè®®ç«¯å£:ä¸»è¦ç”¨äºå¤–éƒ¨é€šè®¯,å¤–éƒ¨ä½¿ç”¨RESTfulæ¥å£è¿›è¡Œè®¿é—®.ESå¯åŠ¨ç›‘å¬ä¸¤ä¸ªç«¯å£:9300å’Œ92009300ç«¯å£9300æ˜¯Tcpåè®®ç«¯å£:é€šè¿‡Tcpåè®®é€šè®¯,ESé›†ç¾¤ä¹‹é—´æ˜¯é€šè¿‡9300è¿›è¡Œé€šè®¯,javaå®¢æˆ·ç«¯(TransportClient)çš„æ–¹å¼ä¹Ÿæ˜¯ä»¥Tcpåè®®åœ¨9300ç«¯å£ä¸Šä¸é›†ç¾¤è¿›è¡Œé€šè®¯.9200ç«¯å£9200æ˜¯Httpåè®®ç«¯å£:ä¸»è¦ç”¨äºå¤–éƒ¨é€šè®¯,å¤–éƒ¨ä½¿ç”¨RESTfulæ¥å£è¿›è¡Œè®¿é—®.]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker ç®€å•éƒ¨ç½² ElasticSearch]]></title>
    <url>%2F2019%2F07%2F02%2FDocker-%E7%AE%80%E5%8D%95%E9%83%A8%E7%BD%B2-ElasticSearch%2F</url>
    <content type="text"><![CDATA[ElasticSearchå®˜ç½‘APIä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ?Elasticsearchä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨Luceneä½œä¸ºå…¶æ ¸å¿ƒæ¥å®ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„RESTful APIæ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—ç®€å•ã€‚ä¸è¿‡ï¼ŒElasticsearchä¸ä»…ä»…æ˜¯Luceneå’Œå…¨æ–‡æœç´¢ï¼Œæˆ‘ä»¬è¿˜èƒ½è¿™æ ·å»æè¿°å®ƒï¼šåˆ†å¸ƒå¼çš„å®æ—¶æ–‡ä»¶å­˜å‚¨ï¼Œæ¯ä¸ªå­—æ®µéƒ½è¢«ç´¢å¼•å¹¶å¯è¢«æœç´¢åˆ†å¸ƒå¼çš„å®æ—¶åˆ†ææœç´¢å¼•æ“å¯ä»¥æ‰©å±•åˆ°ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå¤„ç†PBçº§ç»“æ„åŒ–æˆ–éç»“æ„åŒ–æ•°æ®ElasticSearchå®˜ç½‘APIä¸€ã€ElasticSearchæ˜¯ä»€ä¹ˆ?Elasticsearchä¹Ÿä½¿ç”¨Javaå¼€å‘å¹¶ä½¿ç”¨Luceneä½œä¸ºå…¶æ ¸å¿ƒæ¥å®ç°æ‰€æœ‰ç´¢å¼•å’Œæœç´¢çš„åŠŸèƒ½ï¼Œä½†æ˜¯å®ƒçš„ç›®çš„æ˜¯é€šè¿‡ç®€å•çš„RESTful APIæ¥éšè—Luceneçš„å¤æ‚æ€§ï¼Œä»è€Œè®©å…¨æ–‡æœç´¢å˜å¾—ç®€å•ã€‚ä¸è¿‡ï¼ŒElasticsearchä¸ä»…ä»…æ˜¯Luceneå’Œå…¨æ–‡æœç´¢ï¼Œæˆ‘ä»¬è¿˜èƒ½è¿™æ ·å»æè¿°å®ƒï¼šåˆ†å¸ƒå¼çš„å®æ—¶æ–‡ä»¶å­˜å‚¨ï¼Œæ¯ä¸ªå­—æ®µéƒ½è¢«ç´¢å¼•å¹¶å¯è¢«æœç´¢åˆ†å¸ƒå¼çš„å®æ—¶åˆ†ææœç´¢å¼•æ“å¯ä»¥æ‰©å±•åˆ°ä¸Šç™¾å°æœåŠ¡å™¨ï¼Œå¤„ç†PBçº§ç»“æ„åŒ–æˆ–éç»“æ„åŒ–æ•°æ®äºŒã€Docker éƒ¨ç½² ElasticSearch2.1 æ‹‰å–é•œåƒ1docker pull docker.elastic.co/elasticsearch/elasticsearch:7.0.02.2 è¿è¡Œå®¹å™¨ElasticSearchçš„é»˜è®¤ç«¯å£æ˜¯9200ï¼Œæˆ‘ä»¬æŠŠå®¿ä¸»ç¯å¢ƒ9200ç«¯å£æ˜ å°„åˆ°Dockerå®¹å™¨ä¸­çš„9200ç«¯å£ï¼Œå°±å¯ä»¥è®¿é—®åˆ°Dockerå®¹å™¨ä¸­çš„ElasticSearchæœåŠ¡äº†ï¼ŒåŒæ—¶æˆ‘ä»¬æŠŠè¿™ä¸ªå®¹å™¨å‘½åä¸ºesã€‚1docker run -d --name es -p 9200:9200 -p 9300:9300 -e &quot;discovery.type=single-node&quot; &lt;å®¹å™¨ID&gt;2.3 é…ç½®è·¨åŸŸ2.3.1 è¿›å…¥å®¹å™¨ç”±äºè¦è¿›è¡Œé…ç½®ï¼Œå› æ­¤éœ€è¦è¿›å…¥å®¹å™¨å½“ä¸­ä¿®æ”¹ç›¸åº”çš„é…ç½®ä¿¡æ¯ã€‚1docker exec -it es /bin/bash2.3.2 è¿›è¡Œé…ç½®123456789101112131415161718192021# æ˜¾ç¤ºæ–‡ä»¶lsç»“æœå¦‚ä¸‹ï¼šLICENSE.txt README.textile config lib modulesNOTICE.txt bin data logs plugins# è¿›å…¥é…ç½®æ–‡ä»¶å¤¹cd config# æ˜¾ç¤ºæ–‡ä»¶lsç»“æœå¦‚ä¸‹ï¼šelasticsearch.keystore ingest-geoip log4j2.properties roles.yml users_roleselasticsearch.yml jvm.options role_mapping.yml users# ä¿®æ”¹é…ç½®æ–‡ä»¶vi elasticsearch.yml# åŠ å…¥è·¨åŸŸé…ç½®http.cors.enabled: truehttp.cors.allow-origin: &quot;*&quot;2.3 é‡å¯å®¹å™¨ç”±äºä¿®æ”¹äº†é…ç½®ï¼Œå› æ­¤éœ€è¦é‡å¯ElasticSearchå®¹å™¨ã€‚1docker restart eså±•ç¤ºå¦‚ä¸‹ï¼šä¸‰ã€Docker éƒ¨ç½² ElasticSearch-Headä¸ºä»€ä¹ˆè¦å®‰è£…ElasticSearch-Headå‘¢ï¼ŒåŸå› æ˜¯éœ€è¦æœ‰ä¸€ä¸ªç®¡ç†ç•Œé¢è¿›è¡ŒæŸ¥çœ‹ElasticSearchç›¸å…³ä¿¡æ¯3.1 æ‹‰å–é•œåƒ1docker pull mobz/elasticsearch-head:53.2 è¿è¡Œå®¹å™¨1docker run -d --name es_admin -p 9100:9100 mobz/elasticsearch-head:5å±•ç¤ºå¦‚ä¸‹ï¼šè¿™æ ·ï¼Œæˆ‘ä»¬å°±å®Œæˆäº†ç”¨Dockeræä¾›ElasticsearchæœåŠ¡ï¼Œè€Œä¸æ±¡æŸ“å®¿ä¸»æœºç¯å¢ƒäº†ï¼Œè¿™æ ·è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå¦‚æœæƒ³åŒæ—¶å¯åŠ¨å¤šä¸ªä¸åŒç‰ˆæœ¬çš„Elastcsearchæˆ–è€…å…¶ä»–æœåŠ¡ï¼ŒDockerä¹Ÿæ˜¯ä¸€ä¸ªç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚åŸæ–‡å‡ºå¤„:https://www.cnblogs.com/jianxuanbing/p/9410800.html]]></content>
      <categories>
        <category>ElasticSearchç³»åˆ—</category>
      </categories>
      <tags>
        <tag>ElasticSearch</tag>
        <tag>è½¬è½½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dubboéšå¼å‚æ•°ä¸¢å¤±é—®é¢˜]]></title>
    <url>%2F2019%2F06%2F29%2Fdubbo%E9%9A%90%E5%BC%8F%E5%8F%82%E6%95%B0%E4%B8%A2%E5%A4%B1%E9%97%AE%E9%A2%98%2F</url>
    <content type="text"><![CDATA[è®°å½•åœ¨æ¶ˆè´¹ç«¯è¿ç»­è°ƒç”¨ä¸¤æ¬¡è¿œç¨‹æœåŠ¡å¯¼è‡´éšå¼å‚æ•°ä¸¢å¤±é—®é¢˜~!æ¼”ç¤ºä»£ç controllerå±‚12345678910111213141516@Controller@RequestMapping("/test")public class TestController &#123; @Reference private ICarService iCarService; @RequestMapping("/test") @ResponseBody public String test()&#123; // ä¼ é€’å‚æ•° RpcContext.getContext().setAttachment("TOKEN","æµ‹è¯•éšå£«å‚æ•°ä¼ é€’"); iCarService.test(); return "å‚æ•°"; &#125;&#125;æœåŠ¡å±‚123456789101112131415161718192021@Service(retries = -1)public class CeshiServiceImpl implements ICeshiService &#123; private static final Logger logger = LoggerFactory.getLogger(CeshiServiceImpl.class); @Reference private ICarService iCarService; @Reference private IUserInfoService iUserInfoService; @Override public void test() &#123; String token = RpcContext.getContext().getAttachment("TOKEN"); logger.info("tokenä¿¡æ¯:&#123;&#125;", token); // ç¬¬ä¸€æ¬¡è°ƒç”¨rpcæœåŠ¡ iCarService.test(); logger.info("tokenä¿¡æ¯:&#123;&#125;", RpcContext.getContext().getAttachment("TOKEN")); // ç¬¬äºŒæ¬¡è°ƒç”¨rpcæœåŠ¡ iUserInfoService.test(); &#125;&#125;ICarServiceImpl12345678910@Service(retries = -1)public class CarServiceImpl implements ICarService &#123; private static final Logger logger = LoggerFactory.getLogger(CarServiceImpl.class); public void test() &#123; String token = RpcContext.getContext().getAttachment("TOKEN"); logger.info("carService:&#123;&#125;",token); &#125;&#125;userInfoServiceImpl1234567891011@Service(retries = -1)@Transactionalpublic class UserInfoServiceImpl implements IUserInfoService &#123; private static final Logger logger = LoggerFactory.getLogger(UserInfoServiceImpl.class); public void test() &#123; String token = RpcContext.getContext().getAttachment("TOKEN"); logger.info("userInfoService:&#123;&#125;",token); &#125; &#125;æ‰“å°ç»“æœceshiServiceç»“æœICarServiceImplç»“æœuserInfoServiceImplç»“æœæºç 12345678910111213141516171819202122@Activate(group = Constants.CONSUMER, order = -10000)public class ConsumerContextFilter implements Filter &#123; public Result invoke(Invoker&lt;?&gt; invoker, Invocation invocation) throws RpcException &#123; RpcContext.getContext() .setInvoker(invoker) .setInvocation(invocation) .setLocalAddress(NetUtils.getLocalHost(), 0) .setRemoteAddress(invoker.getUrl().getHost(), invoker.getUrl().getPort()); if (invocation instanceof RpcInvocation) &#123; ((RpcInvocation) invocation).setInvoker(invoker); &#125; try &#123; return invoker.invoke(invocation); &#125; finally &#123; // æ¸…ç©ºéšå¼å‚æ•° RpcContext.getContext().clearAttachments(); &#125; &#125;&#125;æ¶ˆè´¹ç«¯åœ¨æ‰§è¡ŒRpcè°ƒç”¨ä¹‹å‰ï¼Œç»è¿‡Filterå¤„ç†, ä¼šå°†ä¿¡æ¯å†™å…¥RpcContex,è€Œä¸”åœ¨æ¯æ¬¡è°ƒç”¨rpcåéƒ½ä¼šæŠŠéšå¼å‚æ•°æ¸…ç©º,æ‰€ä»¥åœ¨ç¬¬äºŒæ¬¡è°ƒç”¨rpcå°±æ— æ³•æ‹¿åˆ°ä¹‹å‰çš„éšå¼å‚æ•°äº†æ‹“å±•Filterä½•æ—¶è¿›è¡Œurlè¿‡æ»¤filterï¼ˆè¿‡æ»¤å™¨ï¼‰ä½œç”¨äºåœ¨intreceptor(æ‹¦æˆªå™¨)ä¹‹å‰ï¼Œä¸åƒintreceptorä¸€æ ·ä¾èµ–äºspringmvcæ¡†æ¶ï¼Œåªéœ€è¦ä¾èµ–äºserverletã€‚]]></content>
      <categories>
        <category>Dubboç³»åˆ—</category>
      </categories>
      <tags>
        <tag>dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dockeråŸºæœ¬å‘½ä»¤ä½¿ç”¨]]></title>
    <url>%2F2019%2F06%2F24%2Fdocker%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[è®°å½•dockerå¸¸ç”¨å‘½ä»¤1. æŸ¥çœ‹æœ¬åœ°é•œåƒåˆ—è¡¨1docker images2. æŸ¥çœ‹è¿è¡Œä¸­çš„å®¹å™¨1docker ps3. æŸ¥çœ‹æ‰€æœ‰å®¹å™¨(åŒ…æ‹¬æœªè¿è¡Œçš„)1docker ps -a4. åˆ é™¤é•œåƒ1docker rmi &lt;é•œåƒID&gt;5. runå‘½ä»¤docker run [å‚æ•°] [é•œåƒid] | [é•œåƒå]:[é•œåƒæ ‡ç­¾] [å‘½ä»¤]-i è¡¨ç¤ºå®¹å™¨çš„è¾“å…¥ç»ˆç«¯ä¿æŒæ‰“å¼€,ä¸ç›´æ¥å…³é—­-t è¡¨ç¤ºå¼€å¯ä¸€ä¸ªè™šæ‹Ÿç»ˆç«¯, ç»‘å®šåˆ°æ ‡å‡†è¾“å…¥ä¸Š-d è¡¨ç¤ºè®©è¯¥å®¹å™¨åœ¨åå°è¿è¡Œâ€“name ç»™è¯¥å®¹å™¨èµ·ä¸€ä¸ªå®¹å™¨åï¼Œå¦‚æœæ²¡æœ‰æ­¤å‚æ•°ï¼Œåˆ™æœ‰ä¸€ä¸ªé»˜è®¤çš„å®¹å™¨åâ€“rm åœæ­¢è¯¥å®¹å™¨æ—¶ï¼ŒæŠŠå®¹å™¨åˆ é™¤æ‰6. ä½¿ç”¨é•œåƒè¿è¡Œå®¹å™¨1docker run -it --name &lt;å®¹å™¨åç§°&gt; -d -p &lt;port:port&gt; &lt;é•œåƒID&gt;7. å¯åŠ¨å®¹å™¨1docker start &lt;å®¹å™¨ID&gt;8. åœæ­¢å®¹å™¨1docker stop &lt;å®¹å™¨ID&gt;9. åˆ é™¤å®¹å™¨1docker rm &lt;å®¹å™¨ID&gt;10. æŸ¥çœ‹dockerçš„æ‰€æœ‰å®¹å™¨è¿è¡ŒçŠ¶æ€1docker stats11. è¿›å…¥å®¹å™¨é‡Œé¢1docker exec -it &lt;å®¹å™¨ID&gt; /bin/bash12. æŸ¥çœ‹å®¹å™¨è¿è¡Œæ—¥å¿—(ç±»ä¼¼ tail -f å‘½ä»¤)1docker logs -f &lt;å®¹å™¨ID/åç§°&gt;13. æ„å»ºé•œåƒè¿›å…¥å­˜æ”¾dockerfileç›®å½•,æ‰§è¡Œæ„å»ºå‘½ä»¤1docker build -t [é•œåƒå]:[é•œåƒæ ‡ç­¾] [å­˜æ”¾dockerfileçš„ç›®å½•]]]></content>
      <categories>
        <category>dockerå®¹å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ JConsole ç›‘æ§ springboot é¡¹ç›®]]></title>
    <url>%2F2019%2F06%2F24%2F%E4%BD%BF%E7%94%A8-JConsole-%E7%9B%91%E6%8E%A7-springboot-%E9%A1%B9%E7%9B%AE%2F</url>
    <content type="text"><![CDATA[JConsole ä½¿ç”¨è®°å½•~!æ·»åŠ å¯åŠ¨å‚æ•°1234567nohup java -jar -Djava.rmi.server.hostname=x.x.x.x # æœåŠ¡ip-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.port=1099 # ç«¯å£(ä¸èƒ½ä¸æœåŠ¡ç«¯å£å†²çª)-Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Xms200m -Xmx200m ylcloud-item-service-0.0.1-SNAPSHOT.jar &gt; /pro/test/home/yanfa/nohup_item.out &amp; 2&gt;&amp;1 &amp;å¯åŠ¨JConsoleç›´æ¥åœ¨windowså‘½ä»¤çª—å£è¾“å…¥JConsoleé€‰æ‹©è¿œç¨‹è¿›ç¨‹è¾“å…¥å¯¹åº”çš„ip:portå³å¯]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dubboé‡è¯•æœºåˆ¶]]></title>
    <url>%2F2019%2F06%2F15%2FDubbo%E9%87%8D%E8%AF%95%E6%9C%BA%E5%88%B6%2F</url>
    <content type="text"><![CDATA[DUBBOä¸­æ–‡å®˜æ–¹æ–‡æ¡£è®°å½•Dubboé‡è¯•æœºåˆ¶é…ç½®~!DUBBOä¸­æ–‡å®˜æ–¹æ–‡æ¡£é»˜è®¤é‡è¯•æ¬¡æ•°: 2åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æœ‰ä»‹ç»åˆ°dubboçš„é‡è¯•æ¬¡æ•°é»˜è®¤æ˜¯2å±æ€§å¯¹åº”URLå‚æ•°ç±»å‹æ˜¯å¦å¿…å¡«ç¼ºçœå€¼ä½œç”¨æè¿°å…¼å®¹æ€§retriesretriesintå¯é€‰2æ€§èƒ½è°ƒä¼˜è¿œç¨‹æœåŠ¡è°ƒç”¨é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼Œä¸éœ€è¦é‡è¯•è¯·è®¾ä¸º02.0.0ä»¥ä¸Šç‰ˆæœ¬ä¿®æ”¹é‡è¯•æ¬¡æ•°duboo-provider.xmlé…ç½®æ–¹å¼: åœ¨dubbo:serviceé…ç½®retrieså‚æ•°123&lt;!--å¸¸ç”¨èœå•æ¨è--&gt;&lt;dubbo:service ref="userMenuClickFacade" interface="com.ylcloud.user.facade.UserMenuClickFacade" retries="1"/&gt;&lt;bean id="userMenuClickFacade" class="com.ylcloud.user.facade.impl.UserMenuClickFacadeImpl"/&gt;ä½¿ç”¨æ³¨è§£å¦‚æœä½¿ç”¨çš„@Serviceé…ç½®é‡è¯•æ¬¡æ•°,ä¸è®¾ç½®retrieså‚æ•°,é‚£ä¹ˆè¯¥å‚æ•°é»˜è®¤å€¼æ˜¯0,ä½†æ˜¯ä¸ç®¡æ˜¾ç¤ºé…ç½®retriesä¸º0,è¿˜æ˜¯ä¸æ˜¾ç¤ºè®¾ç½®,0éƒ½æ˜¯ä½¿ç”¨dubboé»˜è®¤çš„é‡è¯•æ¬¡æ•°å¦‚æœè¦é…ç½®é‡è¯•æ¬¡æ•°ä¸º0,åªæœ‰æŠŠretrieså°äº0æ‰ä¼šèµ·ä½œç”¨å¦‚æœä½¿ç”¨@Referenceå¼•ç”¨æœåŠ¡æ—¶é…ç½®äº†retries,é‡è¯•æ¬¡æ•°ä»¥æ”¹æ¬¡æ•°ä¸ºå‡†åªæœ‰æ˜¾ç¤ºè®¾ç½®retrieså¤§äºæˆ–ç­‰äº1æ‰ä¼šèµ·ä½œç”¨dubboç›¸å…³ä»£ç (dubboç‰ˆæœ¬:2.6.1)package com.alibaba.dubbo.rpc.cluster.support.FailoverClusterInvoker;1234567891011public Result doInvoke(Invocation invocation, final List&lt;Invoker&lt;T&gt;&gt; invokers, LoadBalance loadbalance) throws RpcException &#123; List&lt;Invoker&lt;T&gt;&gt; copyinvokers = invokers; checkInvokers(copyinvokers, invocation); // len:æœ€å¤šè°ƒç”¨æ¬¡æ•°--&gt; é‡è¯•æ¬¡æ•° + 1 int len = getUrl().getMethodParameter(invocation.getMethodName(), Constants.RETRIES_KEY, Constants.DEFAULT_RETRIES) + 1; // æ§åˆ¶è‡³å°‘è°ƒç”¨ä¸€æ¬¡:å³é‡è¯•æ¬¡æ•°ä¸º 0 if (len &lt;= 0) &#123; len = 1; &#125; /** éƒ¨åˆ†æºç çœç•¥**/&#125;dubboæ³¨å†ŒæœåŠ¡ç›¸å…³ä»£ç package com.alibaba.dubbo.config.AbstractConfig;123456789101112131415protected void appendAnnotation(Class&lt;?&gt; annotationClass, Object annotation) &#123; /** çœç•¥éƒ¨åˆ†ä»£ç  **/ // è·å–ç›´æ¥é…ç½®çš„æ•°æ® Object value = method.invoke(annotation, new Object[0]); // å¦‚æœä¸ä¸ºç©ºå¹¶ä¸”ä¸ç­‰äºé»˜è®¤å€¼,åˆ™æ³¨å†Œurlä¸­ if (value != null &amp;&amp; !value.equals(method.getDefaultValue())) &#123; /** çœç•¥éƒ¨åˆ†ä»£ç  **/ &#125; /** çœç•¥éƒ¨åˆ†ä»£ç  **/ &#125;æ‰€ä»¥å¦‚æœä½¿ç”¨æ³¨è§£é…ç½®é‡è¯•æ¬¡æ•°,å¦‚æœé…ç½®çš„æ˜¯é»˜è®¤å€¼,åˆ™ä¸ä¼šæ³¨å†Œåˆ°urlä¸­,ä¼šä½¿ç”¨dubboé»˜è®¤çš„å€¼]]></content>
      <categories>
        <category>Dubboç³»åˆ—</category>
      </categories>
      <tags>
        <tag>dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx+ffmpegæ­å»ºæ¨æµæœåŠ¡å™¨]]></title>
    <url>%2F2019%2F06%2F14%2FNginx-ffmpeg%E6%90%AD%E5%BB%BA%E6%8E%A8%E6%B5%81%E6%9C%8D%E5%8A%A1%E5%99%A8%2F</url>
    <content type="text"><![CDATA[ç¯å¢ƒğŸ‘‡:CentOS7æ­å»ºæ¨æµæœåŠ¡å™¨~!å®‰è£…Nginx(å¿½ç•¥)ç•¥ç›´æ¥è¿›å…¥åˆ°Nginxçš„è§£å‹ç›®å½•// å‚è€ƒ:è¿™æ˜¯æˆ‘ç›®å½•1cd /usr/local/softs/nginx-1.10.1ç›®å½•ä¸‹é¢çš„å†…å®¹:ä¸‹è½½nginx-rtmp-module,å¹¶è§£å‹123wget https://github.com/arut/nginx-rtmp-module/archive/master.zipunzip master.zipå…ˆå¤‡ä»½Nginx(ç¨³ç‚¹æ¥)1cp objs/nginx /usr/local/nginx/sbin/nginxé‡æ–°é…ç½®Nginx123./configure --with-http_ssl_module --add-module=/usr/local/softs/nginx-1.10.1/nginx-rtmp-module-mastermakePS: ç”¨make,ä¸è¦ä½¿ç”¨make install,ä¸ç„¶ä¼šè¦†ç›–å·²ç»æ·»åŠ çš„æ¨¡å—(ç½‘ä¸Šæ˜¯è¿™ä¹ˆè¯´çš„,ä½†æ˜¯å¥½åƒæ²¡æœ‰æ•ˆæœ,æˆ‘ä¹‹å‰è£…äº†sslæ¨¡å—çš„,ç›´æ¥å°±ç»™æˆ‘è¦†ç›–æ‰äº†)å› ä¸ºæˆ‘ä¹‹å‰å°±åŠ äº†ä¸ªsslæ¨¡å—,æ‰€æœ‰æˆ‘ç›´æ¥åœ¨é…ç½®ä¸ŠåŠ ä¸Šäº†,ä¸è¿‡ä¹‹å‰ä¹Ÿæœ‰å¤‡ä»½å°†æ–°çš„nginxè¦†ç›–æ—§å®‰è£…ç›®å½•1cp objs/nginx /usr/local/nginx/sbin/nginxä¿®æ”¹Nginxé…ç½®æ–‡ä»¶(nginx.conf)123456789101112rtmp &#123; #RTMPæœåŠ¡ server &#123; listen 1935; #//æœåŠ¡ç«¯å£ chunk_size 4096; #//æ•°æ®ä¼ è¾“å—çš„å¤§å° application vod &#123; play /opt/video; #//è§†é¢‘æ–‡ä»¶å­˜æ”¾ä½ç½®ã€‚ &#125; application live&#123; #ç›´æ’­ live on; &#125; &#125;&#125;PS: rtmpæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ¨¡å—,ä¸è¦æ”¾åœ¨httpé‡Œé¢é‡å¯Nginx123cd /usr/local/nginx/sbin./nginx -s reloadå®‰è£…EPEL Releaseï¼Œå› ä¸ºå®‰è£…éœ€è¦ä½¿ç”¨å…¶ä»–çš„repoæºï¼Œæ‰€ä»¥éœ€è¦EPELæ”¯æŒ1yum install -y epel-releaseå®‰è£…å®Œæˆä¹‹åï¼Œå¯ä»¥æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ1yum repolistå®‰è£…nux-dextop æº1rpm -Uvh http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpmå®‰è£…ffmpeg1yum install -y ffmpegå®‰è£…å®Œæˆåæ£€æŸ¥ffmpeg ç‰ˆæœ¬1ffmpeg -versionæµ‹è¯•1ffmpeg -re -i lgz.mp4 -c copy -f flv rtmp://localhost:1935/live/filmä½¿ç”¨VLC1rtmp://&#123;ä½ çš„æœåŠ¡IP&#125;:1935/live/film]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
        <tag>æ¨æµæœåŠ¡å™¨</tag>
        <tag>ffmpeg</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç»“æŸWindowså ç”¨ç«¯å£è¿›ç¨‹]]></title>
    <url>%2F2019%2F06%2F12%2F%E7%BB%93%E6%9D%9FWindows%E5%8D%A0%E7%94%A8%E7%AB%AF%E5%8F%A3%E8%BF%9B%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[netstat -ano | findstr 80 //åˆ—å‡ºè¿›ç¨‹æå…¶å ç”¨çš„ç«¯å£ï¼Œä¸”åŒ…å« 80tasklist | findstr 9268taskkill -PID &lt;è¿›ç¨‹å·&gt; -F //å¼ºåˆ¶å…³é—­æŸä¸ªè¿›ç¨‹netstat -ano | findstr 80 //åˆ—å‡ºè¿›ç¨‹æå…¶å ç”¨çš„ç«¯å£ï¼Œä¸”åŒ…å« 80tasklist | findstr 9268taskkill -PID &lt;è¿›ç¨‹å·&gt; -F //å¼ºåˆ¶å…³é—­æŸä¸ªè¿›ç¨‹]]></content>
      <tags>
        <tag>Windows</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SQLå‡½æ•°ä½¿ç”¨è®°å½•]]></title>
    <url>%2F2019%2F06%2F06%2FQL%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95%2F</url>
    <content type="text"><![CDATA[sqlå‡½æ•°ä½¿ç”¨è®°å½•~!SUMå‡½æ•°ä¸­ä½¿ç”¨caseç»Ÿè®¡t1.groupNumberå¤§äº2çš„æ•°é‡12345678SELECT IF(SUM(case when t1.groupNumber &gt; 2 then 1 else 0 end) / COUNT(t1.groupNumber),SUM(case when t1.groupNumber &gt; 2 then 1 else 0 end) / COUNT(t1.groupNumber),0) AS fgl FROM (SELECT COUNT(visitor_code) groupNumber FROM sales_order WHERE scomp_code = 'G0000001' GROUP BY visitor_code) t1;æ ¼å¼åŒ–æ—¥æœŸåˆ†ç»„æŸ¥è¯¢å‡½æ•°æè¿°DATE_FORMAT(creater_time,â€™%Y-%mâ€™)è®¢è´§æ—¥æœŸ(æ—¥)DATE_FORMAT(creater_time,â€™%Y-%m-%dâ€™)è®¢è´§æ—¥æœŸ(æœˆ)1SELECT COUNT(1),DATE_FORMAT(creater_time,'%Y-%m-%d') FROM patrolshop_plan GROUP BY DATE_FORMAT(creater_time,'%Y-%m-%d')æ—¥æ•ˆæœ:æœˆæ•ˆæœ:]]></content>
      <categories>
        <category>MySQLæ•°æ®åº“ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>SQLå‡½æ•°</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[xmlæ–‡ä»¶æ³¨é‡Šæ³¨æ„äº‹é¡¹]]></title>
    <url>%2F2019%2F06%2F06%2Fxml%E6%96%87%E4%BB%B6%E6%B3%A8%E9%87%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸ªè°ƒè¯•ä¸­å¶ç„¶ç¢°åˆ°çš„é—®é¢˜~!åœ¨mapper.xmlæ–‡ä»¶ä¸­æ³¨é‡Šè¯­å¥å¿…é¡»ä½¿ç”¨&lt;!-- --&gt;åœ¨ä¸€æ¬¡è°ƒè¯•ä¸­ç›´æ¥åœ¨mapper.xmlé¡ºæ‰‹ä½¿ç”¨CTRL + /äº†å¿«æ·é”®æ³¨é‡Š:#ç¬¦å·ç„¶è€Œé‚£ä¸€è¡Œä»£ç ä¹Ÿæ˜¯å˜ç°äº†ä¹Ÿå°±æ²¡ç•™æ„åœ¨è®¿é—®çš„æ—¶å€™ç›´æ¥æŠ¥é”™äº†ä¹‹åæ¢æˆ&lt;!-- --&gt;å³å¯]]></content>
      <categories>
        <category>BUGç³»åˆ—</category>
      </categories>
      <tags>
        <tag>Mybatis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Sourcetree æ›´æ–°gitè´¦å·å¯†ç ]]></title>
    <url>%2F2019%2F05%2F31%2Fsourectree%E4%BD%BF%E7%94%A8%2F</url>
    <content type="text"><![CDATA[Sourcetreeè®°å½•~!æ›´æ–°gitå¯†ç ä½¿ç”¨sourcetreeæ—¶ç™»å½•gitè´¦å·,gitè´¦å·ä¿®æ”¹äº†å¯†ç åsourcetreeåœ¨æäº¤/æ‹‰å–ä»£ç æ—¶åªä¼šæŠ¥é”™,å¹¶ä¸ä¼šå¼¹å‡ºgitç™»å½•çª—å£è®©ç”¨æˆ·é‡æ–°ç™»å½•.è§£å†³æ–¹æ³•: windowsè¿›å…¥ä»¥ä¸‹ç›®å½•,åˆ é™¤passwdæ–‡ä»¶1C:\Users\USERNAME\AppData\Local\Atlassian\SourceTreeåˆ é™¤æ–‡ä»¶å,å†æ¬¡æ‹‰å–/æäº¤ä»£ç å°±ä¼šå¼¹å‡ºgitç™»å½•çª—å£ä¿®æ”¹gitç™»å½•åç§°sourcetreeé‡æ–°ç™»å½•gitæ—¶æ— æ³•ä¿®æ”¹ç”¨æˆ·åç§°è§£å†³æ–¹æ³•: windowsè¿›å…¥ä¸Šé¢ç›®å½•,ä¿®æ”¹userhostsæ–‡ä»¶å¯¹åº”çš„ç™»å½•åç§°å³å¯]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨</category>
      </categories>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ZKåˆ†å¸ƒå¼é”]]></title>
    <url>%2F2019%2F05%2F17%2FZK%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%2F</url>
    <content type="text"><![CDATA[åªåšè®°å½•ä»‹ç»ä½¿ç”¨curatorå®¢æˆ·ç«¯æ“ä½œzookeeperå¼•å…¥ä¾èµ–123456789&lt;!-- ç‰ˆæœ¬å· --&gt;&lt;curator.version&gt;4.0.0&lt;/curator.version&gt;&lt;!-- ZKå®¢æˆ·ç«¯:curator --&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.curator&lt;/groupId&gt; &lt;artifactId&gt;curator-recipes&lt;/artifactId&gt; &lt;version&gt;$&#123;curator.version&#125;&lt;/version&gt;&lt;/dependency&gt;zookeeperç›¸å…³ä¾èµ–1234567891011121314&lt;!-- ç‰ˆæœ¬å· --&gt;&lt;zookeeper.version&gt;3.4.10&lt;/zookeeper.version&gt;&lt;zkclient.version&gt;0.10&lt;/zkclient.version&gt;&lt;dependency&gt; &lt;groupId&gt;com.101tec&lt;/groupId&gt; &lt;artifactId&gt;zkclient&lt;/artifactId&gt; &lt;version&gt;$&#123;zkclient.version&#125;&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;$&#123;zookeeper.version&#125;&lt;/version&gt;&lt;/dependency&gt;ä»£ç å®ç°1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768/** * @author LuGuoZheng * @date 2019/5/15 13:33 * @Version 3.0 * @description */public class ZKLock &#123; /** * zkå®¢æˆ·ç«¯ */ public static CuratorFramework client = null; public InterProcessMutex mutex = null; /** * åˆå§‹åŒ–zkå®¢æˆ·ç«¯ */ static &#123; System.out.println("å¼€å§‹åˆå§‹åŒ–zkå®¢æˆ·ç«¯"); // é‡è¯•ç­–ç•¥:é‡è¯•3æ¬¡,æ¯æ¬¡é‡è¯•é—´éš”1s RetryPolicy retryPolicy = new ExponentialBackoffRetry(1000, 3); client = CuratorFrameworkFactory.builder() .connectString("139.159.253.188:2181")// zkåœ°å€ .sessionTimeoutMs(15000) // ä¼šè¯è¶…æ—¶æ—¶é—´ .connectionTimeoutMs(30000) // è¿æ¥è¶…æ—¶æ—¶é—´ .retryPolicy(retryPolicy) // é‡è¯•ç­–ç•¥ .namespace("YL_LGZ") // åç§° .build(); // å¯åŠ¨zkå®¢æˆ·ç«¯è¿æ¥zk client.start(); &#125; /** * * @param code èŠ‚ç‚¹åç§° */ public void init(String code) &#123; System.out.println("åˆ›å»ºèŠ‚ç‚¹å¯¹è±¡"); mutex = new InterProcessMutex(client, code); &#125; /** * åŠ é”:äº’æ–¥é” */ public void lock()&#123; try &#123; mutex.acquire(); &#125; catch (Exception e) &#123; e.printStackTrace(); System.out.println("æ·é”å¤±è´¥"); &#125; &#125; /** * é‡Šæ”¾é” */ public void unLock() &#123; try &#123; mutex.release(); &#125; catch (Exception e) &#123; e.printStackTrace(); System.out.println("é‡Šæ”¾é”å¤±è´¥"); &#125; &#125;&#125;æµ‹è¯•123456789101112131415161718192021222324/** * @author LuGuoZheng * @date 2019/5/15 15:06 * @Version 3.0 * @description */public class TestLock extends ZKLock &#123; public TestLock()&#123; super.init("/LGZ_TEST_CODE"); &#125; @Test public void test() throws InterruptedException &#123; TestLock testLock = new TestLock(); try &#123; testLock.lock(); System.out.println(""); Thread.sleep(5000); &#125; finally &#123; testLock.unLock(); System.out.println("é‡Šæ”¾æˆåŠŸ"); &#125; &#125;&#125;]]></content>
      <categories>
        <category>ä¸­é—´ä»¶</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>åˆ†å¸ƒå¼é”</tag>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[zkå‘½ä»¤]]></title>
    <url>%2F2019%2F05%2F15%2Fzk%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[zkæ“ä½œå‘½ä»¤å¯åŠ¨zk1./zkServer.sh startè¿æ¥å®¢æˆ·ç«¯1[root@ecs-e339-0002 bin]# ./zkCli.shlsæŸ¥çœ‹å‘½ä»¤1[zk: localhost:2181(CONNECTED) 2] ls /]]></content>
      <categories>
        <category>ä¸­é—´ä»¶</category>
      </categories>
      <tags>
        <tag>zookeeper</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Shellè„šæœ¬]]></title>
    <url>%2F2019%2F05%2F13%2FShell%E8%84%9A%E6%9C%AC%2F</url>
    <content type="text"><![CDATA[æ”¶è—å¸¸ç”¨çš„shellè„šæœ¬é‡å¯javaé¡¹ç›®test.sh (ç»“æŸè¿›ç¨‹)12345678910#!/bin/bashecho "Stopping SpringBoot Application for CMP"pid=`ps -ef | grep $1* | grep -v grep | awk '&#123;print $2&#125;'`if [ -n "$pid" ]then kill -9 $pidecho 'kill process'else echo "no pid"fitt.sh(æ£€æŸ¥é¡¹ç›®æ˜¯å¦å¯åŠ¨å®Œæ¯•)12345678910111213141516171819#!/bin/bashecho "start script ................"file=$1while [ -f $file ]do echo "find log ........." result=`grep "å¯åŠ¨æˆåŠŸ" $file` if [[ "$result" != "" ]] then echo "springboot start ........." break else echo "running ......." sleep 1s fidoneecho "springboot Started..........."run.sh(ä¸»shellè„šæœ¬)1234567891011121314151617181920212223#!/bin/bashsource /etc/profile#ç‰ˆæœ¬ä¿¡æ¯jarversion='-0.0.1-SNAPSHOT.jar'#æ—¥å¿—è·¯å¾„logpath='/pro/test/home/yanfa/'runjar()&#123; sh test.sh $1 nohup java -jar $4 $1$jarversion &gt; $logpath$2 &amp; 2&gt;&amp;1 &amp; sh tt.sh $logpath$2 echo $3&#125;runjar 'ylcloud-item-service' 'nohup_item.out' 'å•†å“æ¨¡å—å¯åŠ¨å®Œæˆ' '-Xms10m -Xmx200m'echo 'é¡¹ç›®å¯åŠ¨æˆåŠŸ']]></content>
      <tags>
        <tag>Linux</tag>
        <tag>shell</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gitå‘½ä»¤]]></title>
    <url>%2F2019%2F05%2F13%2Fgit%E5%91%BD%E4%BB%A4-1%2F</url>
    <content type="text"><![CDATA[è®°å½•å¸¸ç”¨çš„gitå‘½ä»¤åˆ é™¤å·²å…³è”çš„è¿œç¨‹ä»“åº“1git remote rm originæš‚å­˜åˆ°æœ¬åœ°ä»“åº“1git commit -m &quot;add 3 files.&quot;æ¨é€åˆ°è¿œç¨‹ä»“åº“1234git pull origin master// å¼ºè¡Œæ¨é€git pull origin master -f]]></content>
      <tags>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹åŠ¨æ€ä»£ç†æ¨¡å¼]]></title>
    <url>%2F2019%2F05%2F13%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åŠ¨æ€ä»£ç†ç±»æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç”± JVM é€šè¿‡åå°„ç­‰æœºåˆ¶åŠ¨æ€çš„ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä»£ç†ç±»çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œä»£ç†å¯¹è±¡å’ŒçœŸå®å¯¹è±¡çš„å…³ç³»æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æœŸæ‰ç¡®å®šçš„ã€‚åŠ¨æ€ä»£ç†ç±»æ˜¯åœ¨ç¨‹åºè¿è¡ŒæœŸé—´ç”± JVM é€šè¿‡åå°„ç­‰æœºåˆ¶åŠ¨æ€çš„ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸å­˜åœ¨ä»£ç†ç±»çš„å­—èŠ‚ç æ–‡ä»¶ï¼Œä»£ç†å¯¹è±¡å’ŒçœŸå®å¯¹è±¡çš„å…³ç³»æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶æœŸæ‰ç¡®å®šçš„ã€‚å¦‚ä½•åŠ¨æ€çš„åˆ›å»ºä¸€ä»½å­—èŠ‚ç ï¼šç”±äº JVM é€šè¿‡å­—èŠ‚ç çš„äºŒè¿›åˆ¶ä¿¡æ¯åŠ è½½ç±»çš„ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è¿è¡ŒæœŸç³»ç»Ÿä¸­ï¼Œéµå¾ª Java ç¼–è¯‘ç³»ç»Ÿç»„ç»‡ .class æ–‡ä»¶çš„æ ¼å¼å’Œç»“æ„ï¼Œç”Ÿæˆç›¸åº”çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œç„¶åå†æŠŠè¿™ä¸ªäºŒè¿›åˆ¶æ•°æ®åŠ è½½è½¬æ¢æˆå¯¹åº”çš„ç±»ã€‚å¦‚æ­¤ï¼Œå°±å®Œæˆäº†åœ¨ä»£ç ä¸­åŠ¨æ€åˆ›å»ºä¸€ä¸ªç±»çš„èƒ½åŠ›äº†ã€‚ç›¸å…³èµ„æ–™InvocationHandler ç±»InvocationHandleræ˜¯ç”±ä»£ç†å®ä¾‹çš„è°ƒç”¨å¤„ç†ç¨‹åºå®ç°çš„æ¥å£ ã€‚æ¯ä¸ªä»£ç†å®ä¾‹éƒ½æœ‰ä¸€ä¸ªå…³è”çš„è°ƒç”¨å¤„ç†ç¨‹åºã€‚ å½“åœ¨ä»£ç†å®ä¾‹ä¸Šè°ƒç”¨æ–¹æ³•æ—¶ï¼Œæ–¹æ³•è°ƒç”¨å°†è¢«ç¼–ç å¹¶åˆ†æ´¾åˆ°å…¶è°ƒç”¨å¤„ç†ç¨‹åºçš„invokeæ–¹æ³•ã€‚1234567ä¸»è¦æ–¹æ³•ï¼špublic Object invoke(Object proxy, Method method, Object[] args) æ–¹æ³•èŒè´£ï¼šè´Ÿè´£é›†ä¸­å¤„ç†åŠ¨æ€ä»£ç†ç±»ä¸Šçš„æ‰€æœ‰æ–¹æ³•è°ƒç”¨ å‚æ•°ï¼š proxy ï¼šç”Ÿæˆçš„ä»£ç†å¯¹è±¡ methodï¼šå½“å‰è°ƒç”¨çš„çœŸå®æ–¹æ³•å¯¹è±¡ args ï¼šå½“å‰è°ƒç”¨æ–¹æ³•çš„å®å‚ è¿”å›ï¼šçœŸå®æ–¹æ³•çš„è¿”å›ç»“æœProxy ç±»Proxyæä¾›äº†åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å’Œå®ä¾‹çš„é™æ€æ–¹æ³•ï¼Œå®ƒä¹Ÿæ˜¯ç”±è¿™äº›æ–¹æ³•åˆ›å»ºçš„æ‰€æœ‰åŠ¨æ€ä»£ç†ç±»çš„è¶…ç±»ã€‚1234567ä¸»è¦æ–¹æ³•ï¼špublic static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler hanlder) æ–¹æ³•èŒè´£ï¼šä¸ºæŒ‡å®šç±»åŠ è½½å™¨ã€ä¸€ç»„æ¥å£åŠè°ƒç”¨å¤„ç†å™¨ç”ŸæˆåŠ¨æ€ä»£ç†ç±»å®ä¾‹ å‚æ•°: loader ï¼šç±»åŠ è½½å™¨ï¼Œä¸€èˆ¬ä¼ é€’çœŸå®å¯¹è±¡çš„ç±»åŠ è½½å™¨ interfacesï¼šä»£ç†ç±»éœ€è¦å®ç°çš„æ¥å£ hanlderï¼šä»£ç†å¯¹è±¡å¦‚ä½•åšå¢å¼º: è¿”å›ï¼šåˆ›å»ºçš„ä»£ç†å¯¹è±¡é™æ€æ–¹æ³•static ObjectnewProxyInstance(ClassLoader loader, ç±»&lt;?&gt;[] interfaces, InvocationHandler h) è¿”å›æŒ‡å®šæ¥å£çš„ä»£ç†ç±»çš„å®ä¾‹ï¼Œè¯¥æ¥å£å°†æ–¹æ³•è°ƒç”¨åˆ†æ´¾ç»™æŒ‡å®šçš„è°ƒç”¨å¤„ç†ç¨‹åºã€‚å®ç°åŠ¨æ€ä»£ç†æ–¹å¼ é’ˆå¯¹æœ‰æ¥å£ï¼šä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼› é’ˆå¯¹æ— æ¥å£ï¼šä½¿ç”¨ CGLIB æˆ– Javassist ç»„ä»¶ã€‚è‹¥ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ç”Ÿæˆä»£ç†ç±»,çœŸå®ç±»å¿…é¡»å®ç°ä¸€ä¸ªæ¥å£ä»£ç å®ç°(JDKåŠ¨æ€ä»£ç†)ä»£ç†æ¥å£123456789101112131415/** * @author LuGuoZheng * @date 2019/5/9 9:42 * @Version 3.0 * @description ä»£ç†æ¥å£ */public interface EmployeeService &#123; /** * ç­¾è®¢åˆåŒ * @param name å§“å * @param contract åˆåŒ */ void save(String name, String contract);&#125;çœŸå®å¯¹è±¡12345678910111213141516171819/** * @author LuGuoZheng * @date 2019/5/9 10:31 * @Version 3.0 * @description çœŸå®å¯¹è±¡ */public class EmployeeServiceImpl implements EmployeeService &#123; /** * ç­¾è®¢åˆåŒ * * @param name å§“å * @param contract åˆåŒ */ @Override public void save(String name, String contract) &#123; System.out.println("æˆ‘æ˜¯çœŸå®å¯¹è±¡,ä¸" + name + "ç­¾è®¢äº†" + contract); &#125;&#125;äº‹åŠ¡1234567891011121314151617181920/** * @author LuGuoZheng * @date 2019/5/9 11:17 * @Version 3.0 * @description äº‹åŠ¡ */public class MyTransactionManger &#123; public void begin()&#123; System.out.println("å¼€å¯äº‹åŠ¡"); &#125; public void rollback()&#123; System.out.println("å›æ»šäº‹åŠ¡"); &#125; public void commit()&#123; System.out.println("æäº¤äº‹åŠ¡"); &#125;&#125;å¤„ç†å™¨123456789101112131415161718192021222324252627282930313233343536373839404142434445/** * @author LuGuoZheng * @date 2019/5/11 16:45 * @Version 3.0 * @description */public class TransactionManagerHandler implements InvocationHandler &#123; // çœŸå®å¯¹è±¡ private Object target; // äº‹åŠ¡å¯¹è±¡ private MyTransactionManger tx; public void setTarget(Object target) &#123; this.target = target; &#125; public void setMyTransactionManger(MyTransactionManger tx) &#123; this.tx = tx; &#125; // è·å–ä»£ç†å¯¹è±¡ public &lt;T&gt; T getProxy()&#123; return (T) Proxy.newProxyInstance( target.getClass().getClassLoader(), target.getClass().getInterfaces(), this); &#125; @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; Object result = null; tx.begin(); try &#123; result = method.invoke(target,args); tx.commit(); &#125; catch (Exception e) &#123; e.printStackTrace(); tx.rollback(); &#125; return result; &#125;&#125;æµ‹è¯•12345678910111213141516171819202122232425/** * @author LuGuoZheng * @date 2019/5/11 16:58 * @Version 3.0 * @description */public class Test &#123; public static void main(String[] args) &#123; MyTransactionManger tx = new MyTransactionManger(); EmployeeService employeeService = new EmployeeServiceImpl(); TransactionManagerHandler handler = new TransactionManagerHandler(); handler.setMyTransactionManger(tx); handler.setTarget(employeeService); System.out.println("çœŸå®ç±»:" + employeeService); EmployeeService proxy = handler.getProxy(); System.out.println("ä»£ç†ç±»:" + proxy); proxy.save("å¼ ä¸‰","10å¹´é•¿æœŸåˆåŒ"); &#125;&#125;ç»“æœ123å¼€å¯äº‹åŠ¡æˆ‘æ˜¯çœŸå®å¯¹è±¡,ä¸å¼ ä¸‰ç­¾è®¢äº†10å¹´é•¿æœŸåˆåŒæäº¤äº‹åŠ¡è°ƒç”¨æµç¨‹JDKåŠ¨æ€ä»£ç†æ€»ç»“Java åŠ¨æ€ä»£ç†æ˜¯ä½¿ç”¨ java.lang.reflect åŒ…ä¸­çš„ Proxy ç±»ä¸ InvocationHandler æ¥å£è¿™ä¸¤ä¸ªæ¥å®Œæˆçš„ã€‚è¦ä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œå§”æ‰˜ç±»å¿…é¡»å®ç°æ¥å£ã€‚JDK åŠ¨æ€ä»£ç†å°†ä¼šæ‹¦æˆªæ‰€æœ‰ pubic çš„æ–¹æ³•ï¼ˆå› ä¸ºåªèƒ½è°ƒç”¨æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼‰ï¼Œè¿™æ ·å³ä½¿åœ¨æ¥å£ä¸­å¢åŠ äº†æ–°çš„æ–¹æ³•ï¼Œä¸ç”¨ä¿®æ”¹ä»£ç ä¹Ÿä¼šè¢«æ‹¦æˆªã€‚åŠ¨æ€ä»£ç†çš„æœ€å°å•ä½æ˜¯ç±»ï¼ˆç±»ä¸­æŸäº›æ–¹æ³•éƒ½ä¼šè¢«å¤„ç†ï¼‰ï¼Œå¦‚æœåªæƒ³æ‹¦æˆªä¸€éƒ¨åˆ†æ–¹æ³•ï¼Œå¯ä»¥åœ¨ invoke æ–¹æ³•ä¸­å¯¹è¦æ‰§è¡Œçš„æ–¹æ³•åè¿›è¡Œåˆ¤æ–­ã€‚å¯¹æ¥å£åˆ›å»ºä»£ç†ä¼˜äºå¯¹ç±»åˆ›å»ºä»£ç†ï¼Œå› ä¸ºä¼šäº§ç”Ÿæ›´åŠ æ¾è€¦åˆçš„ç³»ç»Ÿï¼Œä¹Ÿæ›´ç¬¦åˆé¢å‘æ¥å£ç¼–ç¨‹è§„èŒƒã€‚è‹¥å§”æ‰˜ç±»å®ç°äº†æ¥å£ï¼Œä¼˜å…ˆé€‰ç”¨ JDK åŠ¨æ€ä»£ç†ã€‚è‹¥å§”æ‰˜ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œä½¿ç”¨ Javassit å’Œ CGLIB åŠ¨æ€ä»£ç†ã€‚]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹é™æ€ä»£ç†æ¨¡å¼]]></title>
    <url>%2F2019%2F05%2F09%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%9D%99%E6%80%81%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨çš„éƒ½æ˜¯ä»£ç†å¯¹è±¡ï¼Œä¸çŸ¥é“çœŸå®å¯¹è±¡æ˜¯è°ï¼Œæ­¤æ—¶ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒçœŸå®å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ã€‚1.1ã€ä»£ç†å¯¹è±¡å®Œå…¨åŒ…å«çœŸå®å¯¹è±¡ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨çš„éƒ½æ˜¯ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå’ŒçœŸå®å¯¹è±¡æ²¡æœ‰ç›´æ¥å…³ç³»ï¼›1.2ã€ä»£ç†æ¨¡å¼çš„èŒè´£ï¼šæŠŠä¸æ˜¯çœŸå®å¯¹è±¡è¯¥åšçš„äº‹æƒ…ä»çœŸå®å¯¹è±¡ä¸Šæ’‡å¼€â€”â€”èŒè´£åˆ†ç¦»ã€‚ä»£ç†æ¨¡å¼å®¢æˆ·ç«¯ç›´æ¥ä½¿ç”¨çš„éƒ½æ˜¯ä»£ç†å¯¹è±¡ï¼Œä¸çŸ¥é“çœŸå®å¯¹è±¡æ˜¯è°ï¼Œæ­¤æ—¶ä»£ç†å¯¹è±¡å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒçœŸå®å¯¹è±¡ä¹‹é—´èµ·åˆ°ä¸­ä»‹çš„ä½œç”¨ã€‚1.1ã€ä»£ç†å¯¹è±¡å®Œå…¨åŒ…å«çœŸå®å¯¹è±¡ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨çš„éƒ½æ˜¯ä»£ç†å¯¹è±¡çš„æ–¹æ³•ï¼Œå’ŒçœŸå®å¯¹è±¡æ²¡æœ‰ç›´æ¥å…³ç³»ï¼›1.2ã€ä»£ç†æ¨¡å¼çš„èŒè´£ï¼šæŠŠä¸æ˜¯çœŸå®å¯¹è±¡è¯¥åšçš„äº‹æƒ…ä»çœŸå®å¯¹è±¡ä¸Šæ’‡å¼€â€”â€”èŒè´£åˆ†ç¦»ã€‚1. é™æ€ä»£ç†åœ¨ç¨‹åºè¿è¡Œå‰å°±å·²ç»å­˜åœ¨ä»£ç†ç±»çš„å­—èŠ‚ç æ–‡ä»¶,ä»£ç†å¯¹è±¡å’ŒçœŸå®å¯¹è±¡çš„å…³ç³»åœ¨è¿è¡Œå‰å°±ç¡®å®šäº†.2. ä»£ç å®ç°ä»£ç†æ¥å£123456789101112131415/** * @author LuGuoZheng * @date 2019/5/9 9:42 * @Version 3.0 * @description ä»£ç†æ¥å£ */public interface EmployeeService &#123; /** * ç­¾è®¢åˆåŒ * @param name å§“å * @param contract åˆåŒ */ void save(String name, String contract);&#125;çœŸå®å¯¹è±¡12345678910111213141516171819/** * @author LuGuoZheng * @date 2019/5/9 10:31 * @Version 3.0 * @description çœŸå®å¯¹è±¡ */public class EmployeeServiceImpl implements EmployeeService &#123; /** * ç­¾è®¢åˆåŒ * * @param name å§“å * @param contract åˆåŒ */ @Override public void save(String name, String contract) &#123; System.out.println("æˆ‘æ˜¯çœŸå®å¯¹è±¡,ä¸" + name + "ç­¾è®¢äº†" + contract); &#125;&#125;ä»£ç†å¯¹è±¡1234567891011121314151617181920212223242526272829303132333435363738394041424344454647/** * @author LuGuoZheng * @date 2019/5/9 10:34 * @Version 3.0 * @description ä»£ç†å¯¹è±¡ */public class EmployeeProxyImpl implements EmployeeService &#123; /** * çœŸå®å¯¹è±¡ */ private EmployeeService target; private MyTransactionManger myTransactionManger; public void setTarget(EmployeeService target)&#123; this.target = target; &#125; public void setMyTransactionManger(MyTransactionManger myTransactionManger)&#123; this.myTransactionManger = myTransactionManger; &#125; /** * ç­¾è®¢åˆåŒ * * @param name å§“å * @param contract åˆåŒ */ @Override public void save(String name, String contract) &#123; myTransactionManger.begin(); try &#123; // çœŸå®å¯¹è±¡åªè´Ÿè´£ç­¾è®¢åˆåŒ target.save(name,contract); // TODO ç­¾è®¢åˆåŒåå¤„ç†ä¸€ç³»åˆ—å…¶ä»–é—®é¢˜ myTransactionManger.commit(); &#125; catch (Exception e) &#123; myTransactionManger.rollback(); e.printStackTrace(); &#125; &#125;&#125;äº‹åŠ¡1234567891011121314151617181920/** * @author LuGuoZheng * @date 2019/5/9 11:17 * @Version 3.0 * @description äº‹åŠ¡ */public class MyTransactionManger &#123; public void begin()&#123; System.out.println("å¼€å¯äº‹åŠ¡"); &#125; public void rollback()&#123; System.out.println("å›æ»šäº‹åŠ¡"); &#125; public void commit()&#123; System.out.println("æäº¤äº‹åŠ¡"); &#125;&#125;æµ‹è¯•123456789101112131415161718192021/** * @author LuGuoZheng * @date 2019/5/9 11:01 * @Version 3.0 * @description æµ‹è¯• * * */public class Test &#123; public static void main(String[] args) &#123; EmployeeServiceImpl employeeService = new EmployeeServiceImpl(); EmployeeProxyImpl employeeProxy = new EmployeeProxyImpl(); MyTransactionManger myTransactionManger = new MyTransactionManger(); employeeProxy.setMyTransactionManger(myTransactionManger); employeeProxy.setTarget(employeeService); employeeProxy.save(" å¼ ä¸‰ ","10é•¿æœŸåˆåŒ~!"); &#125;&#125;æµ‹è¯•ç»“æœ123å¼€å¯äº‹åŠ¡æˆ‘æ˜¯çœŸå®å¯¹è±¡,ä¸ å¼ ä¸‰ ç­¾è®¢äº†10é•¿æœŸåˆåŒ~!æäº¤äº‹åŠ¡3. é™æ€ä»£ç†ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ä¸šåŠ¡åªéœ€è¦å…³æ³¨ä¸šåŠ¡é€»è¾‘æœ¬èº«,ä¿è¯äº†ä¸šåŠ¡ç±»çš„é‡è¦æ€§.æŠŠçœŸå®å¯¹è±¡éšè—èµ·æ¥,ä¿æŠ¤çœŸå®å¯¹è±¡ç¼ºç‚¹ä»£ç†å¯¹è±¡çš„æŸä¸ªæ¥å£åªæœåŠ¡äºæŸä¸€ç§ç±»å‹çš„å¯¹è±¡,ä¹Ÿå°±æ˜¯ä¸ºæ¯ä¸ªçœŸå®ç±»åˆ›å»ºä¸€ä¸ªä»£ç†ç±».è‹¥éœ€è¦ä»£ç†çš„æ–¹æ³•å¾ˆå¤š,é‚£ä¹ˆå°±è¦ä¸ºæ¯ä¸€ç§æ–¹æ³•éƒ½è¿›è¡Œä»£ç†å¤„ç†.è‹¥æ¥å£å¢åŠ ä¸€ä¸ªæ–¹æ³•,é™¤äº†æ‰€æœ‰å®ç°ç±»éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•,ä»£ç†ç±»ä¹Ÿéœ€è¦å®ç°æ­¤æ–¹æ³•.]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼]]></title>
    <url>%2F2019%2F05%2F08%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[åœ¨å¯¹è±¡ä¹‹é—´å®šä¹‰äº†ä¸€å¯¹å¤šçš„ä¾èµ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œä¾èµ–å®ƒçš„å¯¹è±¡ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚è§‚å¯Ÿè€…æ¨¡å¼çš„å®šä¹‰åœ¨å¯¹è±¡ä¹‹é—´å®šä¹‰äº†ä¸€å¯¹å¤šçš„ä¾èµ–ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ”¹å˜çŠ¶æ€ï¼Œä¾èµ–å®ƒçš„å¯¹è±¡ä¼šæ”¶åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚MQçš„å‘å¸ƒè®¢é˜…æ¨¡å¼å…¶å®å°±æ˜¯å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œå‘å¸ƒè€…å‘å¸ƒä¿¡æ¯ï¼Œè®¢é˜…è€…è·å–ä¿¡æ¯ï¼Œè®¢é˜…äº†å°±èƒ½æ”¶åˆ°ä¿¡æ¯ï¼Œæ²¡è®¢é˜…å°±æ”¶ä¸åˆ°ä¿¡æ¯ã€‚æ¨¡å¼æ¶µç›–çš„è§’è‰²æŠ½è±¡è¢«è§‚å¯Ÿè€…è§’è‰²ï¼šä¹Ÿå°±æ˜¯ä¸€ä¸ªæŠ½è±¡ä¸»é¢˜ï¼Œå®ƒæŠŠæ‰€æœ‰å¯¹è§‚å¯Ÿè€…å¯¹è±¡çš„å¼•ç”¨ä¿å­˜åœ¨ä¸€ä¸ªé›†åˆä¸­ï¼Œæ¯ä¸ªä¸»é¢˜éƒ½å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„è§‚å¯Ÿè€…ã€‚æŠ½è±¡ä¸»é¢˜æä¾›ä¸€ä¸ªæ¥å£ï¼Œå¯ä»¥å¢åŠ å’Œåˆ é™¤è§‚å¯Ÿè€…è§’è‰²ã€‚ä¸€èˆ¬ç”¨ä¸€ä¸ªæŠ½è±¡ç±»å’Œæ¥å£æ¥å®ç°ã€‚æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²ï¼šä¸ºæ‰€æœ‰çš„å…·ä½“è§‚å¯Ÿè€…å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œåœ¨å¾—åˆ°ä¸»é¢˜é€šçŸ¥æ—¶æ›´æ–°è‡ªå·±ã€‚å…·ä½“è¢«è§‚å¯Ÿè€…è§’è‰²ï¼šä¹Ÿå°±æ˜¯ä¸€ä¸ªå…·ä½“çš„ä¸»é¢˜ï¼Œåœ¨é›†ä½“ä¸»é¢˜çš„å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œæ‰€æœ‰ç™»è®°è¿‡çš„è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚å…·ä½“è§‚å¯Ÿè€…è§’è‰²ï¼šå®ç°æŠ½è±¡è§‚å¯Ÿè€…è§’è‰²æ‰€éœ€è¦çš„æ›´æ–°æ¥å£ï¼Œä¸€è¾¹ä½¿æœ¬èº«çš„çŠ¶æ€ä¸åˆ¶å›¾çš„çŠ¶æ€ç›¸åè°ƒã€‚ä»£ç å®ç°è¢«è§‚å¯Ÿè€…æ¥å£12345678910111213141516171819202122232425262728/** * @author LuGuoZheng * @date 2019/5/8 13:42 * @Version 3.0 * @description è¢«è§‚å¯Ÿè€…æ¥å£ */public interface Observerable &#123; /** * æ³¨å†Œè§‚å¯Ÿè€… * * @param observer è§‚å¯Ÿè€… */ void registerObServer(Observer observer); /** * ç§»é™¤è§‚å¯Ÿ * * @param observer è§‚å¯Ÿè€… */ void removeObServer(Observer observer); /** * é€šçŸ¥è§‚å¯Ÿè€… * @param message æ¶ˆæ¯ */ void notifyObServer(String message);&#125;è§‚å¯Ÿè€…æ¥å£12345678910111213141516/** * @author LuGuoZheng * @date 2019/5/8 13:44 * @Version 3.0 * @description */public interface Observer &#123; /** * å½“è¢«è§‚å¯Ÿè€…å‘å¸ƒæ¶ˆæ¯æ—¶,è°ƒç”¨è§‚å¯Ÿè€…çš„updateæ–¹æ³•,æ›´æ–°æ¶ˆæ¯ * * @param message æ¶ˆæ¯ */ void update(String message);&#125;è¢«è§‚å¯Ÿè€…12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152/** * @author LuGuoZheng * @date 2019/5/8 13:51 * @Version 3.0 * @description å…¬ä¼—å· */public class WechatServer implements Observerable &#123; /** * å¯„å­˜è®¢é˜…äº†è¯¥å…¬ä¼—å·çš„ç”¨æˆ·(è§‚å¯Ÿè€…) */ private List&lt;Observer&gt; observerList = new ArrayList&lt;&gt;(); /** * æ³¨å†Œè§‚å¯Ÿè€… * * @param observer è§‚å¯Ÿè€… */ @Override public void registerObServer(Observer observer) &#123; observerList.add(observer); System.out.println("[" + ((User) observer).getName() + "]" + "å…³æ³¨äº†å…¬ä¼—å·~!"); &#125; /** * å–æ¶ˆè§‚å¯Ÿ * * @param observer è§‚å¯Ÿè€… */ @Override public void removeObServer(Observer observer) &#123; if (observer == null) &#123; return; &#125; boolean remove = observerList.remove(observer); if (remove) &#123; System.out.println("[" + ((User) observer).getName() + "]" + "å–æ¶ˆäº†å…³æ³¨~! (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»"); &#125; &#125; /** * é€šçŸ¥è§‚å¯Ÿè€… * * @param message æ¶ˆæ¯ */ @Override public void notifyObServer(String message) &#123; for (Observer observer : observerList) &#123; observer.update(message); &#125; &#125;&#125;è§‚å¯Ÿè€…123456789101112131415161718192021222324/** * @author LuGuoZheng * @date 2019/5/8 13:56 * @Version 3.0 * @description è§‚å¯Ÿè€… */@Data@AllArgsConstructor@NoArgsConstructorpublic class User implements Observer &#123; private String name; /** * å½“è¢«è§‚å¯Ÿè€…å‘å¸ƒæ¶ˆæ¯æ—¶,è°ƒç”¨è§‚å¯Ÿè€…çš„updateæ–¹æ³•,æ›´æ–°æ¶ˆæ¯ * * @param message æ¶ˆæ¯ */ @Override public void update(String message) &#123; System.out.println("æˆ‘æ˜¯:" + name + "," + message); &#125;&#125;æµ‹è¯•1234567891011121314151617181920212223242526272829303132/** * @author LuGuoZheng * @date 2019/5/8 14:24 * @Version 3.0 * @description */public class Test &#123; public static void main(String[] args) &#123; Observer u1 = new User("å¼ ä¸‰"); Observer u2 = new User("æå››"); Observer u3 = new User("ç‹äº”"); Observerable wecahtService = new WechatServer(); // è§‚å¯Ÿ(è®¢é˜…)å…¬ä¼—å· wecahtService.registerObServer(u1); wecahtService.registerObServer(u2); wecahtService.registerObServer(u3); System.out.println("--------------------------------"); // å‘å¸ƒæ¶ˆæ¯ wecahtService.notifyObServer("ç¬¬ä¸€æ³¢ç¦åˆ©"); System.out.println("--------------------------------"); // å–æ¶ˆå…³æ³¨ wecahtService.removeObServer(u1); System.out.println("--------------------------------"); // å‘å¸ƒæ¶ˆæ¯ wecahtService.notifyObServer("è¿™æ˜¯ç¬¬äºŒæ³¢ç¦åˆ©"); &#125;&#125;æµ‹è¯•ç»“æœ123456789101112[å¼ ä¸‰]å…³æ³¨äº†å…¬ä¼—å·~![æå››]å…³æ³¨äº†å…¬ä¼—å·~![ç‹äº”]å…³æ³¨äº†å…¬ä¼—å·~!--------------------------------æˆ‘æ˜¯:å¼ ä¸‰,ç¬¬ä¸€æ³¢ç¦åˆ©æˆ‘æ˜¯:æå››,ç¬¬ä¸€æ³¢ç¦åˆ©æˆ‘æ˜¯:ç‹äº”,ç¬¬ä¸€æ³¢ç¦åˆ©--------------------------------[å¼ ä¸‰]å–æ¶ˆäº†å…³æ³¨~! (â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»--------------------------------æˆ‘æ˜¯:æå››,è¿™æ˜¯ç¬¬äºŒæ³¢ç¦åˆ©æˆ‘æ˜¯:ç‹äº”,è¿™æ˜¯ç¬¬äºŒæ³¢ç¦åˆ©å‚è€ƒ:JAVAè®¾è®¡æ¨¡å¼ä¹‹è§‚å¯Ÿè€…æ¨¡å¼]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Linuxç›¸å…³å‘½ä»¤]]></title>
    <url>%2F2019%2F04%2F26%2FLinux%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4%2F</url>
    <content type="text"><![CDATA[å¦‚é¢˜è®°å½•ä¸å¸¸ç”¨çš„Linuxå‘½ä»¤è¿è¡Œjavaé¡¹ç›®1nohup java -jar -Xms10m -Xmx200m ylcloud-item-service-0.0.1-SNAPSHOT.jar &gt; /pro/test/home/yanfa/nohup_item.out &amp; 2&gt;&amp;1 &amp;nohup: åå°å¯åŠ¨é¡¹ç›®-Xms10m -Xmx200m: jvmè™šæ‹Ÿæœºå‚æ•°æŸ¥çœ‹æŸç«¯å£å ç”¨çš„çº¿ç¨‹çš„pid1netstat -nlp |grep :4000æŸ¥çœ‹pidå ç”¨çš„ç«¯å£å·1netstat -nap | grep 32716äºŒ. é˜²ç«å¢™2.1 æŸ¥çœ‹æ‰€æœ‰æ‰“å¼€çš„ç«¯å£1firewall-cmd --zone=public --list-ports2.2 å¼€å¯ç«¯å£ï¼ˆâ€“permanentå‚æ•°ä¸ºæ°¸ä¹…ç”Ÿæ•ˆï¼Œä¸åŠ åˆ™é‡å¯åå¤±æ•ˆï¼‰1firewall-cmd --zone=public --add-port=ç«¯å£å·/tcp --permanent2.3 æ›´æ–°é˜²ç«å¢™è§„åˆ™ï¼š1firewall-cmd --reload2.4 æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€123firewall-cmd --state###### æŸ¥çœ‹å®‰è£…ç›®å½•which git1##### æŸ¥çœ‹æ–‡ä»¶å¤§å°du -sh *123##### é‡å¯``nginx``- åœ¨``sbin``ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤./nginx -s reload1##### æŸ¥æ‰¾æ–‡ä»¶find / -name ${fileName}`VIæ“ä½œVIæ“ä½œ:ç”¨çš„æ˜¯é”®ç›˜çš„å·¦è¾¹çš„æ•°å­—é”®é€å­—ç¬¦ç§»åŠ¨:è¡Œå†…è·³è½¬:å³è¾¹çš„æ•°å­—é”®0:è·³è½¬åˆ°è¡Œé¦–(ç¼–è¾‘æ¨¡å¼)$(Shift+4): è·³è½¬åˆ°è¡Œå°¾(ç¼–è¾‘æ¨¡å¼)^(Shift+6): è·³è½¬åˆ°è¡Œé¦–çš„ç¬¬ä¸€ä¸ªå­—æ¯ä½ç½®(ç¼–è¾‘æ¨¡å¼)è¡Œé—´è·³è½¬:(æœ«è¡Œæ¨¡å¼)gg: è·³è½¬åˆ°æ–‡ä»¶ç¬¬ä¸€è¡Œ(ç¼–è¾‘æ¨¡å¼)G(Shift+g): è·³åˆ°æ–‡ä»¶çš„æœ€åä¸€è¡Œ(ç¼–è¾‘æ¨¡å¼)ç›´æ¥è¾“å…¥è¡Œå·å°±å¯ä»¥è·³è½¬åˆ°å¯¹åº”è¡Œæ³¨æ„:å¯ä»¥å…ˆæŠŠè¡Œå·æ˜¾ç¤ºå‡ºæ¥:set numberåœ¨ç¼–è¾‘æ¨¡å¼ä¸‹:ctrl+f å‘ä¸‹ç¿»ä¸€é¡µ forwardctrl+b å‘ä¸Šç¿»ä¸€é¡µ backwarddd: åˆ é™¤å…‰æ ‡æ‰€åœ¨è¡Œ (ç¼–è¾‘æ¨¡å¼)3dd:ä»å…‰æ ‡è¡Œå¼€å§‹åˆ é™¤3è¡Œ(ç¼–è¾‘æ¨¡å¼)â€”â€”1,4d åˆ é™¤ç¬¬ä¸€è¡Œåˆ°ç¬¬å››è¡Œ(æœ«è¡Œæ¨¡å¼)u æ’¤é”€ä¸Šä¸€ä¸ªæ“ä½œ(ç¼–è¾‘æ¨¡å¼)yy å¤åˆ¶å…‰æ ‡æ‰€åœ¨è¡Œ (ç¼–è¾‘æ¨¡å¼)2yy ä»å…‰æ ‡è¡Œå¼€å§‹å¤åˆ¶2è¡Œ(ç¼–è¾‘æ¨¡å¼)p: ç²˜è´´å‘½ä»¤æœ«è¡Œæ¨¡å¼:æ–‡ä»¶çš„æŸ¥æ‰¾/parttern ä»å‰å¾€åæŸ¥æ‰¾?parttern ä»åå¾€å‰æŸ¥æ‰¾n: ä¸‹ä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²N: ä¸Šä¸€ä¸ªåŒ¹é…çš„å­—ç¬¦ä¸²g:å…¨å±€æ›¿æ¢i:å¿½ç•¥å¤§å°å†™%s/f/F/giåˆ›å»ºæ–‡ä»¶vi æ–‡ä»¶åtouch æ–‡ä»¶ååˆ›å»ºç›®å½•mkdir ç›®å½•åmkdir -p ç›®å½•å1/ç›®å½•å2 åˆ›å»ºå±‚çº§ç›®å½• å¯ä»¥æ˜¯ç›¸å¯¹ç›®å½•,ä¹Ÿå¯ä»¥æ˜¯ç»å¯¹ç›®å½•rm æ–‡ä»¶årm -f æ–‡ä»¶årm -fr ç›®å½• åˆ é™¤ç›®å½•å¿…é¡»ä½¿ç”¨ -r é€’å½’åˆ é™¤æ‹·è´: cpæ‹·è´ç›®å½•çš„è¯è¦å¸¦ä¸Šå‚æ•°-rç§»åŠ¨: mv: mv]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹ç­–ç•¥æ¨¡å¼]]></title>
    <url>%2F2019%2F04%2F26%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ç­–ç•¥æ¨¡å¼æ€æƒ³æ˜¯é’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸€ç§ç®—æ³•éƒ½å°è£…åˆ°å…·æœ‰å…±åŒæ¥å£çš„ç‹¬ç«‹çš„ç±»ä¸­ï¼Œä»è€Œæ˜¯å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢.ç­–ç•¥æ¨¡å¼çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ä½¿å¾—ç®—æ³•å¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œæ”¹å˜ä¸åŒçš„åŠŸèƒ½ã€‚1. ç®€ä»‹æ€æƒ³æ˜¯é’ˆå¯¹ä¸€ç»„ç®—æ³•ï¼Œå°†æ¯ä¸€ç§ç®—æ³•éƒ½å°è£…åˆ°å…·æœ‰å…±åŒæ¥å£çš„ç‹¬ç«‹çš„ç±»ä¸­ï¼Œä»è€Œæ˜¯å®ƒä»¬å¯ä»¥ç›¸äº’æ›¿æ¢.ç­–ç•¥æ¨¡å¼çš„æœ€å¤§ç‰¹ç‚¹æ˜¯ä½¿å¾—ç®—æ³•å¯ä»¥åœ¨ä¸å½±å“å®¢æˆ·ç«¯çš„æƒ…å†µä¸‹å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œæ”¹å˜ä¸åŒçš„åŠŸèƒ½ã€‚2. ä»£ç å®ç°æ¥å£123456789101112131415/** * @author LuGuoZheng * @date 2019/4/26 14:37 * @Version 3.0 * @description */public interface Condition &#123; /** * æ¡ä»¶ * @param num æ•°æ® * @return */ boolean check(int num);&#125;ç±»12345678910111213141516171819202122232425262728293031323334353637383940414243444546/** * @author LuGuoZheng * @date 2019/4/26 14:36 * @Version 3.0 * @description ç­–ç•¥æ¨¡å¼ */public class Strategy &#123; /** * è¿‡æ»¤æ•°æ®æ–¹æ³• * @param nums æ•°æ®æº * @param condition ç­–ç•¥ * @return */ public List&lt;Integer&gt; filteNum(List&lt;Integer&gt; nums,Condition condition)&#123; List&lt;Integer&gt; newNums = new ArrayList&lt;&gt;(); for (Integer num : nums) &#123; if (condition.check(num))&#123; newNums.add(num); &#125; &#125; return newNums; &#125; @Test public void test() &#123; List&lt;Integer&gt; list = List.of(1, 2, 3, 4, 5, 6, 7); // ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»æµ‹è¯• list = filteNum(list, new Condition() &#123; @Override public boolean check(int num) &#123; return num % 2 == 0; &#125; &#125;); System.out.println(list); // [2, 4, 6] list = filteNum(list, new Condition() &#123; @Override public boolean check(int num) &#123; return num &lt; 5; &#125; &#125;); System.out.println(list); // [2, 4] &#125;&#125;]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹æ¨¡æ¿æ¨¡å¼]]></title>
    <url>%2F2019%2F04%2F25%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E6%A8%A1%E6%9D%BF%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[æ¨¡æ¿æ¨¡å¼å°±æ˜¯æœ‰å¾ˆå¤šç›¸åŒçš„æ­¥éª¤çš„ï¼Œåœ¨æŸä¸€äº›åœ°æ–¹å¯èƒ½æœ‰ä¸€äº›å·®åˆ«é€‚åˆäºè¿™ç§æ¨¡å¼,ä¸åŒçš„åœ°æ–¹é€šè¿‡å­ç±»è¦†å†™æ–¹æ³•å®ç°å­ç±»çš„ç‰¹æ€§.1. ç®€ä»‹æ¨¡æ¿æ¨¡å¼å°±æ˜¯æœ‰å¾ˆå¤šç›¸åŒçš„æ­¥éª¤çš„ï¼Œåœ¨æŸä¸€äº›åœ°æ–¹å¯èƒ½æœ‰ä¸€äº›å·®åˆ«é€‚åˆäºè¿™ç§æ¨¡å¼,ä¸åŒçš„åœ°æ–¹é€šè¿‡å­ç±»è¦†å†™æ–¹æ³•å®ç°å­ç±»çš„ç‰¹æ€§.2. ä»£ç å®ç°æŠ½è±¡ç±»1234567891011121314151617181920public abstract class Times &#123; private static final SimpleDateFormat fmt = new SimpleDateFormat("HH:mm:ss.SSS"); abstract void doWord(); public void test(String title) &#123; title = (title == null) ? "" : ("ã€" + title + "ã€‘"); System.out.println(title); System.out.println("å¼€å§‹ï¼š" + fmt.format(new Date())); long begin = System.currentTimeMillis(); doWord(); long end = System.currentTimeMillis(); System.out.println("ç»“æŸï¼š" + fmt.format(new Date())); double delta = (end - begin) / 1000.0; System.out.println("è€—æ—¶ï¼š" + delta + "ç§’"); System.out.println("-------------------------------------"); &#125;&#125;å­ç±»1234567891011121314151617public class MyTemplate extends Times&#123; @Override public void doWord()&#123; int sum = 0; for (int i = 0; i &lt; 1000; i++) &#123; for (int j = 0; j &lt; 1000; j++) &#123; sum += j; &#125; &#125; System.out.println(sum); &#125; public static void main(String[] args) &#123; new MyTemplate().test("doWord"); &#125;&#125;]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼ä¹‹å•ä¾‹æ¨¡å¼]]></title>
    <url>%2F2019%2F04%2F24%2F%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E4%B9%8B%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[å•ä¾‹æ¨¡å¼å°±æ˜¯å•ä¾‹å¯¹è±¡çš„ç±»åªèƒ½è¿è¡Œä¸€ä¸ªå®ä¾‹å­˜åœ¨,å¹¶ä¸”å­˜åœ¨ä¸€ä¸ªå…¬å…±é™æ€çš„æ–¹æ³•æ¥è·å–è¯¥å®ä¾‹1. ç®€ä»‹å•ä¾‹æ¨¡å¼å°±æ˜¯å•ä¾‹å¯¹è±¡çš„ç±»åªèƒ½è¿è¡Œä¸€ä¸ªå®ä¾‹å­˜åœ¨,å¹¶ä¸”å­˜åœ¨ä¸€ä¸ªå…¬å…±é™æ€çš„æ–¹æ³•æ¥è·å–è¯¥å®ä¾‹2. ä½¿ç”¨åœºæ™¯springæ¡†æ¶å°±æ˜¯å•ä¾‹æ¨¡å¼çš„3. ä»£ç å®ç°3.1 æ‡’æ±‰å¼(åŒæ£€æŸ¥ä¿è¯çº¿ç¨‹å®‰å…¨)12345678910111213141516171819202122232425public class Singleton &#123; private Integer id; private String namge; private Integer age; private volatile static Singleton INSTANCE; // ç§æœ‰åŒ–æ„é€ å™¨ private Singleton ()&#123;&#125; // æä¾›å…¬å…±é™æ€æ–¹æ³•è·å–å®ä¾‹ public static Singleton getInstance()&#123; if (INSTANCE == null)&#123; synchronized (Singleton.class)&#123; if (INSTANCE == null)&#123; INSTANCE = new Singleton(); &#125; &#125; &#125; return INSTANCE; &#125;&#125;3.2 é¥¥é¥¿å¼123456789101112131415161718192021222324/** * * ä¼˜ç‚¹: ç›´æ¥åœ¨ç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹,å¯ä»¥é¿å…çº¿ç¨‹å®‰å…¨é—®é¢˜ * ç¼ºç‚¹: ç”±äºæ˜¯ç±»åŠ è½½æ—¶å°±åˆå§‹åŒ–äº†ä¸€ä¸ªå®ä¾‹,å¦‚æœä¸€ç›´æ²¡æœ‰ä½¿ç”¨è¯¥å®ä¾‹,ä¼šé€ æˆå†…å­˜æµªè´¹,è€Œä¸”æ²¡èƒ½èµ·åˆ°æ‡’åŠ è½½æ•ˆæœ */public class Singleton &#123; private Integer id; private String name; private Integer age; // ç§æœ‰åŒ–æ„é€ å™¨ private Singleton()&#123;&#125; // åˆå§‹åŒ–ä¸€ä¸ªå®ä¾‹ private static final Singleton INSTANCE = new Singleton(); // æä¾›å…¬å…±é™æ€æ–¹æ³•è·å–å®ä¾‹ public static Singleton getInstance()&#123; return INSTANCE; &#125;&#125;3.3 æšä¸¾1234567891011121314public enum Singleton &#123; INSTANCE; private String name; public String getName()&#123; return name; &#125; public void setName(String name)&#123; this.name = name; &#125;&#125;3.4 æšä¸¾åç¼–è¯‘(ä½¿ç”¨XJadåç¼–è¯‘)é€šè¿‡åç¼–è¯‘å¯ä»¥çœ‹å‡ºå°±æ˜¯ä¸€ä¸ªé¥¥é¥¿å¼å•ä¾‹æ¨¡å¼,æ‰€æœ‰å®ç°å•ä¾‹æ¨¡å¼ç›´æ¥å†™ä¸€ä¸ªæšä¸¾å³å¯.123456789101112131415161718192021222324252627282930313233343536373839404142// ä½¿ç”¨finalä¿®é¥°ç±»,å¹¶ç»§æ‰¿äº†Enumç±»public final class Singleton extends Enum&#123; public static final Singleton INSTANCE; private String name; private static final Singleton $VALUES[]; public static Singleton[] values() &#123; return (Singleton[])$VALUES.clone(); &#125; public static Singleton valueOf(String name) &#123; return (Singleton)Enum.valueOf(53554F8B6A215F0F/Singleton, name); &#125; private Singleton(String s, int i) &#123; super(s, i); &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; // åœ¨é™æ€ä»£ç å—ä¸­ç›´æ¥åˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ static &#123; INSTANCE = new Singleton("INSTANCE", 0); $VALUES = (new Singleton[] &#123; INSTANCE &#125;); &#125;&#125;]]></content>
      <categories>
        <category>è®¾è®¡æ¨¡å¼ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>è®¾è®¡æ¨¡å¼</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å››â†’å…­æœˆä»½å­¦ä¹ è®¡åˆ’(äºŒå­£åº¦)]]></title>
    <url>%2F2019%2F04%2F23%2F%E5%9B%9B%E2%80%94%E2%80%94%E5%85%AD%E6%9C%88%E4%BB%BD%E5%AD%A6%E4%B9%A0%E7%9B%AE%E6%A0%87%2F</url>
    <content type="text"><![CDATA[å¦‚é¢˜springä½¿ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼:ç®€å•å·¥å‚å·¥å‚æ–¹æ³•ï¼ˆFactory Methodï¼‰å•ä¾‹ï¼ˆSingletonï¼‰é€‚é…å™¨ï¼ˆAdapterï¼‰åŒ…è£…å™¨ï¼ˆDecoratorï¼‰ä»£ç†ï¼ˆProxyï¼‰è§‚å¯Ÿè€…ï¼ˆObserverï¼‰ç­–ç•¥ï¼ˆStrategyï¼‰æ¨¡æ¿æ–¹æ³•ï¼ˆTemplate Methodï¼‰è®¡åˆ’å®‰æ’ å›› â†’ äº”æœˆä»½å­¦ä¹ æ•°æ®ç»“æ„ä¸ç®—æ³•è¯¾ç¨‹ åœ¨LeetCodeç»ƒä¹ ç®—æ³•é¢˜ å·©å›ºå­¦ä¹ ä¸€ç§è®¾è®¡æ¨¡å¼å¹¶å®ç°è¿›è¡Œä¸­è®¡åˆ’ æ•°æ®ç»“æ„ä¸ç®—æ³•è¯¾ç¨‹ ç®—æ³•ç»ƒä¹  è®¾è®¡æ¨¡å¼è®¡åˆ’è¿›åº¦ (ä»£ç ) ç®—æ³•ç»ƒä¹  è®¾è®¡æ¨¡å¼ å•ä¾‹æ¨¡å¼ æ¨¡æ¿æ¨¡å¼ ç­–ç•¥æ¨¡å¼ è§‚å¯Ÿè€…æ¨¡å¼ é™æ€ä»£ç†æ¨¡å¼ åŠ¨æ€ä»£ç†æ¨¡å¼]]></content>
  </entry>
  <entry>
    <title><![CDATA[ç®—æ³•å¤æ‚åº¦]]></title>
    <url>%2F2019%2F04%2F19%2F%E5%A4%8D%E6%9D%82%E5%BA%A6%2F</url>
    <content type="text"><![CDATA[æ—¶é—´å¤æ‚åº¦:ä¼°ç®—ç¨‹åºæŒ‡ä»¤çš„æ‰§è¡Œæ¬¡æ•°(æ‰§è¡Œæ—¶é—´)ç©ºé—´å¤æ‚åº¦:ä¼°ç®—æ‰€éœ€å ç”¨çš„å­˜å‚¨ç©ºé—´ç®—æ³•ç½‘ç«™ğŸ‘‡:https://leetcode-cn.com/æ—¶é—´å¤æ‚åº¦ ç™¾åº¦ç™¾ç§‘:æ—¶é—´å¤æ‚åº¦æ˜¯åŒä¸€é—®é¢˜å¯ç”¨ä¸åŒç®—æ³•è§£å†³ï¼Œè€Œä¸€ä¸ªç®—æ³•çš„è´¨é‡ä¼˜åŠ£å°†å½±å“åˆ°ç®—æ³•ä¹ƒè‡³ç¨‹åºçš„æ•ˆç‡ã€‚ç®—æ³•åˆ†æçš„ç›®çš„åœ¨äºé€‰æ‹©åˆé€‚ç®—æ³•å’Œæ”¹è¿›ç®—æ³•ã€‚ ä¸ªäººç†è§£:ä¼°ç®—ç¨‹åºæŒ‡ä»¤çš„æ‰§è¡Œæ¬¡æ•°(æ‰§è¡Œæ—¶é—´)ç©ºé—´å¤æ‚åº¦ ç™¾åº¦ç™¾ç§‘:ç©ºé—´å¤æ‚åº¦(Space Complexity)æ˜¯å¯¹ä¸€ä¸ªç®—æ³•åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶å ç”¨å­˜å‚¨ç©ºé—´å¤§å°çš„é‡åº¦ï¼Œè®°åšS(n)=O(f(n))ã€‚æ¯”å¦‚ç›´æ¥æ’å…¥æ’åºçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n^2),ç©ºé—´å¤æ‚åº¦æ˜¯O(1) ã€‚è€Œä¸€èˆ¬çš„é€’å½’ç®—æ³•å°±è¦æœ‰O(n)çš„ç©ºé—´å¤æ‚åº¦äº†ï¼Œå› ä¸ºæ¯æ¬¡é€’å½’éƒ½è¦å­˜å‚¨è¿”å›ä¿¡æ¯ã€‚ä¸€ä¸ªç®—æ³•çš„ä¼˜åŠ£ä¸»è¦ä»ç®—æ³•çš„æ‰§è¡Œæ—¶é—´å’Œæ‰€éœ€è¦å ç”¨çš„å­˜å‚¨ç©ºé—´ä¸¤ä¸ªæ–¹é¢è¡¡é‡ã€‚ ä¸ªäººç†è§£:ä¼°ç®—æ‰€éœ€å ç”¨çš„å­˜å‚¨ç©ºé—´å¤§Oè¡¨ç¤ºæ³•ä¸€èˆ¬ç”¨å¤§Oè¡¨ç¤ºæ³•æ¥æè¿°å¤æ‚åº¦,è¡¨ç¤ºçš„æ˜¯æ•°æ®è§„æ¨¡nå¯¹åº”çš„å¤æ‚åº¦123456789å¿½ç•¥å¸¸æ•°ã€ç³»æ•°ã€ä½é˜¶9 &gt;&gt;&gt; O(1)2n + 3 &gt;&gt;&gt; O(n)$n^2$ + 2n + 6 &gt;&gt;&gt; O($n^2$)$4n^3$ + $3n^2$ + 22n + 100 &gt;&gt;&gt; O($n^3$)æ³¨æ„:å¤§Oè¡¨ç¤ºæ³•ä»…ä»…åªæ˜¯ä¸€ç§ç²—ç•¥çš„åˆ†ææ¨¡å‹,æ˜¯ä¸€ç§ä¼°ç®—,èƒ½å¸®åŠ©æˆ‘ä»¬çŸ­æ—¶é—´å†…äº†è§£ä¸€ä¸ªç®—æ³•çš„æ‰§è¡Œæ•ˆç‡å¸¸è§çš„å¤æ‚åº¦å¯¹æ•°é˜¶ç»†èŠ‚å¯¹æ•°é˜¶ä¸€èˆ¬çœç•¥åº•æ•°1$log_2 n = log_2 9 * log_9 n$$æ‰€ä»¥log_2 nã€log_9 nç»Ÿç§°ä¸ºlog_n$]]></content>
      <categories>
        <category>æ•°æ®ç»“æ„ä¸ç®—æ³•ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>å¤æ‚åº¦</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[dubboéšå¼å‚æ•°ä¼ é€’]]></title>
    <url>%2F2019%2F04%2F17%2FDobbu%E9%9A%90%E5%BC%8F%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸ªdobbuä¼ é€’éšå¼å‚æ•°demo,è°ƒç”¨RPCæœåŠ¡æ—¶ç”¨äºæœåŠ¡æ¶ˆè´¹è€…å‘æœåŠ¡æä¾›è€…ä¼ é€’éšå¼å‚æ•°,æ¯”å¦‚å‘æœåŠ¡æä¾›è€…ä¼ é€’tokenä¿¡æ¯.ä¸Šä¸‹æ–‡ä¿¡æ¯RpcContextæ˜¯ä¸€ä¸ªThreadLocalçš„ä¸´æ—¶çŠ¶æ€è®°å½•å™¨ï¼Œå½“æ¥æ”¶åˆ°RPCè¯·æ±‚ï¼Œæˆ–å‘èµ·RPCè¯·æ±‚æ—¶ï¼ŒRpcContextçš„çŠ¶æ€éƒ½ä¼šå˜åŒ–ã€‚æ¯”å¦‚Aè°ƒç”¨Bï¼ŒBå†è°ƒç”¨Cï¼Œåˆ™Bæœºå™¨ä¸Šï¼Œåœ¨Bè°ƒç”¨Cä¹‹å‰ï¼ŒRpcContextè®°å½•çš„æ˜¯Aè°ƒç”¨Bçš„ä¿¡æ¯ï¼Œåœ¨Bè°ƒç”¨Cä¹‹åï¼ŒRpcContextè®°å½•çš„æ˜¯Bè°ƒç”¨Cã€‚æœåŠ¡æ¶ˆè´¹è€…:controllerå±‚12345678910111213141516@Controller@RequestMapping("/test")public class TestController &#123; @Reference private ICarService iCarService; @RequestMapping("/test") @ResponseBody public String test()&#123; // ä¼ é€’å‚æ•° RpcContext.getContext().setAttachment("TOKEN","æµ‹è¯•éšå£«å‚æ•°ä¼ é€’"); iCarService.test(); return "å‚æ•°"; &#125;&#125;æœåŠ¡æä¾›è€…:serviceå±‚æ¥å£123public interface ICarService &#123; void test();&#125;å®ç°ç±»123456789@Service@Transactionalpublic class CarServiceImpl implements ICarService &#123; public void test() &#123; // è·å–å‚æ•° String token = RpcContext.getContext().getAttachment("TOKEN"); System.out.println(token); &#125;&#125;é¡¹ç›®ä½¿ç”¨åœºæ™¯åœ¨é¡¹ç›®ä¸­ä½¿ç”¨çš„æ˜¯ç™»å½•å,ä¼šç”Ÿæˆä¸€ä¸ªtokenè¿”å›ç»™ç”¨æˆ·,ç”¨æˆ·æ¯æ¬¡ç™»å½•éƒ½è¦æŠŠæ”¹tokenå¸¦è¿‡æ¥è¿›è¡Œç™»å½•éªŒè¯,éªŒè¯é€šè¿‡ååˆ™å»è°ƒç”¨RPCæœåŠ¡,å¯ä»¥é€šè¿‡éšå£«å‚æ•°ä¼ é€’æŠŠtokenä¼ é€’åˆ°æœåŠ¡æä¾›è€…,è¿™æ ·å°±å¯ä»¥è·å–åˆ°å½“å‰ç™»å½•ç”¨æˆ·çš„token,ç„¶åå»è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯.æ³¨æ„å¦‚æœä½¿ç”¨setAttachmentsä¼šæŠŠåŸæ¥çš„å‚æ•°æ¸…ç©º,åå†ä¿å­˜ç°åœ¨çš„å‚æ•°.æºç 123456789public RpcContext setAttachments(Map&lt;String, String&gt; attachment) &#123; // æ¸…ç©ºå‚æ•° this.attachments.clear(); if (attachment != null &amp;&amp; attachment.size() &gt; 0) &#123; this.attachments.putAll(attachment); &#125; return this;&#125;]]></content>
      <categories>
        <category>Dubboç³»åˆ—</category>
      </categories>
      <tags>
        <tag>dubbo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[é…ç½®mavenæ‰“åŒ…æ–¹å¼]]></title>
    <url>%2F2019%2F04%2F15%2F%E9%85%8D%E7%BD%AEmaven%E6%89%93%E5%8C%85%E6%96%B9%E5%BC%8F%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨maven-jar-pluginå’Œmaven-dependency-pluginæ’ä»¶æ‰“åŒ…ä½¿ç”¨maven-jar-pluginå’Œmaven-dependency-pluginæ‰“åŒ…çš„åŸå› åŠå¥½å¤„ç°åœ¨é¡¹ç›®ä½¿ç”¨çš„springbootæ¡†æ¶æ­å»ºçš„mavené¡¹ç›®,ç”±äºä½¿ç”¨jenkinsè‡ªåŠ¨éƒ¨ç½²é¡¹ç›®,è€Œä¸”å¹¶æ²¡æœ‰é…ç½®å•ä¸ªæ¨¡å—éƒ¨ç½²,å¯¼è‡´æ¯æ¬¡éƒ¨ç½²éƒ½è¦10æ¥åˆ†é’Ÿ,ä¸¥é‡æµªè´¹æ—¶é—´,ç°åœ¨ä½¿ç”¨è¯¥æ’ä»¶æ‰“åŒ…åä¸ç”¨æ¯æ¬¡éƒ½ä½¿ç”¨jenkinséƒ¨ç½²,ç›´æ¥æœ¬åœ°æ‰“åŒ…å¥½ä¹‹åæ›¿æ¢æ‰æœåŠ¡å™¨çš„jarå°±è¡Œ,è€Œä¸”æ‰“åŒ…å®Œå¯ä»¥çœ‹åˆ°jaræ˜¯å¾ˆå°çš„,ä¸Šä¼ ä¹Ÿå¾ˆå¿«1. é…ç½®pomæ–‡ä»¶12345678910111213141516171819202122232425262728293031323334&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;archive&gt; &lt;manifest&gt; &lt;!-- springbootå¯åŠ¨ç±» --&gt; &lt;mainClass&gt;cn.lgz.shop.GoodsApp&lt;/mainClass&gt; &lt;addClasspath&gt;true&lt;/addClasspath&gt; &lt;classpathPrefix&gt;lib/&lt;/classpathPrefix&gt; &lt;/manifest&gt; &lt;/archive&gt; &lt;/configuration&gt;&lt;/plugin&gt;&lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-dependency-plugin&lt;/artifactId&gt; &lt;version&gt;3.1.1&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;copy-dependencies&lt;/id&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;copy-dependencies&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;outputDirectory&gt;$&#123;project.build.directory&#125;/lib&lt;/outputDirectory&gt; &lt;overWriteReleases&gt;false&lt;/overWriteReleases&gt; &lt;overWriteSnapshots&gt;false&lt;/overWriteSnapshots&gt; &lt;overWriteIfNewer&gt;true&lt;/overWriteIfNewer&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt;&lt;/plugin&gt;2. æ‰“åŒ…æ•ˆæœæ‰“åŒ…åä¼šæŠŠé¡¹ç›®ä»£ç å’Œä¾èµ–åˆ†ç¦»å¼€æ¥:ä¾èµ–ä¼šæ‰“åŒ…åˆ°libç›®å½•é¡¹ç›®ä»£ç ä¼šæ‰“åŒ…æˆä¸€ä¸ªjaråŒ…]]></content>
      <categories>
        <category>å·¥å…·é…ç½®ç›¸å…³</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>maven</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SSLæ•°å­—è¯ä¹¦Nginxé…ç½®éƒ¨ç½²]]></title>
    <url>%2F2019%2F04%2F13%2FSSL%E6%95%B0%E5%AD%97%E8%AF%81%E4%B9%A6Nginx%E9%85%8D%E7%BD%AE%E9%83%A8%E7%BD%B2%2F</url>
    <content type="text"><![CDATA[è®°å½•Nginxé…ç½®SSLæ•°å­—è¯ä¹¦çš„æ­¥éª¤ä»¥åŠé‡åˆ°ä¸€äº›çš„é—®é¢˜ å®è·µæˆæœï¼šä¸ºæœ¬ç½‘ç«™éƒ¨ç½²SSLè¯ä¹¦ï¼Œå®ç°httpsè®¿é—®ğŸ‘‡ç¯å¢ƒä»¥åŠè¯ä¹¦ğŸ‘‡:é˜¿é‡Œäº‘æœåŠ¡å™¨: CentOS7SSLæ•°å­—è¯ä¹¦: Symantec DV SSLè¯ä¹¦ï¼ˆå…è´¹ç‰ˆï¼‰ä¸€. æ·»åŠ SSLæ¨¡å—1.0 è¿›å…¥nginxè§£å‹ç›®å½•ä½¿ç”¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ·»åŠ SSLæ¨¡å—1./configure --with-http_ssl_moduleå¦‚æœæŠ¥é”™./configure: error: SSL modules require the OpenSSL library.åˆ™æ‰§è¡Œ123yum -y install openssl openssl-devel./configureæ‰§è¡Œmakeï¼ˆåˆ‡è®°ä¸èƒ½make installä¼šè¦†ç›–å®‰è£…ç›®å½•ï¼‰å°†åŸæ¥nginxå¤‡ä»½(å¯é€‰ï¼‰:å¦‚æœè‡ªå·±nginxæœ‰ä»€ä¹ˆé‡è¦é…ç½®å¯ä»¥å…ˆå¤‡ä»½ä»¥é˜²ä¸¢å¤±1cp objs/nginx /usr/local/nginx/sbin/nginxå°†æ–°çš„nginxè¦†ç›–æ—§å®‰è£…ç›®å½•1cp objs/nginx /usr/local/nginx/sbin/nginxäºŒ. é…ç½®SSLè¯ä¹¦1.0 è¿›å…¥Nginxå®‰è£…ç›®å½•confç›®å½•(PS:å®‰è£…ç›®å½•å’Œè§£å‹ç›®å½•ä¸æ˜¯åŒä¸€ä¸ªç›®å½•ï¼‰1cd /usr/local/nginx/conf/åˆ›å»ºcertç›®å½•,å¹¶æŠŠå‡†å¤‡å¥½çš„SSLæ•°å­—è¯ä¹¦æ”¾åœ¨è¯¥ç›®å½•ä¸‹1mkdir certè¿”å›confæ–‡ä»¶ï¼Œç¼–è¾‘nginx.confé…ç½®æ–‡ä»¶ï¼Œæ‰¾åˆ°ä»¥ä¸‹å†…å®¹12345678910111213141516 # HTTPS server #server &#123; #listen 443; #server_name localhost; #ssl_certificate cert.pem; #ssl_certificate_key cert.key; #ssl_session_timeout 5m; #ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #ssl_ciphers ALL:!ADH:!EXPORT56:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP; #ssl_prefer_server_ciphers on; #location / &#123; #root html; #index index.html index.htm; #proxy_pass http://localhost:4000; #&#125;#&#125;æŠŠä»¥ä¸Šå†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹å†…å®¹ï¼Œæˆ–è€…æ³¨é‡Šä»¥ä¸Šå†…å®¹é‡æ–°æ·»åŠ ä¹Ÿå¯ä»¥ï¼š123456789101112131415161718# ä»¥ä¸‹å±æ€§ä¸­ä»¥sslå¼€å¤´çš„å±æ€§ä»£è¡¨ä¸è¯ä¹¦é…ç½®æœ‰å…³ï¼Œå…¶ä»–å±æ€§è¯·æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œé…ç½®ã€‚ server &#123; listen 443; server_name localhost; # localhostä¿®æ”¹ä¸ºæ‚¨è¯ä¹¦ç»‘å®šçš„åŸŸåã€‚ ssl on; #è®¾ç½®ä¸ºonå¯ç”¨SSLåŠŸèƒ½ã€‚ root html; index index.html index.htm; ssl_certificate cert/domain name.pem; #å°†domain name.pemæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„æ–‡ä»¶åã€‚ ssl_certificate_key cert/domain name.key; #å°†domain name.keyæ›¿æ¢æˆæ‚¨è¯ä¹¦çš„å¯†é’¥æ–‡ä»¶åã€‚ ssl_session_timeout 5m; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4; #ä½¿ç”¨æ­¤åŠ å¯†å¥—ä»¶ã€‚ ssl_protocols TLSv1 TLSv1.1 TLSv1.2; #ä½¿ç”¨è¯¥åè®®è¿›è¡Œé…ç½®ã€‚ ssl_prefer_server_ciphers on; location / &#123; root html; #ç«™ç‚¹ç›®å½•ã€‚ index index.html index.htm; #æ·»åŠ å±æ€§ã€‚ &#125; &#125;ä¸‰. é…ç½®é˜¿é‡Œäº‘æœåŠ¡å™¨å®‰å…¨ç»„è§„åˆ™â­ å¦‚æœä½ ä»¥ä¸Šæ­¥éª¤éƒ½æ²¡æœ‰é—®é¢˜ï¼Œä½†æ˜¯è¿˜æ˜¯è®¿é—®ä¸äº†ï¼Œé‚£å°±è¦æŸ¥çœ‹ä¸‹æ˜¯å¦æœ‰é…ç½®443ç«¯å£çš„å®‰å…¨ç»„ï¼Œå¦‚æœæ²¡æœ‰åŠ ä¸Šå³å¯ã€‚å››. å‚è€ƒèµ„æ–™https://help.aliyun.com/document_detail/98728.htmlhttps://help.aliyun.com/video_detail/54216.html?spm=5176.2000002.0.0.19057747sUlwcdhttps://blog.csdn.net/weiyangdong/article/details/80008543]]></content>
      <categories>
        <category>æœåŠ¡å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>Nginx</tag>
        <tag>SSL</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Excelå¯¼å…¥å¯¼å‡º]]></title>
    <url>%2F2019%2F04%2F10%2FExcel%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%2F</url>
    <content type="text"><![CDATA[è®°å½•ä¸€ä¸ªjavaåŸºäºjxlå®ç°çš„Excelå¯¼å…¥å¯¼å‡ºåŠŸèƒ½ä¸€. å¼•å…¥ä¾èµ–12345&lt;dependency&gt; &lt;groupId&gt;net.sourceforge.jexcelapi&lt;/groupId&gt; &lt;artifactId&gt;jxl&lt;/artifactId&gt; &lt;version&gt;2.6.12&lt;/version&gt;&lt;/dependency&gt;äºŒ. å¯¼å‡º2.0 æ¥å£ç¼–å†™1234567891011121314151617181920@RequestMapping(value = "/export")public void test(HttpServletResponse response) throws Exception &#123; WritableWorkbook workbook = Workbook.createWorkbook(response.getOutputStream()); // å“åº”æ ¼å¼ response.setContentType("application/vnd.ms-excel"); response.setHeader("Content-Disposition", "attachment; filename=" + URLEncoder.encode("æ–‡ä»¶åç§°.xls", "UTF-8")); // åˆ›å»ºä¸€ä¸ªå·¥ä½œç°¿: WritableSheet sheet1 = workbook.createSheet("å·¥ä½œç°¿åç§°", 0); Label label1 = new Label(0, 0, "å•†å“id"); sheet1.addCell(label1); Label label2 = new Label(1, 0, "å…¬å¸ç¼–å·"); sheet1.addCell(label2); //æŸ¥è¯¢æ•°æ®å†™åˆ°workbookä¸­ workbook.write(); System.out.println("æŸ¥è¯¢æ•°æ®å†™åˆ°workbookä¸­"); //å…³é—­èµ„æº workbook.close();&#125;2.1 å¯¼å‡ºæ•ˆæœå¦‚ä¸‹ä¸‰. å¯¼å…¥3.0 è¯»å–Excelæ¥å£12345678910111213141516171819202122232425262728293031@PostMapping(value = "/excel")public void importExcel(MultipartFile file) &#123; Workbook workbook = null; List&lt;ItemDto&gt; items = new ArrayList&lt;&gt;(); HashMap&lt;String, ItemDto&gt; map = new HashMap&lt;&gt;(); try &#123; //è·å–xlsæ–‡ä»¶Excel workbook = Workbook.getWorkbook(file.getInputStream()); //è·å–å•†å“å·¥ä½œç°¿:å¯é€šè¿‡ç´¢å¼•è·å–ä¸åŒå·¥ä½œç°¿ Sheet itemSheet = workbook.getSheet(0); //è·å–æ€»è¡Œæ•° int rows = itemSheet.getRows(); //æ ¼å¼åŒ–å¯¼å…¥çš„æ—¥æœŸæ ¼å¼ for (int i = 1; i &lt; rows; i++) &#123; Cell[] row = itemSheet.getRow(i); if (row.length == 0) &#123; continue; &#125; String itemId = itemSheet.getCell(0, i).getContents(); System.out.println(itemId); String scompCode = itemSheet.getCell(1, i).getContents(); System.out.println(scompCode); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; //å…³é—­èµ„æº workbook.close(); &#125;&#125;]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>Excel</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoä¹‹çæŠ˜è…¾ç³»åˆ—]]></title>
    <url>%2F2019%2F03%2F30%2FHexo%E7%9E%8E%E6%8A%98%E8%85%BE%E7%B3%BB%E5%88%97%2F</url>
    <content type="text"><![CDATA[è¯¥æ–‡æ¡£è®°å½•Theme-ADä¸»é¢˜ä¸ªäººåšå®¢éƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨ä»¥åŠè®°å½•æ–°å¢çš„ä¸€äº›å°åŠŸèƒ½~ï¼Theme-ADä¸»é¢˜å…·ä½“æ­å»ºæ­¥éª¤å¯ä»¥å‚è€ƒï¼šhttps://godbmw.com/tags/Hexo/Letâ€™s Go~!Theme-ADä¸»é¢˜å…·ä½“æ­å»ºæ­¥éª¤å¯ä»¥å‚è€ƒï¼šhttps://godbmw.com/tags/Hexo/ä¸€.äº‘æœåŠ¡å™¨éƒ¨ç½²Hexoå‚è€ƒæ–‡æ¡£ï¼šhttps://www.jianshu.com/p/b2e47ec9359d1.1 åå°è¿è¡ŒHexoéƒ¨ç½²åˆ°äº‘æœåŠ¡å™¨åå¦‚æœè¿˜æ˜¯åœ¨hexoæ ¹ç›®å½•ä¸‹ä½¿ç”¨å‘½ä»¤å¯åŠ¨ï¼Œä¼šæœ‰ä¸ªé—®é¢˜å°±æ˜¯ï¼šå½“ä½ æ–­å¼€æœåŠ¡å™¨è¿æ¥ä¹‹åhexoæœåŠ¡å°±ä¼šåœæ­¢ï¼Œæ— æ³•è®¿é—®ã€‚é‚£ä¹ˆå¯ä»¥ç”¨pm2å¯åŠ¨hexoï¼Œè¿™æ ·hexoå°±åœ¨åå°è¿è¡Œäº†ï¼Œå°±ç®—æ–­å¼€æœåŠ¡å™¨è¿æ¥ä¹Ÿä¸ä¼šåœæ­¢1.2 å®‰è£…pm21npm install -g pm2psï¼šå¦‚æœæ„Ÿå…´è¶£ä¹Ÿå¯ä»¥äº†è§£ä¸‹Linuxçš„nohupå‘½ä»¤1.2 åœ¨hexoåˆ›å»ºrun.jsæ–‡ä»¶12345678910//run.jsconst &#123; exec &#125; = require('child_process')exec('hexo server',(error, stdout, stderr) =&gt; &#123; if(error)&#123; console.log(`exec error: $&#123;error&#125;`) return &#125; console.log(`stdout: $&#123;stdout&#125;`); console.log(`stderr: $&#123;stderr&#125;`);&#125;)1.3 è¿è¡Œè„šæœ¬1pm2 start run.jsäºŒ.ä¸ºè‡ªå·±çš„åšå®¢æ·»åŠ èŒå® å‚è€ƒåšå®¢ï¼šhttps://blog.csdn.net/u010820857/article/details/822707362.1 å®‰è£…æ¨¡å—1npm install --save hexo-helper-live2d2.2 é€‰æ‹©æƒ³è¦çš„èŒå® 12345678910111213141516171819202122live2d-widget-model-chitoselive2d-widget-model-epsilon2_1live2d-widget-model-gflive2d-widget-model-haru/01 (use npm install --save live2d-widget-model-haru)live2d-widget-model-haru/02 (use npm install --save live2d-widget-model-haru)live2d-widget-model-harutolive2d-widget-model-hibikilive2d-widget-model-hijikilive2d-widget-model-izumilive2d-widget-model-koharulive2d-widget-model-mikulive2d-widget-model-ni-jlive2d-widget-model-nicolive2d-widget-model-nietzschelive2d-widget-model-nipsilonlive2d-widget-model-nitolive2d-widget-model-shizukulive2d-widget-model-tororolive2d-widget-model-tsumikilive2d-widget-model-unitychanlive2d-widget-model-wankolive2d-widget-model-z162.3 é€‰æ‹©å¥½ä¹‹åè¿˜éœ€è¦å®‰è£…ä¾‹å¦‚æˆ‘é€‰æ‹©çš„æ˜¯ï¼šlive2d-widget-model-z161npm install live2d-widget-model-z162.4 æœ€åä¸€æ­¥é…ç½®Hexoçš„ä¸»é…ç½®æ–‡ä»¶_config.yml1234567891011live2d: enable: true scriptFrom: local model: use: live2d-widget-model-z16 // è¿™é‡Œæ”¹ä¸ºè‡ªå·±é€‰æ‹©çš„èŒå®  å…¶ä»–å‚æ•°å¯ä»¥æ ¹æ®è‡ªå·±å–œå¥½çœ‹ç€ä¿®æ”¹ display: position: right width: 150 height: 300 mobile: show: trueä¸‰. hexoéƒ¨ç½²åˆ°GitHubåç»‘å®šåŸŸå(æœªå¤‡æ¡ˆåŸŸåä¹Ÿå¯ä»¥)3.1 GitHubç›¸å…³é…ç½®åœ¨æ ¹ç›®å½•ä¸‹æ·»åŠ CNAMEæ–‡ä»¶(åç§°å¤§å†™),åœ¨æ–‡ä»¶ä¸­è¾“å…¥åŸŸåCNAME æ–‡ä»¶:æ–‡ä»¶å†…å®¹å°±æ˜¯ä½ çš„åŸŸå:åœ¨è®¾ç½®ä¸­é…ç½®åŸŸå:3.2 ä¿®æ”¹åŸŸåè§£æè®°å½•æŒ‰ç…§ä¸‹é¢æ·»åŠ åŸŸåè§£æè®°å½•:ps:æˆªå›¾ä¸­è®°å½•å€¼çš„ipæ˜¯é€šè¿‡ping`è‡ªå·±çš„xxx.github.ioå¾—åˆ°å››. æ–°å¢ç«™å†…æœç´¢åŠŸèƒ½åŸæœ¬Theme-ADä¸»é¢˜æ˜¯æ²¡æœ‰ç«™å†…æœç´¢çš„,æœ¬ç«™ç‚¹ç§»æ¤çš„æ˜¯Oceanä¸»é¢˜çš„ç«™å†…æœç´¢åŠŸèƒ½.4.1 ä¿®æ”¹header.ejsæ–‡ä»¶æŠŠåŸæœ¬ä¸»é¢˜çš„æœç´¢æ¡†ç§»é™¤,åœ¨ç›¸å¯¹åº”ä½ç½®åŠ å…¥æœç´¢æŒ‰é’®å’Œæœç´¢æ¡†12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061&lt;header class="site-header"&gt; &lt;div class="site-header-brand"&gt; &lt;% if(theme.nav_name) &#123; %&gt; &lt;span class="site-header-brand-title"&gt; &lt;a href="&lt;%- url_for('/') %&gt;"&gt;&lt;%- theme.nav_name %&gt;&lt;/a&gt; &lt;/span&gt; &lt;% &#125; %&gt; &lt;% if(theme.motto) &#123; %&gt; &lt;span class="site-header-brand-motto"&gt; | &lt;%- theme.motto %&gt;&lt;/span&gt; &lt;% &#125; %&gt; &lt;/div&gt; &lt;div class="site-header-right"&gt; &lt;nav class="site-header-navigation"&gt; &lt;% for(let link of theme.nav) &#123; %&gt; &lt;a href="&lt;%- url_for(link.path) %&gt;" target="&lt;%- link.path.startsWith('http') ? '_blank' : '_self' %&gt;"&gt;&lt;%= link.name%&gt;&lt;/a&gt; &lt;% &#125; %&gt; &lt;/nav&gt; &lt;!-- æœç´¢æŒ‰é’® --&gt; &lt;nav class="navbar"&gt; &lt;a href="#" class="nav-item-link nav-item-search" title="&lt;%= __('æœç´¢') %&gt;"&gt; &lt;i class="fe fe-search"&gt;&lt;/i&gt; &lt;%- theme.search_text %&gt; &lt;/a&gt; &lt;/nav&gt; &lt;div class="site-header-btn"&gt; &lt;% if(theme.github) &#123; %&gt; &lt;a href="&lt;%- theme.github %&gt;" target="_blank" id="site-github"&gt; &lt;i class="fa fa-github-alt"&gt;&lt;/i&gt; &lt;/a&gt; &lt;% &#125; %&gt; &lt;/dev&gt;&lt;/div&gt;&lt;!-- æœç´¢æ¡† --&gt;&lt;div class="search-form-wrap"&gt; &lt;div class="local-search local-search-plugin"&gt; &lt;input type="search" id="local-search-input" class="local-search-input" placeholder="Search..."&gt; &lt;div id="local-search-result" class="local-search-result"&gt;&lt;/div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/header&gt;&lt;nav class="table-content" id="site-nav"&gt; &lt;div class="table-content-title"&gt; &lt;span&gt;å¯¼èˆª&lt;/span&gt; &lt;/div&gt; &lt;div class="table-content-main"&gt; &lt;ol class="toc"&gt; &lt;% for(let link of theme.nav) &#123; %&gt; &lt;li class="toc-item"&gt; &lt;a href="&lt;%- url_for(link.path) %&gt;" target="&lt;%- link.path.startsWith('http') ? '_blank' : '_self' %&gt;"&gt; &lt;%= link.name %&gt; &lt;/a&gt; &lt;/li&gt; &lt;% &#125; %&gt; &lt;/ol&gt; &lt;/div&gt;&lt;/nav&gt;&lt;div id="site-process"&gt;&lt;/div&gt;4.2 æŠŠOceanä¸»é¢˜ä¸­sourceä¸­cssçš„feathericonç§»åˆ°è‡ªå·±ä¸»é¢˜çš„cssç›®å½•ä¸‹4.3 åœ¨cssç›®å½•ä¸‹åˆ›å»º_feathericon.stylæ–‡ä»¶12345678910111213141516171819202122232425262728293031323334353637@charset "utf-8"//---------------------------------------------------------------------------// feathericon//---------------------------------------------------------------------------//// variablesfeathericon-font-path = 'feathericon/' !default;//// font path@font-face font-family feathericon font-weight normal font-style normal src: url(feathericon-font-path + 'feathericon.eot') src: url(feathericon-font-path + 'feathericon.eot?#iefix') format('embedded-opentype'), url(feathericon-font-path + 'feathericon.woff') format('woff'), url(feathericon-font-path + 'feathericon.ttf') format('truetype'), url(feathericon-font-path + 'feathericon.svg') format('svg');//// feathericon//.fe display inline-block font normal normal normal 16px feathericon font-size inherit text-rendering auto -webkit-font-smoothing antialiased -moz-osx-font-smoothing grayscale.fe-search:before &#123; content: "\f14e"; &#125;.fe-search-minus:before &#123; content: "\f16a"; &#125;.fe-search-plus:before &#123; content: "\f16b"; &#125;4.4 åœ¨cssç›®å½•ä¸‹åˆ›å»º_mixins.stylæ–‡ä»¶123456border-radius(n) -webkit-border-radius n -moz-border-radius n border-radius n// Media queries4.5 åœ¨cssç›®å½•ä¸‹åˆ›å»º_variables.stylæ–‡ä»¶123456789101112131415161718192021// Configsupport-for-ie = falsevendor-prefixes = webkit moz ms official// Fontsfont-size-browser = 62.5%font-size-base = 1.4remfont-family-base = "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "å¾®è½¯é›…é»‘", Arial, sans-seriffont-line-height = 1.7// Colorssea = #1e3e3ffroth-light = #f4f4f4white = #ffffffsand-light = #9c8079sand = #9e6a4d// Borderborder-radius = 0.4remborder-width = 0.1remborder-color = froth4.6 åœ¨cssç›®å½•ä¸‹åˆ›å»ºstyle.stylæ–‡ä»¶123456789101112131415161718192021222324252627@import &quot;_variables&quot;@import &quot;_feathericon&quot;//@import &quot;_normalize&quot;@import &quot;_mixins&quot;@import &quot;search&quot;*,*::before*::after box-sizing border-boxhtml font-size font-size-browserbody background-color body-background font-family font-family-base font-size font-size-base line-height font-line-height color body-color padding 0 margin 0 overflow-x hidden text-size-adjust: 100% ::selection background sea-lighter color froth4.7 ä¿®æ”¹header.jsæ–‡ä»¶(æ›¿æ¢æ‰æ‰€æœ‰å†…å®¹)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162(function ($) &#123; // Search ------------ var $searchWrap = $('.search-form-wrap'), isSearchAnim = false, searchAnimDuration = 200; var startSearchAnim = function () &#123; isSearchAnim = true; &#125;; var stopSearchAnim = function (callback) &#123; setTimeout(function () &#123; isSearchAnim = false; callback &amp;&amp; callback(); &#125;, searchAnimDuration); &#125;; $('.nav-item-search').on('click', function () &#123; if (isSearchAnim) return; startSearchAnim(); $searchWrap.addClass('on'); stopSearchAnim(function () &#123; $('.local-search-input').focus(); &#125;); &#125;); $(document).mouseup(function (e) &#123; var _con = $('.local-search'); if (!_con.is(e.target) &amp;&amp; _con.has(e.target).length === 0) &#123; $searchWrap.removeClass('on'); &#125; &#125;); // ç§»åŠ¨è®¾å¤‡ä¾¦æµ‹ var isMobile = &#123; Android: function () &#123; return navigator.userAgent.match(/Android/i); &#125;, BlackBerry: function () &#123; return navigator.userAgent.match(/BlackBerry/i); &#125;, iOS: function () &#123; return navigator.userAgent.match(/iPhone|iPad|iPod/i); &#125;, Opera: function () &#123; return navigator.userAgent.match(/Opera Mini/i); &#125;, Windows: function () &#123; return navigator.userAgent.match(/IEMobile/i); &#125;, any: function () &#123; return (isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows()); &#125; &#125;; // å»ºè®®åœ¨ç§»åŠ¨ç«¯ä¸åˆå§‹åŒ–ï¼Œå…¶å® /search.xml æ–‡ä»¶è¿˜æŒºå¤§çš„ï¼Œ if ($('.local-search').size() &amp;&amp; !isMobile.any()) &#123; $.getScript('/js/search.js', function () &#123; searchFunc("/search.xml", 'local-search-input', 'local-search-result'); &#125;); &#125; // Share ------------ $('body').on('click', function () &#123; $('.article-share-box.on').removeClass('on'); &#125;).on('click', '.article-share-link', function (e) &#123; e.stopPropagation(); var $this = $(this), url = $this.attr('data-url'), encodedUrl = encodeURIComponent(url), id = 'article-share-box-' + $this.attr('data-id'), offset = $this.offset(); if ($('#' + id).length) &#123; var box = $('#' + id); if (box.hasClass('on')) &#123; box.removeClass('on'); return; &#125; &#125; else &#123; var html = [ '&lt;div id="' + id + '" class="article-share-box"&gt;', '&lt;input class="article-share-input" value="' + url + '"&gt;', '&lt;div class="article-share-links"&gt;', '&lt;a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"&gt;&lt;/a&gt;', '&lt;a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"&gt;&lt;/a&gt;', '&lt;a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"&gt;&lt;/a&gt;', '&lt;a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"&gt;&lt;/a&gt;', '&lt;/div&gt;', '&lt;/div&gt;' ].join(''); var box = $(html); $('body').append(box); &#125; $('.article-share-box.on').hide(); box.css(&#123; top: offset.top + 25, left: offset.left &#125;).addClass('on'); &#125;).on('click', '.article-share-box', function (e) &#123; e.stopPropagation(); &#125;).on('click', '.article-share-box-input', function () &#123; $(this).select(); &#125;).on('click', '.article-share-box-link', function (e) &#123; e.preventDefault(); e.stopPropagation(); window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450'); &#125;); // fancybox if ($.fancybox) &#123; $('[data-fancybox]').fancybox(&#123; protect: true &#125;); &#125; // lazyload //$(".lazy").lazyload(); // $(document).ready(function ($) &#123; $(".anchor").click(function (event) &#123; event.preventDefault(); $('html,body').animate(&#123;scrollTop: $(this.hash).offset().top&#125;, 500); &#125;); &#125;); // Mobile nav var $content = $('.content'), $sidebar = $('.sidebar'), isMobileNavAnim = false, mobileNavAnimDuration = 200; var startMobileNavAnim = function () &#123; isMobileNavAnim = true; &#125;; var stopMobileNavAnim = function () &#123; setTimeout(function () &#123; isMobileNavAnim = false; &#125;, mobileNavAnimDuration); &#125;; $('.navbar-toggle').on('click', function () &#123; if (isMobileNavAnim) return; startMobileNavAnim(); $content.toggleClass('on'); $sidebar.toggleClass('on'); stopMobileNavAnim(); &#125;); $($content).on('click', function () &#123; if (isMobileNavAnim || !$content.hasClass('on')) return; $content.removeClass('on'); $sidebar.removeClass('on'); &#125;);&#125;)(jQuery);4.8 å¼•å…¥jquery-2.0.3.min.js4.9 åˆ›å»ºsearch.jsæ–‡ä»¶123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127// A local search script with the help of [hexo-generator-search](https://github.com/PaicHyperionDev/hexo-generator-search)// Copyright (C) 2015 // Joseph Pan &lt;http://github.com/wzpan&gt;// Shuhao Mao &lt;http://github.com/maoshuhao&gt;// This library is free software; you can redistribute it and/or modify// it under the terms of the GNU Lesser General Public License as// published by the Free Software Foundation; either version 2.1 of the// License, or (at your option) any later version.// // This library is distributed in the hope that it will be useful, but// WITHOUT ANY WARRANTY; without even the implied warranty of// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU// Lesser General Public License for more details.// // You should have received a copy of the GNU Lesser General Public// License along with this library; if not, write to the Free Software// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA// 02110-1301 USA// var searchFunc = function (path, search_id, content_id) &#123; 'use strict'; var BTN = "&lt;button type='button' class='local-search-close' id='local-search-close'&gt;&lt;/button&gt;"; $.ajax(&#123; url: path, dataType: "xml", success: function (xmlResponse) &#123; // get the contents from search data var datas = $("entry", xmlResponse).map(function () &#123; return &#123; title: $("title", this).text(), content: $("content", this).text(), url: $("url", this).text() &#125;; &#125;).get(); var $input = document.getElementById(search_id); var $resultContent = document.getElementById(content_id); $input.addEventListener('input', function () &#123; var str = '&lt;ul class="search-result-list"&gt;'; var keywords = this.value.trim().toLowerCase().split(/[\s]+/); $resultContent.innerHTML = ""; if (this.value.trim().length &lt;= 0) &#123; return; &#125; // perform local searching datas.forEach(function (data) &#123; var isMatch = true; // var content_index = []; if (!data.title || data.title.trim() === '') &#123; data.title = "Untitled"; &#125; var data_title = data.title.trim().toLowerCase(); var data_content = data.content.trim().replace(/&lt;[^&gt;]+&gt;/g, "").toLowerCase(); var data_url = data.url; var index_title = -1; var index_content = -1; var first_occur = -1; // only match artiles with not empty contents if (data_content !== '') &#123; keywords.forEach(function (keyword, i) &#123; index_title = data_title.indexOf(keyword); index_content = data_content.indexOf(keyword); if (index_title &lt; 0 &amp;&amp; index_content &lt; 0) &#123; isMatch = false; &#125; else &#123; if (index_content &lt; 0) &#123; index_content = 0; &#125; if (i == 0) &#123; first_occur = index_content; &#125; // content_index.push(&#123;index_content:index_content, keyword_len:keyword_len&#125;); &#125; &#125;); &#125; else &#123; isMatch = false; &#125; // show search results if (isMatch) &#123; str += "&lt;li&gt;&lt;a href='" + data_url + "' class='search-result-title'&gt;" + data_title + "&lt;/a&gt;"; var content = data.content.trim().replace(/&lt;[^&gt;]+&gt;/g, ""); if (first_occur &gt;= 0) &#123; // cut out 100 characters var start = first_occur - 20; var end = first_occur + 80; if (start &lt; 0) &#123; start = 0; &#125; if (start == 0) &#123; end = 100; &#125; if (end &gt; content.length) &#123; end = content.length; &#125; var match_content = content.substr(start, end); // highlight all keywords keywords.forEach(function (keyword) &#123; var regS = new RegExp(keyword, "gi"); match_content = match_content.replace(regS, "&lt;em class=\"search-keyword\"&gt;" + keyword + "&lt;/em&gt;"); &#125;); str += "&lt;p class=\"search-result\"&gt;" + match_content + "...&lt;/p&gt;" &#125; str += "&lt;/li&gt;"; &#125; &#125;); str += "&lt;/ul&gt;"; if (str.indexOf('&lt;li&gt;') === -1) &#123; return $resultContent.innerHTML = BTN + "&lt;div class=\"search-result-empty\"&gt;&lt;p&gt;&lt;i class=\"fe fe-tired\"&gt;&lt;/i&gt; æ²¡æœ‰æ‰¾åˆ°å†…å®¹ï¼Œæ›´æ¢ä¸‹æœç´¢è¯è¯•è¯•å§~&lt;p&gt;&lt;/div&gt;"; &#125; $resultContent.innerHTML = BTN + str; &#125;); &#125; &#125;); $(document).on('click', '#local-search-close', function () &#123; $('#local-search-input').val(''); $('#local-search-result').html(''); &#125;);&#125;;4.10 æœ€åä¿®æ”¹head.ejsæ–‡ä»¶,å¼•å…¥jså’Œcssäº”. æ·»åŠ ç½®é¡¶åŠŸèƒ½5.1 åœ¨hexoç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤123npm uninstall hexo-generator-index --savenpm install hexo-generator-index-pin-top --save5.2 åœ¨index.ejsåŠ å…¥ä»¥ä¸‹ä»£ç 1234&lt;% if(psg.top === true) &#123;%&gt; &lt;i class=&quot;fa fa-thumb-tack&quot;&gt;&lt;/i&gt; &lt;font color=7D26CD&gt;ç½®é¡¶&lt;/font&gt; |&lt;% &#125; %&gt;5.3 åœ¨éœ€è¦ç½®é¡¶çš„åšæ–‡ä¸­æ·»åŠ 12top: true---å…­. ä½¿ç”¨hexo-neatå‹ç¼©é¡µé¢6.1 å®‰è£…hexo-neatæ’ä»¶1npm install hexo-neat --save6.2 åœ¨ç«™ç‚¹_config.ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®12345678910111213141516171819202122# hexo-neat# åšæ–‡å‹ç¼©neat_enable: true# å‹ç¼©htmlneat_html: enable: true exclude:# å‹ç¼©css: è¿™é‡Œåªæ˜¯å‹ç¼©é¡µé¢çš„css,å¦‚æœæ˜¯åœ¨sourceç›®å½•ä¸‹çš„cssè¦åœ¨excludeç§»é™¤æ‰,å¦åˆ™å‹ç¼©åä¼šç›´æ¥å˜æˆä¸€ä¸ªç©ºæ–‡ä»¶ neat_css: enable: true exclude: - &apos;**/*.min.css&apos;# å‹ç¼©js:(åŒcssè¯´æ˜)neat_js: enable: true mangle: true output: compress: exclude: - &apos;**/*.min.js&apos; - &apos;**/jquery.fancybox.pack.js&apos; - &apos;**/index.js&apos;]]></content>
      <categories>
        <category>Hexoä¹‹çæŠ˜è…¾ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>åšå®¢</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[docker-å®‰è£…(CentOS7)]]></title>
    <url>%2F2019%2F03%2F27%2FUntitled%2F</url>
    <content type="text"><![CDATA[CentOS7dockerå®‰è£…æ­¥éª¤1.å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…:yum-utilæä¾›yum-config-manageråŠŸèƒ½1yum install -y yum-utils device-mapper-persistent-data lvm2ps:å¦‚æœå®‰è£…è¿‡docker,éœ€è¦é‡è£…å¯ä»¥å…ˆåˆ é™¤åœ¨è£…:12345// æŸ¥çœ‹æ˜¯å¦æœ‰å®‰è£…dockeryum list installed | grep docker //æœ‰åˆ™åˆ é™¤å¯¹åº”çš„åŒ…yum remove docker ......1.å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…:yum-utilæä¾›yum-config-manageråŠŸèƒ½1yum install -y yum-utils device-mapper-persistent-data lvm2ps:å¦‚æœå®‰è£…è¿‡docker,éœ€è¦é‡è£…å¯ä»¥å…ˆåˆ é™¤åœ¨è£…:12345// æŸ¥çœ‹æ˜¯å¦æœ‰å®‰è£…dockeryum list installed | grep docker //æœ‰åˆ™åˆ é™¤å¯¹åº”çš„åŒ…yum remove docker ......2.è®¾ç½®yumæº(é˜¿é‡Œæº)1yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo3.æŸ¥çœ‹yumåº“ä¸­æœ‰æ²¡æœ‰docker-ce1yum list | grep docker-ce4.å®‰è£…docker1yum install -y docker-ce5.å¦‚æœéœ€è¦è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨12345//å…ˆå¯åŠ¨dockeræœåŠ¡ç«¯systemctl start docker//å¯åŠ¨dockeræœåŠ¡å¼€æœºè‡ªå¯systemctl enable docker6.æ ¡éªŒdockeræ˜¯å¦å¯åŠ¨æˆåŠŸ1docker versionå¸¸è§é—®é¢˜: æ™®é€šç”¨æˆ·è¿è¡Œdocker å‘½ä»¤ä¼šæŠ¥é”™:ç”±äºdocker daemonéœ€è¦ç»‘å®šåˆ°ä¸»æœºçš„ Unix socket è€Œä¸æ˜¯æ™®é€šçš„TCPç«¯å£,è€Œ Unix socket çš„å®¿ä¸»ä¸º root ç”¨æˆ·,å¦‚æœå…¶ä»–ç”¨æˆ·ä½¿ç”¨ docker å‘½ä»¤åªæœ‰åœ¨å‘½ä»¤é’±æ·»åŠ  sudo æ‰èƒ½æ‰§è¡ŒæˆåŠŸ,å¦‚æœä¸æƒ³æ¯æ¬¡ä½¿ç”¨ docker å‘½ä»¤æ˜¯è¿˜è¦å¤šæ•² sudo ,å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ–¹æ³•è§£å†³:s1.åˆ‡æ¢åˆ° root ç”¨æˆ·2.æŠŠæ™®é€šç”¨æˆ·æ·»åŠ åˆ° docker ç»„3.å†åˆ‡æ¢åˆ°&lt;æ™®é€šç”¨æˆ·&gt;4.éªŒè¯ docker å‘½ä»¤æ˜¯å¦æˆåŠŸ]]></content>
      <categories>
        <category>dockerå®¹å™¨ç³»åˆ—</category>
      </categories>
      <tags>
        <tag>docker</tag>
      </tags>
  </entry>
</search>
